<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Developer Guide</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta content="Scroll Wiki Publisher" name="generator"/>
    <link rel="stylesheet" href="css/content-style.css" type="text/css"/>
</head>
<body>
    <div class="container">
        <div id="title" class="prepend-top">
              <img src="spacelogo.png" />        
            <h1>WildFly 8</h1>
              <h1>Developer Guide</h1>
            <p>Exported from <a href="https://docs.jboss.org/author/display/WFLY8">JBoss Community Documentation Editor</a> at 2014-12-31 08:58:20 EST.</p>
            <p>Copyright 2014 JBoss Community contributors.</p>
            <br/><br/>
        </div>
        
        <div id="66322748" class="content prepend-top">
<ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WildFly8DeveloperGuide">WildFly 8 Developer Guide</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-TargetAudience">Target Audience</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Prerequisites">Prerequisites</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ClassloadinginWildFly8">Class loading in WildFly 8</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DeploymentModuleNames">Deployment Module Names</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-AutomaticDependencies">Automatic Dependencies</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ClassLoading%26nbsp%3BPrecedence">Class Loading&nbsp;Precedence</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WARClassLoading">WAR Class Loading</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-EARClassLoading">EAR Class Loading</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ClassPathEntries">Class Path Entries</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-GlobalModules">Global Modules</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-JBossDeploymentStructureFile">JBoss Deployment Structure File</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-AccessingJDKclasses">Accessing JDK classes</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Implicitmoduledependenciesfordeployments">Implicit module dependencies for deployments</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-What%27sanimplicitmoduledependency%3F">What's an implicit module dependency?</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Howandwhenisanimplicitmoduledependencyadded%3F">How and when is an implicit module dependency added?</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Whicharetheimplicitmoduledependencies%3F">Which are the implicit module dependencies?</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-HowdoImigratemyapplicationfromJBossAS5orAS6toWildFly8%3F">How do I migrate my application from JBoss AS 5 or AS 6 to WildFly 8?</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-MigrationOverview">Migration Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdateApplicationDependenciesDuetoClassLoadingChanges">Update Application Dependencies Due to Class Loading Changes</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Modularclassloadingoverview">Modular class loading overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Understandmoduledependencies">Understand module dependencies</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-HowtoPackageEARsandWARs">How to Package EARs and WARs</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Createormodifyfilesthatcontrolclassloadingin%26nbsp%3BWildFly">Create or modify files that control class loading in&nbsp;WildFly</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-jbossweb.xml">jboss-web.xml</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-MANIFEST.MFfile">MANIFEST.MF file</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ManuallyeditedMANIFESTfiles">Manually edited MANIFEST files</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Howtodefine%7B%7BMANIFEST.MF%7D%7DfiledependenciesifyouuseMaven">How to define <tt class=" ">MANIFEST.MF</tt> file dependencies if you use Maven</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-jbossdeploymentstructure.xml">jboss-deployment-structure.xml</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-application.xml">application.xml</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ChangeResourceBundlelocation">Change ResourceBundle location</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WheretoFindAdditionalInformation">Where to Find Additional Information</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdatetheDataSourceConfiguration">Update the DataSource Configuration</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Definethedatasource">Define the datasource</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-InstalltheJDBCdriver">Install the JDBC driver</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-InstalltheJDBCdriverasadeployment">Install the JDBC driver as a deployment</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-InstalltheJDBCdriverasacoremodule">Install the JDBC driver as a core module</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ConfigurethedatasourceforHibernateorJPA">Configure the datasource for Hibernate or JPA</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WheretoFindAdditionalInformation">Where to Find Additional Information</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdatetheResourceAdapterConfiguration">Update the Resource Adapter Configuration</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Definetheresourceadapter">Define the resource adapter</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdateapplicationJNDInamespacenames">Update application JNDI namespace names</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ReviewtheJNDINamespaceRules">Review the JNDI Namespace Rules</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ModifyyourapplicationcodetofollowthenewJNDInamespacerules">Modify your application code to follow the new JNDI namespace rules</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ExamplesofJNDImappingsinpreviousreleasesandhowtheymightlooknow">Examples of JNDI mappings in previous releases and how they might look now</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-MigrateremoteEJBclientstotheWildFly8%26nbsp%3BclientAPI">Migrate remote EJB clients to the WildFly 8&nbsp;client API</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-MigrateEAP5DeployedApplicationsThatMakeRemoteInvocationsto%26nbsp%3BWildFly8">Migrate EAP 5 Deployed Applications That Make Remote Invocations to&nbsp;WildFly 8</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdatetheClientCode">Update the Client Code</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Modifyloggingdependencies">Modify logging dependencies</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Updateyourapplicationcodeforthirdpartyloggingframeworks">Update your application code for third-party logging frameworks</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ModifycodetousetheNewJBossLoggingFramework">Modify code to use the New JBoss Logging Framework</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WheretoFindAdditionalInformation">Where to Find Additional Information</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ConfigurechangesforapplicationsthatuseHibernateandJPA">Configure changes for applications that use Hibernate and JPA</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdateyourHibernate3applicationtouseHibernate4">Update your Hibernate 3 application to use Hibernate 4</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ChangesforHibernate3.3applications">Changes for Hibernate 3.3 applications</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ChangesforHibernate3.5applications">Changes for Hibernate 3.5 applications</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-GeneralChangeswhenmigratingtoHibernate4">General Changes when migrating to Hibernate 4</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ChangesinJPAcontainermanagedbehaviour">Changes in JPA container managed behaviour</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-InfinispanasSecondLevelCache">Infinispan as Second Level Cache</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Infinispansecondlevelcachesettings">Infinispan second-level cache settings</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-MigratetoHibernate4Validator">Migrate to Hibernate 4 Validator</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-AccessingthedefaultValidatorFactory">Accessing the default ValidatorFactory</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Lifecycletriggeredvalidation">Life cycle triggered validation</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Manualvalidation">Manual validation</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingthenewBeanValidationconstraints">Using the new Bean Validation constraints</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Customconstraints">Custom constraints</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WheretoFindAdditionalInformation">Where to Find Additional Information</a>            </p>
    </li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ChangesyouneedtomakeforSecurity">Changes you need to make for Security</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ConfigureSecurityforBasicAuthentication">Configure Security for Basic Authentication</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Modifysecuritydomainnames">Modify security domain names</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ConfigureJAXRS%2FResteasychanges">Configure JAX-RS / Resteasy changes</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ConfigureLDAPsecurityrealmchanges">Configure LDAP security realm changes</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-MigratefromJBossMessagingtoHornetQ">Migrate from JBoss Messaging to HornetQ</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Beforeyoustart">Before you start</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Transferconfigurations">Transfer configurations</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Modifyapplicationcode">Modify application code</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Migrateexistingmessages">Migrate existing messages</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ChangesyouneedtomakeforClustering">Changes you need to make for Clustering</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-StartingWildFly8%26nbsp%3Bwithclusteringenabled">Starting WildFly 8&nbsp;with clustering enabled</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Specifyingthebindaddress">Specifying the bind address</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Configure%7B%7BjvmRoute%7D%7Dtosupport%7B%7Bmodjk%7D%7Dand%7B%7Bmodproxy%7D%7D">Configure <tt class=" ">jvmRoute</tt> to support <tt class=" ">mod_jk</tt> and <tt class=" ">mod_proxy</tt></a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Specifyingmulticastaddress%2Fport">Specifying multicast address/port</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Usinganalternateprotocolstack">Using an alternate protocol stack</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-HASingletonDeployment">HA Singleton Deployment</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Additionalchangesyoumayneedtomake">Additional changes you may need to make</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ChangeMavenpluginname">Change Maven plugin name</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdateApplicationsThatUseServicestyleDeployments">Update Applications That Use Service-style Deployments</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DebugandResolveMigrationIssues">Debug and Resolve Migration Issues</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DebugandresolveClassNotFoundExceptionsandNoCLassDefFoundErrors">Debug and resolve ClassNotFoundExceptions and NoCLassDefFoundErrors</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Changetheapplicationstructuretofindclasseswithintheapplication">Change the application structure to find classes within the application</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-HowtofindtheJBossmoduledependency">How to find the JBoss module dependency</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-HowtofindtheJARinpreviousinstall">How to find the JAR in previous install</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DebugandresolveClassCastExceptions">Debug and resolve ClassCastExceptions</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-RemoveanyunnecessaryJARsfromtheApplicationarchive">Remove any unnecessary JARs from the Application archive</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Excludeanyconflictingdependenciesusingthe%7B%7Bjbossdeploymentstructure.xml%7D%7Dfile">Exclude any conflicting dependencies using the <tt class=" ">jboss-deployment-structure.xml</tt> file</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Debugandresolveclassloadingissues">Debug and resolve class loading issues</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DebugandresolveNoSuchMethodExceptions">Debug and resolve <strong class=" ">NoSuchMethodExceptions</strong></a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DebugandresolveDuplicateServiceExceptions">Debug and resolve DuplicateServiceExceptions</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DebugandresolveJBossSeamdebugpageerrors.">Debug and resolve JBoss Seam debug page errors.</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-EJB2.xSupport">EJB 2.x Support</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ModifytheCodetoUsetheNewJNDINamespaceRules">Modify the Code to Use the New JNDI Namespace Rules</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ReplaceJBossAOPInterceptors">Replace JBoss AOP Interceptors</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Modifythe%7B%7Bjbossweb.xml%7D%7DFileDescriptor">Modify the <tt class=" ">jboss-web.xml</tt> File Descriptor</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Replacethe%7B%7Bjboss.xml%7D%7Ddeploymentdescriptorfile">Replace the <tt class=" ">jboss.xml</tt> deployment descriptor file</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-StarttheServerwiththeFullProfiles">Start the Server with the Full Profiles</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Migrationrequiredforothercomponents">Migration required for other components</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-HowtomigrateSeam2archivesto%26nbsp%3BWildFly8">How to migrate Seam 2 archives to&nbsp;WildFly 8</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Updatethedatasourceconfiguration">Update the datasource configuration</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Addanyrequireddependencies">Add any required dependencies</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Copydependentarchivesfromoutsideframeworksorotherlocations">Copy dependent archives from outside frameworks or other locations</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Seam2JPAexampledeploymenton%26nbsp%3BWildFly">Seam 2 JPA example deployment on&nbsp;WildFly</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-HowtodebugandresolveSeam2JNDIerrors">How to debug and resolve Seam 2 JNDI errors</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-RunningSeam3archiveson%26nbsp%3BWildFly">Running Seam 3 archives on&nbsp;WildFly</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-MigratingSpringapplications">Migrating Spring applications</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ToolsThatCanAssistwithMigration">Tools That Can Assist with Migration</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UseTattletaletofindapplicationdependencies">Use Tattletale to find application dependencies</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-InstallTattletale">Install Tattletale</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-CreateandreviewtheTattletalereport">Create and review the Tattletale report</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-IronJacamarDatasourceandResourceAdapterMigrationTool">IronJacamar Datasource and Resource Adapter Migration Tool</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Summary">Summary</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DownloadandinstallIronJacamar">Download and install IronJacamar</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsetheIronJacamarMigrationTooltoconvertadatasourceconfigurationfile.">Use the IronJacamar Migration Tool to convert a datasource configuration file.</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsetheIronJacamarMigrationTooltoconvertaresourceadapterconfigurationfile.">Use the IronJacamar Migration Tool to convert a resource adapter configuration file.</a>            </p>
    </li></ul></li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-EJBinvocationsfromaremotestandaloneclientusingJNDI">EJB invocations from a remote standalone client using JNDI</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DeployingyourEJBsontheserverside%3A">Deploying your EJBs on the server side:</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WritingaremoteclientapplicationforaccessingandinvokingtheEJBsdeployedontheserver">Writing a remote client application for accessing and invoking the EJBs deployed on the server</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SettingupEJBclientcontextproperties">Setting up EJB client context properties</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingadifferentfileforsettingupEJBclientcontext">Using a different file for setting up EJB client context</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Settinguptheclientclasspathwiththejarsthatarerequiredtoruntheclientapplication">Setting up the client classpath with the jars that are required to run the client application</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Summary">Summary</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-EJBinvocationsfromaremoteserver">EJB invocations from a remote server</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Applicationpackaging">Application packaging</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Beans">Beans</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Security">Security</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Configuringauseronthe%22DestinationServer%22">Configuring a user on the &quot;Destination Server&quot;</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Startthe%22DestinationServer%22">Start the &quot;Destination Server&quot;</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Deployingtheapplication">Deploying the application</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Configuringthe%22ClientServer%22topointtotheEJBremotingconnectoronthe%22DestinationServer%22">Configuring the &quot;Client Server&quot; to point to the EJB remoting connector on the &quot;Destination Server&quot;</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Startthe%22ClientServer%22">Start the &quot;Client Server&quot;</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Createasecurityrealmontheclientserver">Create a security realm on the client server</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Createaoutboundsocketbindingonthe%22ClientServer%22">Create a outbound-socket-binding on the &quot;Client Server&quot;</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Createa%22remoteoutboundconnection%22whichusesthisnewlycreated%22outboundsocketbinding%22">Create a &quot;remote-outbound-connection&quot; which uses this newly created &quot;outbound-socket-binding&quot;</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Packagingtheclientapplicationonthe%22ClientServer%22">Packaging the client application on the &quot;Client Server&quot;</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Contentsonjbossejbclient.xml">Contents on jboss-ejb-client.xml</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Deploytheclientapplication">Deploy the client application</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Clientcodeinvokingthebean">Client code invoking the bean</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-RemoteEJBinvocationsviaJNDIWhichapproachtouse%3F">Remote EJB invocations via JNDI - Which approach to use?</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-JBossEJB3referenceguide">JBoss EJB 3 reference guide</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ResourceAdapterforMessageDrivenBeans">Resource Adapter for Message Driven Beans</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SpecificationofResourceAdapterusingMetadataAnnotations">Specification of Resource Adapter using Metadata Annotations</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-RunasPrincipal">Run-as Principal</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SpecificationofRunasPrincipalusingMetadataAnnotations">Specification of Run-as Principal using Metadata Annotations</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SecurityDomain">Security Domain</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SpecificationofSecurityDomainusingMetadataAnnotations">Specification of Security Domain using Metadata Annotations</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-TransactionTimeout">Transaction Timeout</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SpecificationofTransactionTimeoutwithMetadataAnnotations">Specification of Transaction Timeout with Metadata Annotations</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SpecificationofTransactionTimeoutintheDeploymentDescriptor">Specification of Transaction Timeout in the Deployment Descriptor</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Exampleof%7B%7Btranstimeout%7D%7D">Example of <tt class=" ">trans-timeout</tt></a>            </p>
    </li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Timerservice">Timer service</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Singleeventtimer">Single event timer</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Recurringtimer">Recurring timer</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Calendartimer">Calendar timer</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Programmaticcalendartimer">Programmatic calendar timer</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Annotatedcalendartimer">Annotated calendar timer</a>            </p>
    </li></ul></li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-JPAreferenceguide">JPA reference guide</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Introduction">Introduction</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdateyourPersistence.xmlforHibernate4.3.0">Update your Persistence.xml for Hibernate 4.3.0</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Entitymanager">Entity manager</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Applicationmanagedentitymanager">Application-managed entity manager</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Containermanagedentitymanager">Container-managed entity manager</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PersistenceContext">Persistence Context</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-TransactionscopedPersistenceContext">Transaction-scoped Persistence Context</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ExtendedPersistenceContext">Extended Persistence Context</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ExtendedPersistenceContextInheritance">Extended Persistence Context Inheritance</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Entities">Entities</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Deployment">Deployment</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Troubleshooting">Troubleshooting</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-BackgroundontheJipijapaproject">Background on the Jipijapa project</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PackagingpersistenceproviderswithyourapplicationandwhichJipijapaartifactstoinclude">Packaging persistence providers with your application and which Jipijapa artifacts to include</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingtheHibernate4.3.xJPApersistenceprovider">Using the Hibernate 4.3.x JPA persistence provider</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingtheInfinispansecondlevelcache">Using the Infinispan second level cache</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ReplacingthecurrentHibernate4.3.xjarswithanewerversion">Replacing the current Hibernate 4.3.x jars with a newer version</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PackagingtheHibernate3.5orgreater3.xJPApersistenceproviderwithyourapplication">Packaging the Hibernate 3.5 or greater 3.x JPA persistence provider with your application</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SharingtheHibernate3.5orgreaterJPApersistenceproviderbetweenmultipleapplications">Sharing the Hibernate 3.5 or greater JPA persistence provider between multiple applications</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingOpenJPA">Using OpenJPA</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingEclipseLink">Using EclipseLink</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingDataNucleus">Using DataNucleus</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingHibernateOGM">Using Hibernate OGM</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-NativeHibernateuse">Native Hibernate use</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-InjectionofHibernateSessionandSessionFactoryInjectionofHibernateSessionandSessionFactory">Injection of Hibernate Session and SessionFactoryInjection of Hibernate Session and SessionFactory</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Hibernateproperties">Hibernate properties</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Persistenceunitproperties">Persistence unit properties</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Determinethepersistenceprovidermodule">Determine the persistence provider module</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-BindingEntityManagerFactory%2FEntityManagertoJNDI">Binding EntityManagerFactory/EntityManager to JNDI</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Community">Community</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PeoplewhohavecontributedtotheWildFlyJPAlayer%3A">People who have contributed to the WildFly JPA layer:</a>            </p>
    </li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-OSGideveloperguide">OSGi developer guide</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-JNDIreferenceguide">JNDI reference guide</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Overview">Overview</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-LocalJNDI">Local JNDI</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-BindingentriestoJNDI">Binding entries to JNDI</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Usingadeploymentdescriptor">Using a deployment descriptor</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Programatically">Programatically</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-JavaEEApplications">Java EE Applications</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-"></a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-WildFlyModulesandExtensions">WildFly Modules and Extensions</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-"></a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-NamingSubsystemConfiguration">Naming Subsystem Configuration</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-RetrievingentriesfromJNDI">Retrieving entries from JNDI</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ResourceInjection">Resource Injection</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-StandardJavaSEJNDIAPI">Standard Java SE JNDI API</a>            </p>
    </li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-RemoteJNDI">Remote JNDI</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-remote%3A">remote:</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ejb%3A">ejb:</a>            </p>
    </li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Springapplicationsdevelopmentandmigrationguide">Spring applications development and migration guide</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-DependenciesandModularity">Dependencies and Modularity</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Persistenceusageguide">Persistence usage guide</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-NativeSpring%2FHibernateapplications">Native Spring/Hibernate applications</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-JPAbasedapplications">JPA-based applications</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Usingserverdeployedpersistenceunits">Using server-deployed persistence units</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingSpringmanagedpersistenceunits">Using Spring-managed persistence units</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Placementofthepersistenceunitdefinitions">Placement of the persistence unit definitions</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Managingdependencies">Managing dependencies</a>            </p>
    </li></ul></li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-AllWildFly8documentation">All WildFly 8 documentation</a>            </p>
    </li></ul>    <div class="section-2"  id="66322748_DeveloperGuide-WildFly8DeveloperGuide"  >
        <h2>WildFly 8 Developer Guide</h2>
    
    <div class="section-3"  id="66322748_DeveloperGuide-TargetAudience"  >
        <h3>Target Audience</h3>
    
            <p>
    Java Developers            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Prerequisites"  >
        <h3>Prerequisites</h3>
    
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-ClassloadinginWildFly8"  >
        <h2>Class loading in WildFly 8</h2>
    
            <p>
    Since WildFly 8,&nbsp;Class loading is considerably different to previous versions of JBoss AS. Class loading is based on the <a href="https://docs.jboss.org/author/display/MODULES">JBoss Modules</a> project. Instead of the more familiar hierarchical class loading environment, WildFly's class loading is based on modules that have to define explicit dependencies on other modules. Deployments in WildFly&nbsp;are also modules, and do not have access to classes that are defined in jars in the application server unless an explicit dependency on those classes is defined.            </p>
        <div class="section-3"  id="66322748_DeveloperGuide-DeploymentModuleNames"  >
        <h3>Deployment Module Names</h3>
    
            <p>
    Module names for top level deployments follow the format <tt class=" ">deployment.myarchive.war</tt> while sub deployments are named like <tt class=" ">deployment.myear.ear.mywar.war</tt>.&nbsp;            </p>
                <p>
    This means that it is possible for a deployment to import classes from another deployment using the other deployments module name, the details of how to add an explicit module dependency are explained below.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-AutomaticDependencies"  >
        <h3>Automatic Dependencies</h3>
    
            <p>
    Even though in WildFly&nbsp;modules are isolated by default, as part of the deployment process some dependencies on modules defined by the application server are set up for you automatically. For instance, if you are deploying a Java EE application a dependency on the Java EE API's will be added to your module automatically. Similarly if your module contains a beans.xml file a dependency on <a href="http://seamframework.org/Weld">Weld </a>will be added automatically, along with any supporting modules that weld needs to operate.            </p>
                <p>
    For a complete list of the automatic dependencies that are added, please see <a href="66322752.html">Implicit module dependencies for deployments</a>.            </p>
                <p>
    Automatic dependencies can be excluded through the use of <tt class=" ">jboss-deployment-structure.xml</tt>.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ClassLoading%26nbsp%3BPrecedence"  >
        <h3>Class Loading&#160;Precedence</h3>
    
            <p>
    A common source of errors in Java applications is including API classes in a deployment that are also provided by the container. This can result in multiple versions of the class being created and the deployment failing to deploy properly. To prevent this in WildFly, module dependencies are added in a specific order that should prevent this situation from occurring.&nbsp;            </p>
                <p>
    In order of highest priority to lowest priority            </p>
    <ol class=" "><li class=" ">            <p>
    System Dependencies - These are dependencies that are added to the module automatically by the container, including the Java EE api's.            </p>
    </li><li class=" ">            <p>
    User Dependencies - These are dependencies that are added through&nbsp;<tt class=" ">jboss-deployment-structure.xml</tt>&nbsp;or through the&nbsp;<tt class=" ">Dependencies:</tt>&nbsp;manifest entry.            </p>
    </li><li class=" ">            <p>
    Local Resource - Class files packaged up inside the deployment itself, e.g. class files from <tt class=" ">WEB-INF/classes</tt> or <tt class=" ">WEB-INF/lib</tt> of a war.            </p>
    </li><li class=" ">            <p>
    Inter deployment dependencies - These are dependencies on other deployments in an ear deployment. This can include classes in an ear's lib directory, or classes defined in other ejb jars.&nbsp;            </p>
    </li></ol>    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-WARClassLoading"  >
        <h3>WAR Class Loading</h3>
    
            <p>
    The war is considered to be a single module, so classes defined in <tt class=" ">WEB-INF/lib</tt> are treated the same as classes in <tt class=" ">WEB-INF/classes</tt>. All classes packaged in the war will be loaded with the same class loader.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-EARClassLoading"  >
        <h3>EAR Class Loading</h3>
    
            <p>
    Ear deployments are multi-module deployments. This means that not all classes inside an ear will necessarily have access to all other classes in the ear, unless explicit dependencies have been defined. By default the <tt class=" ">EAR/lib</tt> directory is a single module, and every WAR or EJB jar deployment is also a separate module. Sub deployments (wars and ejb-jars) always have a dependency on the parent module, which gives them access to classes in <tt class=" ">EAR/lib</tt>, however they do not always have an automatic dependency on each other. This behaviour is controlled via the <tt class=" ">ear-subdeployments-isolated</tt>&nbsp;setting in the ee subsystem configuration:&nbsp;            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:ee:1.0&quot; &gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
  &lt;ear-subdeployments-isolated&gt;false&lt;/ear-subdeployments-isolated&gt;
&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
            <p>
    By default this is set to false, which allows the sub-deployments to see classes belonging to other sub-deployments within the .ear.            </p>
                <p>
    For example, consider the following .ear deployment:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>myapp.ear
 |
 |--- web.war
 |
 |--- ejb1.jar
 |
 |--- ejb2.jar</code></pre>
        </div>
    </div>
            <p>
    If the ear-subdeployments-isolated is set to false, then the classes in web.war can access classes belonging to ejb1.jar and ejb2.jar. Similarly, classes from ejb1.jar can access classes from ejb2.jar (and vice-versa).            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    The ear-subdeployments-isolated element value has no effect on the isolated classloader of the .war file(s). i.e. irrespective of whether this flag is set to true or false, the .war within a .ear will have a isolated classloader and other sub-deployments within that .ear will not be able to access classes from that .war. This is as per spec.            </p>
        </div>
    
            <p>
    If the ear-subdeployments-isolated is set to true then no automatic module dependencies between the sub-deployments are set up. User must manually setup the dependency with <tt class=" ">Class-Path</tt> entries, or by setting up explicit module dependencies.            </p>
        <div class="confbox admonition admonition-tip">
            <div class="title">Portability</div>
        
            <p>
    The  Java EE specification says that portable applications should not rely  on sub deployments having access to other sub deployments unless an  explicit Class-Path entry is set in the MANIFEST.MF. So portable  applications should always use Class-Path entry to explicitly state  their dependencies.            </p>
        </div>
    
    <div class="confbox admonition admonition-info">
        
            <p>
    It is also possible to override the ear-subdeployments-isolated element value at a per deployment level. See the section on jboss-deployment-structure.xml below.            </p>
        </div>
    
            <p>
    <tt class=" ">Dependencies:</tt><strong class=" ">&nbsp;Manifest Entries</strong>            </p>
                <p>
    Deployments (or more correctly modules within a deployment) may set up dependencies on other modules by adding a <tt class=" ">Dependencies:</tt> manifest entry. This entry consists of a comma separated list of module names that the deployment requires. The&nbsp;available&nbsp;modules can be seen under the <tt class=" ">modules</tt> directory in the application server distribution. For example to add a dependency on javassist and apache velocity you can add a manifest entry as follows:            </p>
                <p>
    <tt class=" ">Dependencies: org.javassist export,org.apache.velocity export services,org.antlr</tt>            </p>
                <p>
    Each dependency entry may also specify some of the following parameters by adding them after the module name:            </p>
    <ul class=" "><li class=" ">            <p>
    <tt class=" ">export</tt> This means that the dependencies will be exported, so any module that depends on this module will also get access to the dependency.            </p>
    </li><li class=" ">            <p>
    <tt class=" ">services</tt> By default items in META-INF of a dependency are not accessible, this makes items from <tt class=" ">META-INF/services</tt> accessible so <a href="http://download.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html">services </a> in the modules can be loaded.            </p>
    </li><li class=" ">            <p>
    <tt class=" ">optional</tt> If this is specified the deployment will not fail if the module is not available.            </p>
    </li><li class=" ">            <p>
    <tt class=" ">meta-inf</tt> This will make the contents of the <tt class=" ">META-INF</tt> directory available (unlike <tt class=" ">services</tt>, which just makes <tt class=" ">META-INF/services</tt> available). In general this will not cause any deployment descriptors in META-INF to be processed, with the exception of <tt class=" ">beans.xml</tt>. If a <tt class=" ">beans.xml</tt> file is present this module will be scanned by Weld and any resulting beans will be available to the application.            </p>
    </li><li class=" ">            <p>
    <tt class=" ">annotations</tt> If a jandex index has be created for the module these annotations will be merged into the deployments annotation index. The <a href="https://github.com/jbossas/jandex">Jandex</a> index can be generated using the <a href="https://github.com/jbossas/jandex/blob/master/src/main/java/org/jboss/jandex/JandexAntTask.java">Jandex ant task </a>, and must be named <tt class=" ">META-INF/jandex.idx</tt>. Note that it is not necessary to break open the jar being indexed to add this to the modules class path, a better approach is to create a jar containing just this index, and adding it as an additional resource root in the <tt class=" ">module.xml</tt> file.            </p>
    </li></ul>    <div class="confbox admonition admonition-info">
            <div class="title">Adding a dependency to all modules in an EAR</div>
        
            <p>
    Using the <tt class=" ">export</tt> parameter it is possible to add a dependency to all sub deployments in an ear. If a module is exported from a <tt class=" ">Dependencies:</tt> entry in the top level of the ear (or by a jar in the <tt class=" ">ear/lib</tt> directory) it will be available to all sub deployments as well.            </p>
        </div>
    
    <div class="confbox admonition admonition-tip">
        
            <p>
    To generate a MANIFEST.MF entry when using maven put the following in your pom.xml:            </p>
        <div class="confbox programlisting">
                    <div class="title">pom.xml</div>
                <div class="content">
        <pre><code>&lt;build&gt;
   ...
   &lt;plugins&gt;
     &lt;plugin&gt;
       &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
       &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
       &lt;configuration&gt;
          &lt;archive&gt;
             &lt;manifestEntries&gt;
                &lt;Dependencies&gt;org.slf4j&lt;/Dependencies&gt;
             &lt;/manifestEntries&gt;
          &lt;/archive&gt;
       &lt;/configuration&gt;
     &lt;/plugin&gt;
   &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
        </div>
    </div>
            <p>
    If your deployment is a jar you must use the <tt class=" ">maven-jar-plugin</tt> rather than the <tt class=" ">maven-war-plugin</tt>.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ClassPathEntries"  >
        <h4>Class Path Entries</h4>
    
            <p>
    It is also possible to add module&nbsp;dependencies&nbsp;on other modules inside the deployment using the <tt class=" ">Class-Path</tt> manifest entry. This can be used within an ear to set up dependencies between sub deployments, and also to allow modules access to additional jars deployed in an ear that are not sub deployments and are not in the <tt class=" ">EAR/lib</tt> directory. If a jar in the <tt class=" ">EAR/lib</tt> directory references a jar via <tt class=" ">Class-Path:</tt> then this additional jar is merged into the parent ear's module, and is accessible to all sub deployments in the ear.&nbsp;            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-GlobalModules"  >
        <h3>Global Modules</h3>
    
            <p>
    It is also possible to set up global modules, that are accessible to all deployments. This is done by modifying the configuration file (standalone/domain.xml).            </p>
                <p>
    For example, to add javassist to all deployments you can use the following XML:            </p>
        <div class="confbox programlisting">
                    <div class="title">standalone.xml/domain.xml</div>
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:ee:1.0&quot; &gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
  &lt;global-modules&gt;
    &lt;module name=&quot;org.javassist&quot; slot=&quot;main&quot; /&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
  &lt;/global-modules&gt;&nbsp;
&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
            <p>
    Note that the <tt class=" ">slot</tt> field is optional and defaults to <tt class=" ">main</tt>.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-JBossDeploymentStructureFile"  >
        <h3>JBoss Deployment Structure File</h3>
    
            <p>
    <tt class=" ">jboss-deployment-structure.xml</tt> is a JBoss specific deployment descriptor that can be used to control class loading in a fine grained manner. It should be placed in the top level deployment, in <tt class=" ">META-INF</tt> (or <tt class=" ">WEB-INF</tt> for web deployments). It can do the following:            </p>
    <ul class=" "><li class=" ">            <p>
    Prevent automatic dependencies from being added            </p>
    </li><li class=" ">            <p>
    Add additional dependencies            </p>
    </li><li class=" ">            <p>
    Define additional modules&nbsp;            </p>
    </li><li class=" ">            <p>
    Change an EAR deployments isolated class loading behaviour            </p>
    </li><li class=" ">            <p>
    Add additional resource roots to a module            </p>
    </li></ul>            <p>
    An example of a complete <tt class=" ">jboss-deployment-structure.xml</tt> file for an ear deployment is as follows:            </p>
                <p>
        <div class="confbox programlisting">
                    <div class="title">jboss-deployment-structure.xml</div>
                <div class="content">
        <pre><code>&lt;jboss-deployment-structure&gt;
  &lt;!-- Make sub deployments isolated by default, so they cannot see each others classes without a Class-Path entry --&gt;
  &lt;ear-subdeployments-isolated&gt;true&lt;/ear-subdeployments-isolated&gt;
  &lt;!-- This corresponds to the top level deployment. For a war this is the war's module, for an ear --&gt;
  &lt;!-- This is the top level ear module, which contains all the classes in the EAR's lib folder     --&gt;
  &lt;deployment&gt;
     &lt;!-- exclude-subsystem prevents a subsystems deployment unit processors running on a deployment --&gt;
     &lt;!-- which gives basically the same effect as removing the subsystem, but it only affects single deployment --&gt;
     &lt;exclude-subsystems&gt;
        &lt;subsystem name=&quot;resteasy&quot; /&gt;
    &lt;/exclude-subsystems&gt;
    &lt;!-- Exclusions allow you to prevent the server from automatically adding some dependencies     --&gt;
    &lt;exclusions&gt;
        &lt;module name=&quot;org.javassist&quot; /&gt;
    &lt;/exclusions&gt;
    &lt;!-- This allows you to define additional dependencies, it is the same as using the Dependencies: manifest attribute --&gt;
    &lt;dependencies&gt;
      &lt;module name=&quot;deployment.javassist.proxy&quot; /&gt;
      &lt;module name=&quot;deployment.myjavassist&quot; /&gt;
      &lt;!-- Import META-INF/services for ServiceLoader impls as well --&gt;
      &lt;module name=&quot;myservicemodule&quot; services=&quot;import&quot;/&gt;
    &lt;/dependencies&gt;
    &lt;!-- These add additional classes to the module. In this case it is the same as including the jar in the EAR's lib directory --&gt;
    &lt;resources&gt;
      &lt;resource-root path=&quot;my-library.jar&quot; /&gt;
    &lt;/resources&gt;
  &lt;/deployment&gt;
  &lt;sub-deployment name=&quot;myapp.war&quot;&gt;
    &lt;!-- This corresponds to the module for a web deployment --&gt;
    &lt;!-- it can use all the same tags as the &lt;deployment&gt; entry above --&gt;
    &lt;dependencies&gt;
      &lt;!-- Adds a dependency on a ejb jar. This could also be done with a Class-Path entry --&gt;
      &lt;module name=&quot;deployment.myear.ear.myejbjar.jar&quot; /&gt;
    &lt;/dependencies&gt;
    &lt;!-- Set's local resources to have the lowest priority --&gt;
    &lt;!-- If the same class is both in the sub deployment and in another sub deployment that --&gt;
    &lt;!-- is visible to the war, then the Class from the other deployment will be loaded,  --&gt;
    &lt;!-- rather than the class actually packaged in the war. --&gt;
    &lt;!-- This can be used to resolve ClassCastExceptions  if the same class is in multiple sub deployments--&gt;
    &lt;local-last value=&quot;true&quot; /&gt;
  &lt;/sub-deployment&gt;
  &lt;!-- Now we are going to define two additional modules --&gt;
  &lt;!-- This one is a different version of javassist that we have packaged --&gt;
  &lt;module name=&quot;deployment.myjavassist&quot; &gt;
    &lt;resources&gt;
     &lt;resource-root path=&quot;javassist.jar&quot; &gt;
       &lt;!-- We want to use the servers version of javassist.util.proxy.* so we filter it out--&gt;
       &lt;filter&gt;
         &lt;exclude path=&quot;javassist/util/proxy&quot; /&gt;
       &lt;/filter&gt;
     &lt;/resource-root&gt;
    &lt;/resources&gt;
  &lt;/module&gt;
  &lt;!-- This is a module that re-exports the containers version of javassist.util.proxy --&gt;
  &lt;!-- This means that there is only one version of the Proxy classes defined          --&gt;
  &lt;module name=&quot;deployment.javassist.proxy&quot; &gt;
    &lt;dependencies&gt;
      &lt;module name=&quot;org.javassist&quot; &gt;
        &lt;imports&gt;
          &lt;include path=&quot;javassist/util/proxy&quot; /&gt;
          &lt;exclude path=&quot;/**&quot; /&gt;
        &lt;/imports&gt;
      &lt;/module&gt;
    &lt;/dependencies&gt;
  &lt;/module&gt;
&lt;/jboss-deployment-structure&gt;</code></pre>
        </div>
    </div>
            </p>
        <div class="confbox admonition admonition-info">
        
            <p>
    The xsd for jboss-deployment-structure.xml is available at <a href="https://github.com/wildfly/wildfly-core/blob/master/server/src/main/resources/schema/jboss-deployment-structure-1_2.xsd">https://github.com/wildfly/wildfly-core/blob/master/server/src/main/resources/schema/jboss-deployment-structure-1_2.xsd</a>.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-AccessingJDKclasses"  >
        <h3>Accessing JDK classes</h3>
    
            <p>
    Not all JDK classes are exposed to a deployment by default. If your deployment uses JDK classes that are not exposed you can get access to them using jboss-deployment-structure.xml with system dependencies:            </p>
        <div class="confbox programlisting">
                    <div class="title">Using jboss-deployment-structure.xml to access JDK classes</div>
                <div class="content">
        <pre><code>&lt;jboss-deployment-structure xmlns=&quot;urn:jboss:deployment-structure:1.1&quot;&gt;
    &lt;deployment&gt;
        &lt;dependencies&gt;
            &lt;system export=&quot;true&quot;&gt;
                &lt;paths&gt;
                    &lt;path name=&quot;com/sun/corba/se/spi/legacy/connection&quot;/&gt;
                &lt;/paths&gt;
            &lt;/system&gt;
        &lt;/dependencies&gt;
    &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-Implicitmoduledependenciesfordeployments"  >
        <h2>Implicit module dependencies for deployments</h2>
    
            <p>
    As explained in the&nbsp;<a href="66322749.html">Class Loading in WildFly</a> article, WildFly 8&nbsp;is based on module classloading. A class within a module B isn't visible to a class within a module A, unless module B adds a dependency on module A. Module dependencies can be explicitly (as explained in that classloading article) or can be &quot;implicit&quot;. This article will explain what implicit module dependencies mean and how, when and which modules are added as implicit dependencies.            </p>
        <div class="section-3"  id="66322748_DeveloperGuide-What%27sanimplicitmoduledependency%3F"  >
        <h3>What&apos;s an implicit module dependency?</h3>
    
            <p>
    Consider an application deployment which contains EJBs. EJBs typically need access to classes from the javax.ejb.* package and other Java EE API packages. The jars containing these packages are already shipped in WildFly&nbsp;and are available as &quot;modules&quot;. The module which contains the javax.ejb.* classes has a specific name and so does the module which contains all the Java EE API classes. For an application to be able to use these classes, it has to add a dependency on the relevant modules. Forcing the application developers to add module dependencies like these (i.e. dependencies which can be &quot;inferred&quot;) isn't a productive approach. Hence, whenever an application is being deployed, the deployers within the server, which are processing this deployment &quot;implicitly&quot; add these module dependencies to the deployment so that these classes are visible to the deployment at runtime. This way the application developer doesn't have to worry about adding them explicitly. How and when these implicit dependencies are added is explained in the next section.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Howandwhenisanimplicitmoduledependencyadded%3F"  >
        <h3>How and when is an implicit module dependency added?</h3>
    
            <p>
    When a deployment is being processed by the server, it goes through a chain of &quot;deployment processors&quot;. Each of these processors will have a way to check if the deployment meets a certain criteria and if it does, the deployment processor adds a implicit module dependency to that deployment. Let's take an example - Consider (again) an EJB3 deployment which has the following class:            </p>
        <div class="confbox programlisting">
                    <div class="title">MySuperDuperBean.java</div>
                <div class="content">
        <pre><code>@Stateless
public class MySuperDuperBean {

...

}</code></pre>
        </div>
    </div>
            <p>
    As can be seen, we have a simple @Stateless EJB. When the deployment containing this class is being processed, the EJB deployment processor will see that the deployment contains a class with the @Stateless annotation and thus identifies this as a EJB deployment. <strong class=" "><u class=" ">This is just one of the several ways, various deployment processors can identify a deployment of some specific type.</u></strong> The EJB deployment processor will then add an implicit dependency on the Java EE API module, so that all the Java EE API classes are visible to the deployment.            </p>
                <p>
    Some subsystems will always add a API classes, even if the trigger condition is not met. These are listed&nbsp;separately&nbsp;below.&nbsp;            </p>
                <p>
    In the next section, we'll list down the implicit module dependencies that are added to a deployment, by various deployers within WildFly.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Whicharetheimplicitmoduledependencies%3F"  >
        <h3>Which are the implicit module dependencies?</h3>
    
    <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <span style="color: #333333;">
Subsystem responsible for adding the implicit dependency    </span>
            </td>
                <td rowspan="1" colspan="1">
        <span style="color: #333333;">
Dependencies that are always added    </span>
            </td>
                <td rowspan="1" colspan="1">
        <span style="color: #333333;">
Dependencies that are added if a trigger condition is met    </span>
            </td>
                <td rowspan="1" colspan="1">
        <span style="color: #333333;">
Trigger which leads to the implicit module dependency being added    </span>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Core Server            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javax.api&nbsp;            </p>
    </li><li class=" ">            <p>
    sun.jdk            </p>
    </li><li class=" ">            <p>
    org.jboss.vfs            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    EE Subsystem            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javaee.api            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    EJB3 subsystem            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javaee.api            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    The presence of ejb-jar.xml (in valid locations in the deployment, as specified by spec) or the presence of annotation based EJBs (ex: @Stateless, @Stateful, @MessageDriven etc)            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    JAX-RS (Resteasy) subsystem            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javax.xml.bind.api            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    org.jboss.resteasy.resteasy-atom-provider&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.resteasy.resteasy-cdi&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.resteasy.resteasy-jaxrs&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.resteasy.resteasy-jaxb-provider&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.resteasy.resteasy-jackson-provider&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.resteasy.resteasy-jsapi&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.resteasy.resteasy-multipart-provider&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.resteasy.async-http-servlet-30            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    The presence of JAX-RS annotations in the deployment            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    JCA sub-system            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javax.resource.api            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javax.jms.api&nbsp;            </p>
    </li><li class=" ">            <p>
    javax.validation.api&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.logging&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.ironjacamar.api&nbsp;            </p>
    </li><li class=" ">            <p>
    org.jboss.ironjacamar.impl&nbsp;            </p>
    </li><li class=" ">            <p>
    org.hibernate.validator            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    If the deployment is a resource adaptor (RAR) deployment.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    JPA (Hibernate) subsystem            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javax.persistence.api            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javaee.api            </p>
    </li><li class=" ">            <p>
    org.jboss.as.jpa            </p>
    </li><li class=" ">            <p>
    org.hibernate            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    The presence of an @PersistenceUnit or @PersistenceContext annotation, or a &lt;persistence-unit-ref&gt; or &lt;persistence-context-ref&gt; in a deployment descriptor.<br/>.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    Logging Subsystem            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    org.jboss.logging            </p>
    </li><li class=" ">            <p>
    org.apache.commons.logging            </p>
    </li><li class=" ">            <p>
    org.apache.log4j            </p>
    </li><li class=" ">            <p>
    org.slf4j            </p>
    </li><li class=" ">            <p>
    org.jboss.logging.jul-to-slf4j-stub            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    SAR Subsystem            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    org.jboss.logging            </p>
    </li><li class=" ">            <p>
    org.jboss.modules            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    The deployment is a SAR archive            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    Security Subsystem            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    org.picketbox            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    Web Subsystem            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javaee.api            </p>
    </li><li class=" ">            <p>
    com.sun.jsf-impl            </p>
    </li><li class=" ">            <p>
    org.hibernate.validator            </p>
    </li><li class=" ">            <p>
    org.jboss.as.web            </p>
    </li><li class=" ">            <p>
    org.jboss.logging            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    The deployment is a WAR archive. JSF is only added if used. Multiple version options exist for mojarra.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    Web Services Subsystem            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    org.jboss.ws.api            </p>
    </li><li class=" ">            <p>
    org.jboss.ws.spi            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    Weld (CDI) Subsystem            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class=" ">            <p>
    javax.persistence.api            </p>
    </li><li class=" ">            <p>
    javaee.api            </p>
    </li><li class=" ">            <p>
    org.javassist            </p>
    </li><li class=" ">            <p>
    org.jboss.interceptor            </p>
    </li><li class=" ">            <p>
    org.jboss.as.weld            </p>
    </li><li class=" ">            <p>
    org.jboss.logging            </p>
    </li><li class=" ">            <p>
    org.jboss.weld.core            </p>
    </li><li class=" ">            <p>
    org.jboss.weld.api            </p>
    </li><li class=" ">            <p>
    org.jboss.weld.spi            </p>
    </li></ul>            </td>
                <td rowspan="1" colspan="1">
    If a beans.xml file is detected in the deployment            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-HowdoImigratemyapplicationfromJBossAS5orAS6toWildFly8%3F"  >
        <h2>How do I migrate my application from JBoss AS 5 or AS 6 to WildFly 8?</h2>
    
            <p>
    The purpose of this guide is to document only those changes that are needed to  successfully run and deploy AS 5 applications on WildFly 8.It provides information on  to resolve deployment and runtime problems and how to prevent changes  in application behaviour. This is the first step in moving to the new  platform. Once the application is successfully deployed and running on the new  platform, plans can be made to upgrade individual components to use the new  functions and features of WildFly.            </p>
        <div class="section-3"  id="66322748_DeveloperGuide-MigrationOverview"  >
        <h3>Migration Overview</h3>
    
            <p>
    WildFly 8&nbsp;is structured differently from previous versions of JBoss AS, so you may want do a little research before you attempt to migrate your application. <a href="https://docs.jboss.org/author/display/WFLY8/Getting+Started+Guide#GettingStartedGuide-GettingStartedwithJBossApplicationServer7">Getting Started with WildFly</a> in the <a href="https://docs.jboss.org/author/display/WFLY8/Getting+Started+Guide">Getting Started Guide</a> has a lot of useful information, including a table that lists the Java Enterprise Edition 6 Web Profile features that are supported in WildFly. If your application uses features that go beyond the  Web Profile specification, you must use release&nbsp;WildFly 8 or later as it supports the <a href="http://www.oracle.com/technetwork/java/javaee/overview/compatibility-jsp-136984.html">EE6 Full Profile</a>. You should also read <a href="https://docs.jboss.org/author/display/WFLY8/Getting+started+with+JBoss+AS">Getting started with WildFly</a>&nbsp;for helpful information about how to install and run the application server.            </p>
                <p>
    The rest of this document describes some of the changes you might need to make to your application to successfully deploy and run it on WildFly.            </p>
        <div class="confbox admonition admonition-note">
            <div class="title">Reminder</div>
        
            <p>
    Before making any modifications to your application, make sure to create a backup copy.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UpdateApplicationDependenciesDuetoClassLoadingChanges"  >
        <h3>Update Application Dependencies Due to Class Loading Changes</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Modularclassloadingoverview"  >
        <h4>Modular class loading overview</h4>
    
            <p>
    Class loading in WildFly&nbsp;is considerably different than in previous versions of JBoss AS. Class loading is now based on the <a href="https://docs.jboss.org/author/display/MODULES/Home">JBoss Modules</a> project. Instead of the more familiar hierarchical class loading  environment, WildFly's class loading is based on modules that have to define  explicit dependencies on other modules. Deployments in WildFly&nbsp;are also  modules, and do not have access to classes that are defined in jars in  the application server unless an explicit dependency on those classes is  defined.            </p>
                <p>
    While&nbsp;WildFly&nbsp;modules are isolated by default, as part of the deployment process some dependencies on modules defined by the application server are set up for you automatically. For instance, if you are deploying a Java EE application, a dependency on the Java EE API's will be added to your module automatically. Similarly if your module contains a <tt class=" ">beans.xml</tt> file, a dependency on <a href="http://seamframework.org/Weld">Weld</a> will be added automatically, along with any supporting modules that weld needs to operate. For a complete list of the automatic dependencies that are added see&nbsp;<a href="https://docs.jboss.org/author/display/WFLY8/Implicit+module+dependencies+for+deployments">Implicit module dependencies for deployments</a>.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Understandmoduledependencies"  >
        <h4>Understand module dependencies</h4>
    
            <p>
    The deployers within the server &quot;implicitly&quot; add some commonly used module dependencies, like the javax.api and sun.jdk, to the deployment so that the classes are visible to the deployment at runtime. This way the application developer doesn't have to worry about adding them explicitly. How and when these implicit dependencies are added is explained in <a href="https://docs.jboss.org/author/display/WFLY8/Implicit+module+dependencies+for+deployments">Implicit module dependencies for deployments</a>.            </p>
                <p>
    For some classes, the modules must be specified explicitly in the <tt class=" ">MANIFEST.MF</tt> as Dependencies: or &quot;Class-Path:&quot; entries or in the <tt class=" ">jboss-deployment-structure.xml</tt>. Otherwise you may see ClassNotFoundExceptions, NoClassDefFoundErrors, or ClassCastExceptions. Tattletale is an excellent tool that can help you identify module dependencies in your application. Tattletale is described later in this document here: <a href="https://docs.jboss.org/author/display/WFLY8/Developer+Guide#DeveloperGuide-UseTattletaletofindapplicationdependencies">Use Tattletale to find application dependencies</a>.            </p>
                <p>
    You may also see runtime errors and page redirects to the JBoss Seam Debug Page. Manifest entries are explained in more detail here: <a href="https://docs.jboss.org/author/display/WFLY8/Class+Loading+in+AS7">Class Loading in WildFly</a>.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-HowtoPackageEARsandWARs"  >
        <h5>How to Package EARs and WARs</h5>
    
            <p>
    When you migrate your application, you may have to change the packaging structure of your EAR or WAR due to the class loading changes.            </p>
                <p>
    A WAR is a single module and all classes in the WAR are loaded with the same class loader. This means classes packaged in the WEB-INF/lib are treated the same as classes in WEB-INF/classes.            </p>
                <p>
    An EAR is different in that it consists of multiple modules. The <tt class=" ">EAR/lib</tt> directory is a single module, and every WAR or EJB jar deployment is also a separate module. Classes will not necessarily have access to other classes in the EAR unless explicit dependencies have been defined.            </p>
                <p>
    For more information on EAR and WAR packaging, see &quot;WAR Class Loading&quot; and &quot;EAR Class Loading&quot; in <a href="https://docs.jboss.org/author/display/WFLY8/Class+Loading+in+AS7">Class Loading in WildFly.</a>            </p>
        <div class="confbox admonition admonition-note">
            <div class="title">Reminder</div>
        
            <p>
    If you are using maven configure defaultLibBundleDir property to lib directory:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;build&gt;
      &lt;plugins&gt;
         &lt;plugin&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-ear-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
               &lt;!-- Tell maven to package in ear/lib for WildFly --&gt;
               &lt;defaultLibBundleDir&gt;lib&lt;/defaultLibBundleDir&gt;
...</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Createormodifyfilesthatcontrolclassloadingin%26nbsp%3BWildFly"  >
        <h4>Create or modify files that control class loading in&#160;WildFly</h4>
    
    <div class="section-5"  id="66322748_DeveloperGuide-jbossweb.xml"  >
        <h5>jboss-web.xml</h5>
    
            <p>
    If you have defined a <tt class=" ">class-loading</tt> element, you need to remove it.  The behaviour that this provokes in EAP 5 is now the default  class-loading behaviour in WildFly, so it is no longer necessary. If you do  not remove this element, you will see a ParseError and  XMLStreamException in your server log:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>javax.xml.stream.XMLStreamException: ParseError at [row,col]:[5,5]
    Message: Unexpected element 'class-loading' encountered
    at org.jboss.metadata.parser.util.MetaDataElementParser.unexpectedElement(MetaDataElementParser.java:109)
    at org.jboss.metadata.parser.jbossweb.JBossWebMetaDataParser.parse(JBossWebMetaDataParser.java:182)
    at org.jboss.as.web.deployment.JBossWebParsingDeploymentProcessor.deploy(JBossWebParsingDeploymentProcessor.java:64)
    ... 5 more</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-MANIFEST.MFfile"  >
        <h5>MANIFEST.MF file</h5>
    
    <div class="section-6"  id="66322748_DeveloperGuide-ManuallyeditedMANIFESTfiles"  >
        <h6>Manually edited MANIFEST files</h6>
    
            <p>
    Depending on which components your application uses, you may need to  add one or more dependencies to this file. There is more information  about these dependencies in the following paragraphs.<br/>The following is an example of <tt class=" ">MANIFEST.MF</tt> file that has been modified to contain dependencies and classpath entries:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Manifest-Version: 1.0
Dependencies: org.jboss.logmanager
Class-Path: OrderManagerEJB.jar</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    If you modify the <tt class=" ">MANIFEST.MF</tt> file, make sure to include a newline character at the end of the file.            </p>
        </div>
    
    </div>
    
    <div class="section-6"  id="66322748_DeveloperGuide-Howtodefine%7B%7BMANIFEST.MF%7D%7DfiledependenciesifyouuseMaven"  >
        <h6>How to define  MANIFEST.MF  file dependencies if you use Maven</h6>
    
            <p>
    If you use Maven, you may need to modify your <tt class=" ">pom.xml</tt> file to generate the dependencies for the <tt class=" ">MANIFEST.MF</tt> file.            </p>
                <p>
    If your application uses EJB 3.0, you may have a section in the <tt class=" ">pom.xml</tt> file that looks like the following:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-ejb-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;ejbVersion&gt;3.0&lt;/ejbVersion&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
        </div>
    </div>
            <p>
    If the EJB 3.0 code uses org.apache.commons.log, you will need to add that dependency to the <tt class=" ">MANIFEST.MF</tt> file. To do that, you will need to modify the <tt class=" ">plugin</tt> element in the <tt class=" ">pom.xml</tt> file as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-ejb-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;ejbVersion&gt;3.0&lt;/ejbVersion&gt;
        &lt;archive&gt;
            &lt;manifestFile&gt;src/main/resources/META-INF/MANIFEST.MF&lt;/manifestFile&gt;
        &lt;/archive&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
        </div>
    </div>
            <p>
    In the above example, the <tt class=" ">src/main/resources/MANIFEST.MF</tt> file only needs to contain the dependency entry:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Dependencies: org.apache.commons.logging</code></pre>
        </div>
    </div>
            <p>
    Maven will generate the complete <tt class=" ">MANIFEST.MF</tt> file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Manifest-Version: 1.0
Dependencies: org.apache.commons.logging</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-jbossdeploymentstructure.xml"  >
        <h5>jboss-deployment-structure.xml</h5>
    
            <p>
    This file is a JBoss specific deployment descriptor that can be  used to control class loading in a fine grained manner. Like the <tt class=" ">MANIFEST.MF</tt>,  this file can be used to add dependencies. If can also prevent  automatic dependencies from being added, define additional modules,  change an EAR deployment's isolated class loading behaviour, and add  additional resource roots to a module.            </p>
                <p>
    For additional information, see <a href="https://docs.jboss.org/author/display/WFLY8/Developer+Guide#DeveloperGuide-%26nbsp%3Bjbossdeploymentstructure.xml">jboss-deployment-structure.xml</a><a href="https://docs.jboss.org/author/display/WFLY8/Class+Loading+in+AS7">.</a>            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-application.xml"  >
        <h5>application.xml</h5>
    
            <p>
    In previous versions of JBoss AS, you controlled the order of deployments within an EAR through the use of the <tt class=" ">jboss-app.xml</tt> file. This is no longer the case. The Java EE6 spec provides the &lt;initialize-in-order&gt; element in the <tt class=" ">application.xml</tt> which allows control of the order in which the Java EE modules within an EAR are deployed.            </p>
                <p>
    In most cases you do not need to specify deployment order. If your application uses dependency injections and resource-refs to refer to components in external modules, in most cases the &lt;initialize-in-order&gt; element is not required because the application server is able to implicitly determine the correct and optimal way of ordering the components.            </p>
                <p>
    Assume you have an application that contains a <tt class=" ">myBeans.jar</tt> and a <tt class=" ">myApp.war</tt> within a <tt class=" ">myApp.ear</tt>. A servlet in the <tt class=" ">myApp.war</tt> @EJB injects a bean from <tt class=" ">myBeans.jar</tt>. In this case, the application server has the appropriate knowledge to make sure that the EJB component is available before the servlet is started and you do not have to use the &lt;initialize-in-order&gt; element.            </p>
                <p>
    However, if that servlet uses legacy JNDI lookup style remote references like the following to access the bean, you may need to specify module order.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>init() {
  Context ctx = new InitialContext();
  ctx.lookup(&quot;TheBeanInMyBeansModule&quot;);
}</code></pre>
        </div>
    </div>
            <p>
    In this case, the server is not able to determine that that EJB component is in the <tt class=" ">myBeans.jar</tt> and you need to enforce that the components in the <tt class=" ">myBeans.jar</tt> are initialized and started before the components in <tt class=" ">myApp.war</tt>. To do this, you set the &lt;initialize-in-order&gt; element to <tt class=" ">true</tt> and specify the order of the <tt class=" ">myBeans.jar</tt> and <tt class=" ">myApp.war</tt> modules in the <tt class=" ">application.xml</tt> file.            </p>
                <p>
    The following is an example that uses the &lt;initialize-in-order&gt; element to control deployment order. The myBeans.jar is deployed before the myApp.war.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;application xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
             version=&quot;6&quot;
             xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd&quot;&gt;
    &lt;application-name&gt;jboss-as-ejb-in-ear&lt;/application-name&gt;
    &lt;initialize-in-order&gt;true&lt;/initialize-in-order&gt;
    &lt;module&gt;
        &lt;ejb&gt;myBeans.jar&lt;/ejb&gt;
    &lt;/module&gt;
    &lt;module&gt;
        &lt;web&gt;
            &lt;web-uri&gt;myApp.war&lt;/web-uri&gt;
            &lt;context-root&gt;myApp&lt;/context-root&gt;
        &lt;/web&gt;
    &lt;/module&gt;
&lt;/application&gt;</code></pre>
        </div>
    </div>
            <p>
    The schema for the <tt class=" ">application.xml</tt> file can be found here at <a href="http://java.sun.com/xml/ns/javaee/application_6.xsd">http://java.sun.com/xml/ns/javaee/application_6.xsd</a>.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    You should be aware that setting &lt;initialize-in-order&gt; to <tt class=" ">true</tt> slows down deployment. It is preferable to define proper dependencies using dependency injections or resource-refs since it allows the container more flexibility in optimizing deployments.            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ChangeResourceBundlelocation"  >
        <h4>Change ResourceBundle location</h4>
    
            <p>
    In previous versions of AS, the <tt class=" ">JBOSS_HOME/server/&lt;servername&gt;/conf/</tt> was available in the  classpath. Hence the properties files in that  location were available in  the classpath of the application.            </p>
                <p>
    In WildFly 8, to get those properties available in the classpath, package  them  within your application. For example, if you are deploying a .war  then  package those properties in WAR <tt class=" ">WEB-INF/classes/</tt> folder.  If you want  those properties accessible to all components in a .ear,  then package  them at the root of some .jar and place that jar in EAR <tt class=" ">lib/</tt> folder.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-WheretoFindAdditionalInformation"  >
        <h4>Where to Find Additional Information</h4>
    
            <p>
    For more information about the class loading changes in WildFly 8, see <a href="https://docs.jboss.org/author/display/WFLY8/Class+Loading+in+AS7">Class Loading in WildFly 8</a>.<br/>For more information about modular class loading, see the <a href="http://community.jboss.org/wiki/ModuleCompatibleClassloadingGuide">Module Compatible Classloading Guide.</a><br/>For information about deployment module dependencies, see <a href="http://community.jboss.org/wiki/DeploymentModuleDependencies">Deployment Module Dependencies</a>.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UpdatetheDataSourceConfiguration"  >
        <h3>Update the DataSource Configuration</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Overview"  >
        <h4>Overview</h4>
    
            <p>
    In previous versions of the application server, the JCA data source configuration was defined in a file with a suffix of <tt class=" ">*-ds.xml</tt>. This file was then deployed in the server's deploy directory. The JDBC driver was copied to the server <tt class=" ">lib/</tt> directory or packaged in the application's <tt class=" ">WEB-INF/lib/</tt> directory.            </p>
                <p>
    In AS7, this has all changed. You will no longer package the JDBC driver with the application or in the <tt class=" ">server/lib</tt> directory. The <tt class=" ">*-ds.xml</tt> file is now obsolete and the datasource configuration information is now defined in the <tt class=" ">standalone/configuration/standalone.xml</tt> or in the <tt class=" ">domain/configuration/domain.xml</tt> file. The IronJacamar distribution features a migration tool that can help you convert your previous datasource configuration file into the new format. You can find more information about the tool here: <a href="https://docs.jboss.org/author/display/WFLY8/Developer+Guide#DeveloperGuide-IronJacamarDatasourceandResourceAdapterMigrationTool">IronJacamar Datasource and Resource Adapter Migration Tool </a>.            </p>
                <p>
    A JDBC 4-compliant driver can be installed as a deployment or as a core module. A driver that is JDBC 4-compliant contains a <tt class=" ">META-INF/services/java.sql.Driver</tt> file that specifies the driver class name. A driver that is not JDBC 4-compliant requires additional steps, as noted below.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Definethedatasource"  >
        <h4>Define the datasource</h4>
    
            <p>
    In WildFly 8, a datasource is configured in the server configuration file. If you are running in domain mode, the configuration file is the <tt class=" ">domain/configuration/domain.xml</tt> file. If you are running in standalone mode, you will configure the datasource in the <tt class=" ">standalone/configuration/standalone.xml</tt> file. Schema reference information, which is the same for both modes, can be found here: <a href="http://docs.jboss.org/ironjacamar/userguide/1.0/en-US/html/deployment.html#deployingds_descriptor">Datasource Descriptors</a>.            </p>
                <p>
    First, you will need to create a <tt class=" ">datasource</tt> element and a <tt class=" ">driver</tt> element for your JDBC driver and datasource information in the <tt class=" ">standalone.xml</tt> or <tt class=" ">domain.xml</tt> file. You will use some of the same information that was previously defined in the <tt class=" ">*-ds.xml</tt> file.            </p>
                <p>
    The following is an example of a MySQL <tt class=" ">datasource</tt> element:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;datasource jndi-name=&quot;java:/YourDatasourceName&quot; pool-name=&quot;YourDatasourceName&quot;&gt;
  &lt;connection-url&gt;jdbc:mysql://localhost:3306/YourApplicationURL&lt;/connection-url&gt;
  &lt;driver&gt; mysql-connector-java-5.1.15.jar &lt;/driver&gt;
  &lt;transaction-isolation&gt; TRANSACTION_READ_COMMITTED &lt;/transaction-isolation&gt;
  &lt;pool&gt;
    &lt;min-pool-size&gt;100&lt;/min-pool-size&gt;
    &lt;max-pool-size&gt;200&lt;/max-pool-size&gt;
  &lt;/pool&gt;
  &lt;security&gt;
    &lt;user-name&gt; USERID &lt;/user-name&gt;
    &lt;password&gt; PASSWORD&lt;/password&gt;
  &lt;/security&gt;
  &lt;statement&gt;
    &lt;prepared-statement-cache-size&gt;100&lt;/prepared-statement-cache-size&gt;
    &lt;share-prepared-statements/&gt;
  &lt;/statement&gt;
&lt;/datasource&gt;</code></pre>
        </div>
    </div>
            <p>
    A JAR that is JDBC 4-compliant contains a META-INF/services/java.sql.Driver file that specifies the driver class name. This is used by the server to find name of the class(es) of the Drivers which exist in that JAR.            </p>
                <p>
    This is an example of the <tt class=" ">driver</tt> element for a JDBC 4-compliant MySQL driver.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&nbsp;&nbsp;&nbsp; &lt;driver name=&quot;mysql-connector-java-5.1.15.jar&quot; module=&quot;com.mysql&quot;/&gt;</code></pre>
        </div>
    </div>
            <p>
    This is an example of the driver element for driver that is not JDBC 4-compliant. The driver-class must be specified since it there is no <tt class=" ">META-INF/services/java.sql.Driver</tt> file that specifies the driver class name.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;driver name=&quot;mysql-connector-java-5.1.15.jar&quot; module=&quot;com.mysql&quot;&gt;
        &lt;driver-class&gt;com.mysql.jdbc.Driver&lt;/driver-class&gt;
    &lt;/driver&gt;</code></pre>
        </div>
    </div>
            <p>
    For more information on how to add a MySQL driver, see <a href="https://zorq.net/b/2011/07/12/adding-a-mysql-datasource-to-jboss-as-7/">Adding a MySQL datasource to JBoss AS 7</a>.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-InstalltheJDBCdriver"  >
        <h4>Install the JDBC driver</h4>
    
            <p>
    The JDBC driver can be installed into the container in one of two ways:  either as a deployment or as a core module. There are pros and cons to  each approach, which will be outlined below. For a detailed explanation how to deploy JDBC 4-compliant driver jar, please refer to the <a href="https://docs.jboss.org/author/display/WFLY8/Admin+Guide#AdminGuide-Datasources">DataSources</a> chapter of the Admin Guide.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-InstalltheJDBCdriverasadeployment"  >
        <h5>Install the JDBC driver as a deployment</h5>
    
            <p>
    When you install the JDBC driver as a deployment, it is deployed as a regular JAR. This is the recommended way to install the driver. When you run your application server in domain mode, deployments are automatically propagated to all servers to which the deployment applies; thus distribution of the driver JAR is one less thing for administrators to worry about.            </p>
                <p>
    Any JDBC 4-compliant driver will automatically be recognized and installed into the system by name and version. A JDBC 4-compliant JAR is identified using the Java service provider mechanism. It contains a text a file named &quot;META-INF/services/java.sql.Driver&quot;, which contains the name of the class(es) of the Drivers which exist in that JAR. If your JDBC driver JAR is not JDBC 4-compliant, it can be made deployable by adding the java.sql.Driver file to the JAR or by deploying the JAR with an overlay. More information on that topic can be found here: <a href="http://community.jboss.org/wiki/DataSourceConfigurationinAS7#Installing_a_JDBC_driver_as_a_deployment">Installing a JDBC Driver as a Deployment</a>.            </p>
                <p>
    In WildFly 8&nbsp;standalone mode, you simply copy the JDBC 4-compliant JAR into the <tt class=" ">AS7_HOME/standalone/deployments directory</tt>. Here is an example of a MySQL JDBC driver installed as a deployment:            </p>
                <p>
    &nbsp;&nbsp;&nbsp; <tt class=" ">JBOSS_HOME/standalone/deployments/mysql-connector-java-5.1.15.jar</tt>            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    If the JDBC driver consists of more than one JAR, for example a JAR with the driver and a dependent license JAR, you can not install the driver as a deployment. You must install the JDBC driver as a core module.            </p>
        </div>
    
    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-InstalltheJDBCdriverasacoremodule"  >
        <h5>Install the JDBC driver as a core module</h5>
    
            <p>
    To install the driver as a module, you will need to create a directory structure under the modules folder. This structure will contain the driver and a <tt class=" ">module.xml</tt> file to define the module.            </p>
                <p>
    For example, using the MySQL JDBC driver above, you would create a directory structure as follows:            </p>
                <p>
    &nbsp;&nbsp;&nbsp; <tt class=" ">JBOSS_HOME/modules/com/mysql/main</tt>            </p>
                <p>
    In the main directory, you then create the following <tt class=" ">module.xml</tt> file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;!--
      ~ JBoss, Home of Professional Open Source.
      ~ Copyright 2010, Red Hat, Inc., and individual contributors as indicated by the @author tags. See the copyright.txt file in the
      ~ distribution for a full listing of individual contributors.
      ~
      ~ This is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as
      ~ published by the Free Software Foundation; either version 2.1 of the License, or (at your option) any later version.
      ~
      ~ This software is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
      ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
      ~
      ~ You should have received a copy of the GNU Lesser General Public License along with this software; if not, write to the Free
      ~ Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA, or see the FSF site: http://www.fsf.org.
      --&gt;


    &lt;module xmlns=&quot;urn:jboss:module:1.0&quot; name=&quot;com.mysql&quot;&gt;
        &lt;resources&gt;
            &lt;resource-root path=&quot;mysql-connector-java-5.1.15.jar&quot;/&gt;
        &lt;/resources&gt;
        &lt;dependencies&gt;
            &lt;module name=&quot;javax.api&quot;/&gt;
        &lt;/dependencies&gt;
    &lt;/module&gt;</code></pre>
        </div>
    </div>
            <p>
    The module name, &quot;com.mysql&quot;, matches the directory structure for this module. Under dependencies, you specify the module's dependencies on other modules. In this case, as the case with all JDBC data sources, it is dependent on the Java JDBC APIs which are defined in another module named javax.api that is located under modules/javax/api/main.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    Make sure you do NOT have a space at the beginning of <tt class=" ">module.xml</tt> file or you will get a &quot;New missing/unsatisfied dependencies&quot; error for this driver.            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ConfigurethedatasourceforHibernateorJPA"  >
        <h4>Configure the datasource for Hibernate or JPA</h4>
    
            <p>
    If your application uses JPA and currently bundles the Hibernate JARs, you may want to use the Hibernate that is included with WildFly 8. You should remove the Hibernate jars from your application. You should also remove the &quot;hibernate.transaction.manager_lookup_class&quot; property from your persistence.xml as this is not needed.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-WheretoFindAdditionalInformation2"  >
        <h4>Where to Find Additional Information</h4>
    
            <p>
    <a href="http://community.jboss.org/wiki/DataSourceConfigurationinAS7">DataSource Configuration in WildFly 8</a><br/><a href="http://docs.jboss.org/ironjacamar/userguide/1.0/en-US/html/deployment.html#deployingds_descriptor">DataSource Descriptors</a><br/><a href="https://docs.jboss.org/author/display/WFLY8/DataSource+configuration">Admin Guide - DataSource Configuration</a><br/><a href="http://www.javalinux.it/wordpress/2011/07/14/how-to-create-an-manage-datasources-in-as7/">How to create and manage datasources in WildFly 8</a><br/><a href="https://zorq.net/b/2011/07/12/adding-a-mysql-datasource-to-jboss-as-7/">Adding a MySQL datasource to WildFly 8</a>.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UpdatetheResourceAdapterConfiguration"  >
        <h3>Update the Resource Adapter Configuration</h3>
    
            <p>
    TODO: The following section on Resource adapters needs to be reviewed            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-Overview2"  >
        <h4>Overview</h4>
    
            <p>
    In previous versions of the application server, the resource adapter configuration was defined in a file with a suffix of <tt class=" ">*-ds.xml</tt>.            </p>
                <p>
    In WildFly 8, a resource adapter is configured in the server configuration file.  If you are running in domain mode, the configuration file is the <tt class=" ">domain/configuration/domain.xml</tt> file. If you are running in standalone mode, you will configure the resource adapter in the <tt class=" ">standalone/configuration/standalone.xml</tt> file. Schema reference information, which is the same for both modes, can be found here: <a href="http://docs.jboss.org/ironjacamar/userguide/1.0/en-US/html/deployment.html#deployingra_descriptor">Resource adapter descriptors</a>. The IronJacamar distribution features a migration tool that can help you convert your previous datasource configuration file into the new format. You can find more information about the tool here: <a href="https://docs.jboss.org/author/display/WFLY8/Developer+Guide#DeveloperGuide-IronJacamarDatasourceandResourceAdapterMigrationTool">IronJacamar Datasource and Resource Adapter Migration Tool </a>.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Definetheresourceadapter"  >
        <h4>Define the resource adapter</h4>
    
            <p>
    The resource adapter descriptor information is defined under the <tt class=" ">&lt;subsystem xmlns=&quot;urn:jboss:domain:resource-adapters:1.0&quot;/&gt;</tt> element in the server configuration file. You will use some of the same information that was previously defined in the <tt class=" ">*-ds.xml</tt> file.            </p>
                <p>
    The following is an example of a resource adapter element in the server configuration file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;resource-adapters&gt;
  &lt;resource-adapter&gt;
    &lt;archive&gt;multiple-full.rar&lt;/archive&gt;
    &lt;config-property name=&quot;Name&quot;&gt;ResourceAdapterValue&lt;/config-property&gt;
    &lt;transaction-support&gt;NoTransaction&lt;/transaction-support&gt;
    &lt;connection-definitions&gt;
      &lt;connection-definition
      class-name=&quot;org.jboss.jca.test.deployers.spec.rars.multiple.MultipleManagedConnectionFactory1&quot;
      enabled=&quot;true&quot; jndi-name=&quot;java:/eis/MultipleConnectionFactory1&quot;
      pool-name=&quot;MultipleConnectionFactory1&quot;&gt;
	&lt;config-property name=&quot;Name&quot;&gt;MultipleConnectionFactory1Value&lt;/config-property&gt;
      &lt;/connection-definition&gt;
      &lt;connection-definition
      class-name=&quot;org.jboss.jca.test.deployers.spec.rars.multiple.MultipleManagedConnectionFactory2&quot;
      enabled=&quot;true&quot; jndi-name=&quot;java:/eis/MultipleConnectionFactory2&quot;
      pool-name=&quot;MultipleConnectionFactory2&quot;&gt;
	&lt;config-property name=&quot;Name&quot;&gt;MultipleConnectionFactory2Value&lt;/config-property&gt;
      &lt;/connection-definition&gt;
    &lt;/connection-definitions&gt;
    &lt;admin-objects&gt;
      &lt;admin-object
      class-name=&quot;org.jboss.jca.test.deployers.spec.rars.multiple.MultipleAdminObject1Impl&quot;
      jndi-name=&quot;java:/eis/MultipleAdminObject1&quot;&gt;
	&lt;config-property name=&quot;Name&quot;&gt;MultipleAdminObject1Value&lt;/config-property&gt;
      &lt;/admin-object&gt;
      &lt;admin-object class-name=&quot;org.jboss.jca.test.deployers.spec.rars.multiple.MultipleAdminObject2Impl&quot;
      jndi-name=&quot;java:/eis/MultipleAdminObject2&quot;&gt;
	&lt;config-property name=&quot;Name&quot;&gt;MultipleAdminObject2Value&lt;/config-property&gt;
      &lt;/admin-object&gt;
      &lt;/admin-objects&gt;
  &lt;/resource-adapter&gt;
&lt;/resource-adapters&gt;</code></pre>
        </div>
    </div>
            <p>
    TODO: The above section on Resource adapters needs to be reviewed            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UpdateapplicationJNDInamespacenames"  >
        <h3>Update application JNDI namespace names</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Overview3"  >
        <h4>Overview</h4>
    
            <p>
    EJB 3.1 introduced a standardized global JNDI namespace and a series of related namespaces that map to the various scopes of a Java EE application. The three JNDI namespaces used for portable JNDI lookups are java:global, java:module, and java:app. If you use JNDI lookups in your application, you will need to change them to follow the new standardized JNDI namespace convention.            </p>
                <p>
    To conform to the new portable JNDI namespace rules, you will need to review the JNDI namespace rules and modify the application code to follow these rules.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ReviewtheJNDINamespaceRules"  >
        <h4>Review the JNDI Namespace Rules</h4>
    
            <p>
    WildFly 8&nbsp;has tightened up on JNDI namespace names to provide predictable   and consistent rules for every name bound in the application server and   to prevent future compatibility issues. This means you might run into   issues with the current namespaces in your application if they don't   follow the new rules.            </p>
                <p>
    Namespaces should follow these rules:            </p>
    <ol class=" "><li class=" ">            <p>
    Unqualified relative names like &quot;ExampleDS&quot; or &quot;jdbc/ExampleDS&quot;<br/>should be qualified relative to &quot;java:comp/env&quot;, &quot;java:module/env&quot;, or<br/>&quot;java:jboss/env&quot;, depending on the context.            </p>
    </li><li class=" ">            <p>
    Unqualified &quot;absolute&quot; names like &quot;/jdbc/ExampleDS&quot; should be<br/>qualified relative to a &quot;java:jboss/root&quot; name.            </p>
    </li><li class=" ">            <p>
    Qualified &quot;absolute&quot; names like &quot;java:/jdbc/ExampleDS&quot; should be<br/>qualified the same way as #2.            </p>
    </li><li class=" ">            <p>
    The special &quot;java:jboss&quot; namespace is shared across the entire AS<br/>server instance.            </p>
    </li><li class=" ">            <p>
    Any &quot;relative&quot; name with a &quot;java:&quot; lead-in must be in one of the five<br/>namespaces: &quot;comp&quot;, &quot;module&quot;, &quot;app&quot;, &quot;global&quot;, or our proprietary<br/>&quot;jboss&quot;. Any name starting with &quot;java:xxx&quot; where &quot;xxx&quot; is a name which<br/>is not equal to one of the above five would result in an invalid name error.            </p>
    </li></ol>    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ModifyyourapplicationcodetofollowthenewJNDInamespacerules"  >
        <h4>Modify your application code to follow the new JNDI namespace rules</h4>
    
            <p>
    Here's an example of a JNDI lookup in EAP 5.1. This code is usually found in an initialization method. Note the lookup name is: &quot;OrderManagerApp/ProductManagerBean/local&quot;.            </p>
        <div class="confbox programlisting">
                    <div class="title">Old - EAP 5.1</div>
                <div class="content">
        <pre><code>private ProductManager productManager;
try {
    context = new InitialContext();
    productManager = (ProductManager) context.lookup(&quot;OrderManagerApp/ProductManagerBean/local&quot;);
}

catch(Exception lookupError) {
    throw new ServletException(&quot;Unable to find the ProductManager bean&quot;, lookupError);
}</code></pre>
        </div>
    </div>
            <p>
    Here is an example of how the same lookup would be coded in WildFly 8. This code is defined as member variables. The lookup name now uses the new portable java:app JNDI namespace: &quot;java:app/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager&quot;            </p>
        <div class="confbox programlisting">
                    <div class="title">New - AS 7</div>
                <div class="content">
        <pre><code>@EJB(lookup=&quot;java:app/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager&quot;)
private ProductManager productManager;
&nbsp;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ExamplesofJNDImappingsinpreviousreleasesandhowtheymightlooknow"  >
        <h4>Examples of JNDI mappings in previous releases and how they might look now</h4>
    
            <p>
    (This needs input!)            </p>
        <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Previous Namespace            </td>
                <td rowspan="1" colspan="1">
    New Namespaces            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    OrderManagerApp/ProductManagerBean/local            </td>
                <td rowspan="1" colspan="1">
    java:module/ProductManagerBean!services.ejb.ProductManager (EE6 standard binding, only accessible within the same module)            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    OrderManagerApp/ProductManagerBean/local            </td>
                <td rowspan="1" colspan="1">
    java:app/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager (EE6 standard binding, only accessible within the same application)            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    OrderManagerApp/ProductManagerBean/local            </td>
                <td rowspan="1" colspan="1">
    java:global/OrderManagerApp/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager (EE6 standard binding, globally accessible)            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    java:comp/UserTransaction            </td>
                <td rowspan="1" colspan="1">
    java:comp/UserTransaction (This will not be accessible for non EE threads, e.g. Threads your application directly creates)            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    java:comp/UserTransaction            </td>
                <td rowspan="1" colspan="1">
    java:jboss/UserTransaction (Globally accessible, use this if java:comp/UserTransaction is not available)            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    java:/TransactionManager            </td>
                <td rowspan="1" colspan="1">
    java:jboss/TransactionManager            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    java:/TransactionSynchronizationRegistry            </td>
                <td rowspan="1" colspan="1">
    java:jboss/TransactionSynchronizationRegistry            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-WheretoFindAdditionalInformation%5C%5C"  >
        <h4>Where to Find Additional Information</h4>
    
            <p>
    <a href="http://download.oracle.com/javaee/6/tutorial/doc/gipjf.html#girgn">Java EE6 Tutorial - Portable JNDI Syntax</a><br/><a href="http://blogs.oracle.com/kensaks/entry/application_specified_portable_jndi_names">Application-specified Portable JNDI Names</a>            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-MigrateremoteEJBclientstotheWildFly8%26nbsp%3BclientAPI"  >
        <h3>Migrate remote EJB clients to the WildFly 8&#160;client API</h3>
    
            <p>
    TODO: complete this section            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-MigrateEAP5DeployedApplicationsThatMakeRemoteInvocationsto%26nbsp%3BWildFly8"  >
        <h3>Migrate EAP 5 Deployed Applications That Make Remote Invocations to&#160;WildFly 8</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Overview4"  >
        <h4>Overview</h4>
    
            <p>
    In WildFly 8, there are two ways to make remote invocations to the server:            </p>
    <ol class=" "><li class=" ">            <p>
    You can use the new JBoss specific EJB client API to do the invocation.            </p>
    </li><li class=" ">            <p>
    You can use JNDI to lookup a proxy for your bean and invoke on that returned proxy.            </p>
    </li></ol>            <p>
    This section covers option 2: coding changes required for clients that use JNDI.            </p>
                <p>
    In EAP 5, the EJB remote interface was bound in JNDI, by default, under the name &quot;ejbName/local&quot; for local interfaces, and &quot;ejbName/remote&quot; for the remote interfaces. The client application then looked up the stateful bean using &quot;ejbName/remote&quot;.            </p>
                <p>
    In AS 7, you use the ejb: namespace for remote access to EJBs with the following syntax:<br/>For stateless beans:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>ejb:&lt;app-name&gt;/&lt;module-name&gt;/&lt;distinct-name&gt;/&lt;bean-name&gt;!&lt;fully-qualified-classname-of-the-remote-interface&gt;</code></pre>
        </div>
    </div>
            <p>
    For stateful beans:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>ejb:&lt;app-name&gt;/&lt;module-name&gt;/&lt;distinct-name&gt;/&lt;bean-name&gt;!&lt;fully-qualified-classname-of-the-remote-interface&gt;?stateful</code></pre>
        </div>
    </div>
            <p>
    The values to be substituted in the above syntax are:            </p>
    <ul class=" "><li class=" ">            <p>
    &lt;app-name&gt; - the application name of the deployed EJBs. This is typically the ear name without the .ear suffix, however, the name can be overridden in the application.xml file. If the application is not deployed as a .ear, this value is an empty string. Assume this example was not deployed as an EAR.            </p>
    </li><li class=" ">            <p>
    &lt;module-name&gt; - the module name of the deployed EJBs on the server. This is typically the jar name of the EJB deployment, without the .jar suffix, but can be overridden via the ejb-jar.xml. In this example, assume the EJBs were deployed in a jboss-as-ejb-remote-app.jar, so the module name is jboss-as-ejb-remote-app.            </p>
    </li><li class=" ">            <p>
    &lt;distinct-name&gt; - an optional distinct name for the EJB. This example doesn't use a distinct name, so it uses an empty string.            </p>
    </li><li class=" ">            <p>
    &lt;bean-name&gt; - by default, is the simple class name of the bean implementation class.            </p>
    </li><li class=" ">            <p>
    &lt;fully-qualified-classname-of-the-remote-interface&gt; - the remote view fully qualified class name.            </p>
    </li></ul>    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-UpdatetheClientCode"  >
        <h4>Update the Client Code</h4>
    
            <p>
    Assume you have deployed the following stateless EJB to an AS 7 server. Note that it exposes a remote view for the bean.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>@Stateless
@Remote(RemoteCalculator.class)
public class CalculatorBean implements RemoteCalculator {

    @Override
    public int add(int a, int b) {
        return a + b;
    }

    @Override
    public int subtract(int a, int b) {
        return a - b;
    }
}</code></pre>
        </div>
    </div>
            <p>
    In EAP 5, the client EJB lookup and invocation was coded something like this:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>InitialContext ctx = new InitialContext();
RemoteCalculator calculator = (RemoteCalculator)
				 ctx.lookup(&quot;CalculatorBean/remote&quot;);
int a = 204;
int b = 340;
int sum = calculator.add(a, b));</code></pre>
        </div>
    </div>
            <p>
    In AS 7, using the information described above, the client lookup and invocation is coded like this:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>final Hashtable jndiProperties = new Hashtable();
jndiProperties.put(Context.URL_PKG_PREFIXES, &quot;org.jboss.ejb.client.naming&quot;);
final Context context = new InitialContext(jndiProperties);
final String appName = &quot;&quot;;
final String moduleName = &quot;jboss-as-ejb-remote-app&quot;;
final String distinctName = &quot;&quot;;
final String beanName = CalculatorBean.class.getSimpleName();
final String viewClassName = RemoteCalculator.class.getName();
final RemoteCalculator statelessRemoteCalculator =  RemoteCalculator) context.lookup(&quot;ejb:&quot; + appName + &quot;/&quot; + moduleName + &quot;/&quot; + distinctName + &quot;/&quot; + beanName + &quot;!&quot; + viewClassName);

int a = 204;
int b = 340;
int sum = statelessRemoteCalculator.add(a, b);</code></pre>
        </div>
    </div>
            <p>
    If your client is accessing a stateful EJB, you must append &ldquo;?stateful&rdquo; to the end of the context lookup like this:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>final RemoteCalculator statelessRemoteCalculator =  RemoteCalculator) context.lookup(&quot;ejb:&quot; + appName + &quot;/&quot; + moduleName + &quot;/&quot; + distinctName + &quot;/&quot; + beanName + &quot;!&quot; + viewClassName + &quot;?stateful&quot;);</code></pre>
        </div>
    </div>
            <p>
    A complete working example, including both server and client code, can be found at the github repo here <a href="https://github.com/jbossas/quickstart/tree/master/ejb-remote">https://github.com/jbossas/quickstart/tree/master/ejb-remote</a>.            </p>
                <p>
    For more information on remote invocations using JNDI, see <a href="https://docs.jboss.org/author/display/WFLY8/EJB+invocations+from+a+remote+client+using+JNDI">EJB invocations from a remote client using JNDI</a>.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Modifyloggingdependencies"  >
        <h3>Modify logging dependencies</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Overview5"  >
        <h4>Overview</h4>
    
            <p>
    JBoss LogManager supports front ends for all logging frameworks, so you can keep your current logging code or move to the new JBoss logging infrastructure. Regardless of your decision, because of the modular class loading changes, you will probably need to modify your application to add the required dependencies.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Updateyourapplicationcodeforthirdpartyloggingframeworks"  >
        <h4>Update your application code for third-party logging frameworks</h4>
    
            <p>
    As of WildFly 8,&nbsp;logging dependencies are added by default. There is one caveat to this. If you're using log4j and you don't want to use the logging subsystem to configure your handlers (appenders), then you need to exclude the server copy of log4j. See the <a href="https://docs.jboss.org/author/display/AS71/How+To#HowTo-HowdoIuselog4j.propertiesorlog4j.xmlinsteadofusingtheloggingsubsystemconfiguration%3F">logging documentation</a>            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ModifycodetousetheNewJBossLoggingFramework"  >
        <h4>Modify code to use the New JBoss Logging Framework</h4>
    
            <p>
    To use the new framework, you will need the change your imports and code as follows to achieve the same results as above:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>import org.jboss.logging.Level;
import org.jboss.logging.Logger;

private static final Logger logger = Logger.getLogger(MyClass.class.toString());

if(logger.isTraceEnabled()) {
    logger.tracef(&quot;Starting...&quot;, subsystem);
}</code></pre>
        </div>
    </div>
            <p>
    The JAR containing the JBoss Logging classes is located in the module named &quot;org.jboss.logging&quot;. Your MANIFEST-MF file will look like this:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&nbsp;&nbsp;&nbsp; Dependencies: org.jboss.logging</code></pre>
        </div>
    </div>
            <p>
    For more information on how to find the module dependency, please see &ldquo;How to Resolve ClassNotFoundExceptions&rdquo; under the &ldquo;Modular Class Loading&rdquo; above.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-WheretoFindAdditionalInformation3"  >
        <h4>Where to Find Additional Information</h4>
    
            <p>
    <a href="http://community.jboss.org/wiki/JBossAS7Logging">WildFly 8 Logging</a><br/><a href="http://community.jboss.org/wiki/JBossLoggingTooling">JBoss Logging Tooling</a>            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ConfigurechangesforapplicationsthatuseHibernateandJPA"  >
        <h3>Configure changes for applications that use Hibernate and JPA</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Overview6"  >
        <h4>Overview</h4>
    
            <p>
    If your application contains a <tt class=" ">persistence.xml</tt> file or the code uses @PersistenceContext or @PersistenceUnit, WildFly 8&nbsp;will detect this during deployment and assume the application uses JPA. It will implicitly add Hibernate 4 and a few other dependencies to your application classpath.            </p>
                <p>
    If your application currently uses Hibernate 3 libraries, in most cases, this will not be a problem. You will be able to deploy and run successfully using Hibernate 4. However, if&nbsp; you see a ClassNotFoundExceptions when deploying your application you can try one of two following approaches:            </p>
    <ol class=" "><li class=" ">            <p>
    You may be able to resolve the issue by copying the specific Hibernate 3 JARs containing those classes into the application &quot;/lib&quot; directory or by adding them to the classpath using some other method. In some cases this may result in ClassCastExceptions or other class loading issues due to the mixed use of the Hibernate versions, so you will need to use the second approach.            </p>
    </li><li class=" ">            <p>
    You need to tell the server to use only the Hibernate 3 libraries and you will need to add exclusions for the Hibernate 4 libraries. Details on how to do this are described here: <a href="https://docs.jboss.org/author/display/WFLY8/JPA+Reference+Guide">JPA Reference Guide</a>.            </p>
    </li></ol>            <p>
    For more information on Hibernate and JPA, see <a href="https://docs.jboss.org/author/display/WFLY8/JPA+Reference+Guide">JPA Reference Guide</a>.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-UpdateyourHibernate3applicationtouseHibernate4"  >
        <h4>Update your Hibernate 3 application to use Hibernate 4</h4>
    
    <div class="section-5"  id="66322748_DeveloperGuide-ChangesforHibernate3.3applications"  >
        <h5>Changes for Hibernate 3.3 applications</h5>
    
<ol class=" "><li class=" ">            <p>
    Hibernate &quot;text&quot; type now maps to JDBC LONGVARCHAR<br/>In pre-3.5 versions of Hibernate, text type were mapped to JDBC CLOB. A new Hibernate type, &quot;materialized_clob&quot;, was added to map Java String properties to JDBC CLOB. If an application has properties configured as type=&quot;text&quot; that are intended to be mapped to JDBC CLOB, they should be changed to type=&quot;materialized_clob&quot; in hbm mapping files, or, if using annotations, @Type(type = &quot;text&quot;) should be replaced by @Lob.            </p>
    </li><li class=" ">            <p>
    Numeric aggregate Criteria projections now return the same value type as their HQL counterparts. As a result, the return type from the following projections in org.hibernate.criterion have changed:            </p>
    <ol class=" "><li class=" ">            <p>
    &quot;count&quot; and &quot;count distinct&quot; projections now return a Long value (due to changes in CountProjection, Projections.rowCount(), Projections.count( propertyName ), and Projections.countDistinct( propertyName )).            </p>
    </li><li class=" ">            <p>
    &quot;sum&quot; projections return a value type that depends on the property type due to changes in Projections.sum( propertyName ). Failure to modify your application code may result in a java.lang.ClassCastException.            </p>
    <ol class=" "><li class=" ">            <p>
    for properties mapped as Long, Short, Integer, or primitive integer types, a Long value is returned;            </p>
    </li><li class=" ">            <p>
    for properties mapped as Float, Double, or primitive floating point types, a Double value is returned.            </p>
    </li></ol></li></ol></li></ol>    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-ChangesforHibernate3.5applications"  >
        <h5>Changes for Hibernate 3.5 applications</h5>
    
<ol class=" "><li class=" ">            <p>
    AnnotationConfigration must be merged into Configuration<br/>Aside from the fact that AnnotationConfiguration is now deprecated, this usually is not of concern. However, if you are still using an <tt class=" ">hbm.xml</tt> file, you should be aware that WildFly 8&nbsp;now uses the org.hibernate.cfg.EJB3NamingStrategy in AnnotationConfigration instead of the older org.hibernate.cfg.DefaultNamingStrategy that was previously used in Configuration. This can result in naming mismatches. If you rely on the naming strategy to default the name of a association (many-to-many and collections of elements) table, you may see this issue.  To resolve it, you can tell Hibernate to use the the legacy org.hibernate.cfg.DefaultNamingStrategy by calling Configuration#setNamingStrategy and passing it org.hibernate.cfg.DefaultNamingStrategy#INSTANCE            </p>
    </li><li class=" ">            <p>
    The namespaces for the Hibernate DTD files have changed.            </p>
        <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Previous DTD Namespace            </td>
                <td rowspan="1" colspan="1">
    New DTD Namespaces            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    <a href="http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd</a>            </td>
                <td rowspan="1" colspan="1">
    <a href="http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd</a>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <a href="http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd</a>            </td>
                <td rowspan="1" colspan="1">
    <a href="http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd</a>            </td>
        </tr>
</tbody>        </table>
            </div>
</li><li class=" ">            <p>
    If you are using Oracle, the global environment variable &quot;hibernate.jdbc.use_streams_for_binary&quot; must be set to true if you are using &quot;materialized_clob&quot; or &quot;materialized_blob&quot; properties.            </p>
    </li><li class=" ">            <p>
    If you are using PostgreSQL, the global environment variable &quot;hibernate.jdbc.use_streams_for_binary&quot; must be set to false if you are using CLOB or BLOB properties.            </p>
    </li></ol>    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-GeneralChangeswhenmigratingtoHibernate4"  >
        <h5>General Changes when migrating to Hibernate 4</h5>
    
            <p>
    In Hibernate 4.0 there is a new IdentifierGenerator implementations.            </p>
                <p>
    Hibernate 4.0 supplies a property that is called&nbsp;<strong class=" ">hibernate.id.new_generator_mappings</strong>&nbsp;and hibernate documentation states that it defaults to <strong class=" ">false</strong> for backward&nbsp;compatibility&nbsp;reasons - however in AS 7.1 this value defaults to <strong class=" ">true</strong>.            </p>
                <p>
    consider setting the value to false in&nbsp;<strong class=" ">persistence.xml</strong> in case you don't see the&nbsp;behaviour&nbsp;you had in your app in&nbsp;previous&nbsp;versions.            </p>
                <p>
    for more information - read about&nbsp;<strong class=" ">5.1.2 Identifiers</strong> in general and about&nbsp;<strong class=" ">5.1.2.2.&nbsp;Identifier generator</strong> more&nbsp;specifically*&nbsp;*<strong class=" "><a href="http://docs.jboss.org/hibernate/core/4.0/manual/en-US/html_single/#mapping-declaration-id"><strong class=" ">here</strong></a></strong>            </p>
        </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ChangesinJPAcontainermanagedbehaviour"  >
        <h4>Changes in JPA container managed behaviour</h4>
    
            <p>
    To comply with the JPA 2.0 specification section 7.6.3.1 requirements for persistence context propagation, jira <a href="https://issues.jboss.org/browse/AS7-1663">AS7-1663 (An extended persistence context should not be propagated if there is no JTA transaction)</a> was fixed in WildFly 8.&nbsp; If a SFSB with an extended persistence context, invokes another bean (not in an active JTA transaction) and the other bean uses a transactional entity manager.&nbsp; The extended persistence context will not be propagated to the transactional entity manager (propagation will occur if invoked with an active JTA transaction).&nbsp; If your application expects the extended persistence context to be propagated to the bean with the transactional entity manager, you need to change your app to do the invocation with an active JTA transaction.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-InfinispanasSecondLevelCache"  >
        <h4>Infinispan as Second Level Cache</h4>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Overview7"  >
        <h5>Overview</h5>
    
            <p>
    JBoss Cache has been replaced by Infinispan for 2nd level cache (even for non-clustered use). This requires a change to the persistence.xml file. The syntax is slightly different, depending on if you're using JPA or Hibernate APIs. These examples assume you are using JPA.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Infinispansecondlevelcachesettings"  >
        <h5>Infinispan second-level cache settings</h5>
    
            <p>
    Here's an example of the persistence.xml file in EAP 5.1:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;property name=&quot;hibernate.cache.region.factory_class&quot; 		value=&quot;org.hibernate.cache.jbc2.JndiMultiplexedJBossCacheRegionFactory&quot;/&gt;
&lt;property name=&quot;hibernate.cache.region.jbc2.cachefactory&quot; 	value=&quot;java:CacheManager&quot;/&gt;
&lt;property name=&quot;hibernate.cache.use_second_level_cache&quot; 	value=&quot;true&quot;/&gt;
&lt;property name=&quot;hibernate.cache.use_minimal_puts&quot; 		value=&quot;true&quot;/&gt;
&lt;property name=&quot;hibernate.cache.region.jbc2.cfg.entity&quot; 	value=&quot;mvcc-entity&quot;/&gt;
&lt;property name=&quot;hibernate.cache.region_prefix&quot; 			value=&quot;services&quot;/&gt;</code></pre>
        </div>
    </div>
            <p>
    Here is what is needed to configure the same thing for a JPA application using Infinispan with WildFly 8:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;property name=&quot;hibernate.cache.use_second_level_cache&quot; value=&quot;true&quot;/&gt;
&lt;property name=&quot;hibernate.cache.use_minimal_puts&quot; value=&quot;true&quot;/&gt;</code></pre>
        </div>
    </div>
            <p>
    Here is what is needed to configure the same thing for a native Hibernate application using Infinispan with WildFly 8:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;property name=&quot;hibernate.cache.region.factory_class&quot; 		value=&quot;org.hibernate.cache.infinispan.JndiInfinispanRegionFactory&quot;/&gt;
&lt;property name=&quot;hibernate.cache.infinispan.cachemanager&quot;	value=&quot;java:jboss/infinispan/hibernate&quot;/&gt;
&lt;property name=&quot;hibernate.transaction.manager_lookup_class&quot;	value=&quot;org.hibernate.transaction.JBossTransactionManagerLookup&quot;/&gt;
&lt;property name=&quot;hibernate.cache.use_second_level_cache&quot; 	value=&quot;true&quot;/&gt;
&lt;property name=&quot;hibernate.cache.use_minimal_puts&quot; 		value=&quot;true&quot;/&gt;</code></pre>
        </div>
    </div>
            <p>
    Since JPA applications use Infinispan by default, fewer properties are needed to be specified.&nbsp; For native Hibernate applications you need to:            </p>
    <ul class=" "><li class=" ">            <p>
    Select the correct Hibernate transaction factory using the hibernate.transaction.factory_class property.            </p>
    </li><li class=" ">            <p>
    Select the correct Hibernate transaction manager lookup class using the hibernate.transaction.manager_lookup_class property.            </p>
    </li><li class=" ">            <p>
    Configure the Infinispan cache region factory using one of the two options below:            </p>
    <ul class=" "><li class=" ">            <p>
    If the Infinispan CacheManager is bound to JNDI, select JndiInfinispanRegionFactory as the cache region factory and add the cache manager&rsquo;s JNDI name            </p>
    </li><li class=" ">            <p>
    If running JPA/Hibernate and Infinispan standalone or within third party application server, select InfinispanRegionFactory as the cache region factory            </p>
    </li></ul></li></ul>    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-MigratetoHibernate4Validator"  >
        <h4>Migrate to Hibernate 4 Validator</h4>
    
            <p>
    Migrating from Hibernate Validator 3.x to 4.x means switching to a  completely new code base and new API - the JSR 303 (Bean Validation).  The good news is that this migration should be straight forward. Let's  have a look at the different parts which needs updating.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-AccessingthedefaultValidatorFactory"  >
        <h5>Accessing the default ValidatorFactory</h5>
    
            <p>
    WildFly 8&nbsp;binds a default ValidatorFactory to the JNDI context under the name <i class=" ">java:comp/ValidatorFactory</i>.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Lifecycletriggeredvalidation"  >
        <h5>Life cycle triggered validation</h5>
    
            <p>
    When used in combination with Hibernate 4 life-cycle based validation  will be automatically enabled by Hibernate Core. Validation will occur  on entity INSERT, UPDATE and DELETE operations. You can configure the  groups to be validated per event type using the properties <i class=" ">javax.persistence.validation.group.pre-persist</i>, <i class=" ">javax.persistence.validation.group.pre-update</i>, and <i class=" ">javax.persistence.validation.group.pre-remove</i>.  The values of these properties are the comma-separated, fully specified  class names of the groups to validate. The validation groups feature is  part of the Bean Validation specification and it is recommended you get  familiar with this new functionality. For a pure migration however, you  can ignore groups as Hibernate Validator 3 did not have such a feature.            </p>
                <p>
    You can also disable life-cycle based validation by setting the <i class=" ">javax.persistence.validation.mode</i> to <i class=" ">none</i>. Other values are <i class=" ">auto</i>, <i class=" ">callback</i> and <i class=" ">ddl</i>, where auto is the default.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Manualvalidation"  >
        <h5>Manual validation</h5>
    
            <p>
    In case you want to manually validate, you need to create a <i class=" ">Validator</i> instance from the <i class=" ">ValidatorFactory</i> via <i class=" ">ValidatorFactory.getValidator</i>. or get <i class=" ">Validator</i> injected in your EJB, CDI bean or any other Java EE injectable resource. You can customize your <i class=" ">Validator</i> instance by using a fluent API starting with <i class=" ">ValidatorFactory.usingContext</i>. Using this API you can configure a custom <i class=" ">MessageInterpolator</i>, <i class=" ">TraverableResolver</i> and <i class=" ">ConstraintValidatorFactory</i>. All these interfaces are new to Hibernate Validator and are specified in the Bean Validation specification.            </p>
                <p>
    Once you have your <i class=" ">Validator</i> instance, use the&nbsp;<i class=" ">validate</i> methods to either validate your whole entity or just a single property. A call to any <i class=" ">validate</i> method will return a set of <i class=" ">ConstraintViolation</i> instances (in contrast to an array of <i class=" ">InvalidValue</i> instances in Validator 3). An empty set indicates a successful validation without any constraint violations.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-UsingthenewBeanValidationconstraints"  >
        <h5>Using the new Bean Validation constraints</h5>
    
            <p>
    This is the most visible change fro Hibernate Validator 3 constraints  in your code base. To upgrade to Hibernate Validator 4 you have to use  the constraints in the <i class=" ">javax.validation.constraints</i> and <i class=" ">org.hibernate.validator.constraints</i> packages. The former contains the standardized Bean Validation  constraints whereas the latter contains some Hibernate Validator  specific constraints. All constraints which existed in Validator 3 are  available in Validator 4. You just need to import the right class and in  some cases change the name and/or type of a constraint parameter.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Customconstraints"  >
        <h5>Custom constraints</h5>
    
            <p>
    In Validator 3 a custom constraint needed to implement <i class=" ">org.hibernate.validator.Validator</i>. In Validator 4 the interface to implement is <i class=" ">javax.validation.ConstraintValidator</i> which contains the same methods as the old interface, namely <i class=" ">initialize</i> and <i class=" ">isValid</i>.  Only the method signature is slightly different. Note that support for  DDL alteration is no longer part of Hibernate Validator 4 but very few  users made use of this feature.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-WheretoFindAdditionalInformation4"  >
        <h5>Where to Find Additional Information</h5>
    
            <p>
    <a href="http://community.jboss.org/wiki/Infinispan">Infinispan</a><br/><a href="http://docs.jboss.org/author/display/ISPN/Using+Infinispan+as+JPA-Hibernate+Second+Level+Cache+Provider">Using Infinspan as JPA/Hibernate Second Level Cache Provider</a><br/><a href="http://www.jboss.org/jbossclustering/docs/hibernate-jbosscache-guide-3.pdf">HIBERNATE - RelationalPersistence for Idiomatic Java</a>            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ChangesyouneedtomakeforSecurity"  >
        <h3>Changes you need to make for Security</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ConfigureSecurityforBasicAuthentication"  >
        <h4>Configure Security for Basic Authentication</h4>
    
            <p>
    The UsersRolesLoginModule has always looked for the properties files in the classpath. In previous versions of AS, files in the <tt class=" ">JBOSS_HOME/server/SERVER_NAME/conf</tt> directory were on classpath so you could  put your properties files there. In WildFly 8&nbsp;the directory structure has changed, so you need to package the properties within the application to make them available in the classpath.            </p>
                <p>
        <span style="color: #000000;">
To configure security for basic authentication, add a new security domain under security-domains to    </span>
     <span style="color: #000000;">
your standalone.xml configuration file    </span>
     <span style="color: #000000;">
:    </span>
            </p>
        <div class="tablewrap">
        <table>
<thead class=" "></thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    &lt;security-domain name=&quot;example&quot;&gt;<br/>&nbsp;&nbsp;&nbsp; &lt;authentication&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;login-module code=&quot;UsersRoles&quot; flag=&quot;required&quot;&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module-option name=&quot;usersProperties&quot; value=&quot;${jboss.server.config.dir}/example-users.properties&quot;/&gt;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;module-option name=&quot;rolesProperties&quot; value=&quot;${jboss.server.config.dir}/example-roles.properties&quot;/&gt;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &lt;/login-module&gt;<br/>&nbsp;&nbsp;&nbsp; &lt;/authentication&gt;<br/>&lt;/security-domain&gt;            </td>
        </tr>
</tbody>        </table>
            </div>
            <p>
    If you are running in standalone mode, ${jboss.server.config.dir} refers to <tt class=" ">JBOSS_HOME/standalone/configuration/</tt>            </p>
                <p>
    A list of available login modules can be found in the <a href="https://docs.jboss.org/author/display/WFLY8/Authentication+Modules">admin guide</a>.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Modifysecuritydomainnames"  >
        <h4>Modify security domain names</h4>
    
            <p>
    In WildFly 8&nbsp;security domains no longer use the prefix java:/jaas/ in their names. Remove this prefix from the security domain configurations in <strong class=" ">jboss-web.xml</strong> for web applications and <strong class=" ">jboss.xml</strong> for enterprise applications.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ConfigureJAXRS%2FResteasychanges"  >
        <h3>Configure JAX-RS / Resteasy changes</h3>
    
            <p>
    WildFly 8&nbsp;sets up Resteasy for you, so there is no need to set it up yourself.            </p>
                <p>
    You should remove all of the resteasy configuration from your <tt class=" ">web.xml</tt> and replace it with one of the following three options:            </p>
    <ul class=" "><li class=" ">            <p>
    Subclass javax.ws.rs.core.Application and use @ApplicationPath<br/>This is the easiest way and does not require any xml configuration. Simply include a subclass of javax.ws.rs.core.Application in your application, and annotate it with the path that you want your JAX-RS classes to be available. For example:            </p>
    </li></ul>    <div class="confbox programlisting">
                <div class="content">
        <pre><code>@ApplicationPath(&quot;/mypath&quot;)
public class MyApplication extends Application {
}</code></pre>
        </div>
    </div>
            <p>
    This will make your JAX-RS resources available under <tt class=" ">/mywebappcontext/mypath</tt>.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    Note that that the path is <tt class=" ">/mypath</tt> not <tt class=" ">/mypath/*</tt>            </p>
        </div>
    
<ul class=" "><li class=" ">            <p>
    Subclass javax.ws.rs.core.Application and use <tt class=" ">web.xml</tt><br/>If you do not wish to use @ApplicationPath but still need to subclass Application you can set up the JAX-RS mapping in <tt class=" ">web.xml</tt>:            </p>
    </li></ul>    <div class="confbox programlisting">
                <div class="content">
        <pre><code>public class MyApplication extends Application {
}</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;servlet-mapping&gt;
   &lt;servlet-name&gt;com.acme.MyApplication&lt;/servlet-name&gt;
   &lt;url-pattern&gt;/hello/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;</code></pre>
        </div>
    </div>
            <p>
    This will make your JAX-RS resources available under <tt class=" ">/mywebappcontext/hello</tt>.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    You can also use this approach to override an application path set with the @ApplicationPath annotation.            </p>
        </div>
    
<ul class=" "><li class=" ">            <p>
    Modify <tt class=" ">web.xml</tt><br/>If you don't want to subclass Application you can set the JAX-RS mapping in <tt class=" ">web.xml</tt> as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;servlet-mapping&gt;
   &lt;servlet-name&gt;javax.ws.rs.core.Application&lt;/servlet-name&gt;
   &lt;url-pattern&gt;/hello/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;</code></pre>
        </div>
    </div>
            <p>
    This will make your JAX-RS resources available under /mywebappcontext/hello.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    Note that you only have to add the mapping, not the corresponding servlet. The server is responsible for adding the corresponding servlet automatically.            </p>
        </div>
    
</li></ul>            <p>
    For more information, see the <a href="https://docs.jboss.org/author/display/WFLY8/JAX-RS+Reference+Guide">JAX-RS Reference Guide.</a>            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ConfigureLDAPsecurityrealmchanges"  >
        <h3>Configure LDAP security realm changes</h3>
    
            <p>
    In previous releases of JBoss AS, the LDAP realm was configured as an application-policy in the <tt class=" ">login-config.xml file</tt>. The following is an example of configuration in a previous release:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;application-policy name=&quot;mcp_ldap_domain&quot;&gt;
  &lt;authentication&gt;
    &lt;login-module code=&quot;org.jboss.security.auth.spi.LdapExtLoginModule&quot; flag=&quot;required&quot;&gt;
      &lt;module-option name=&quot;java.naming.factory.initial&quot;&gt;com.sun.jndi.ldap.LdapCtxFactory&lt;/module-option&gt;
      &lt;module-option name=&quot;java.naming.security.authentication&quot;&gt;simple&lt;/module-option&gt;
      ....
    &lt;/login-module&gt;
  &lt;/authentication&gt;
&lt;/application-policy&gt;</code></pre>
        </div>
    </div>
            <p>
    In WildFly 8, the LDAP realm is configured as a security-domain in the <tt class=" ">standalone/configuration/standalone.xml</tt> file if you are running a standalone server or in the <tt class=" ">domain/configuration/domain.xml</tt> file if you are running your server in a managed domain. The following is an example of configuration in WildFly 8:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:security:1.0&quot;&gt;
  &lt;security-domains&gt;
    &lt;security-domain name=&quot;mcp_ldap_domain&quot; type=&quot;default&quot;&gt;
      &lt;authentication&gt;
        &lt;login-module code=&quot;org.jboss.security.auth.spi.LdapLoginModule&quot; flag=&quot;required&quot;&gt;
          &lt;module-option name=&quot;java.naming.factory.initial&quot; value=&quot;com.sun.jndi.ldap.LdapCtxFactory&quot;&gt;
            &lt;module-option name=&quot;java.naming.security.authentication&quot; value=&quot;simple&quot;&gt;
              ...
            &lt;/module-option&gt;
          &lt;/module-option&gt;
        &lt;/login-module&gt;
      &lt;/authentication&gt;
    &lt;/security-domain&gt;
  &lt;/security-domains&gt;
&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    The XML parser has also changed in WildFly 8. In previous releases, you specified the module options as element content like this:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;module-option name=&quot;java.naming.factory.initial&quot;&gt;com.sun.jndi.ldap.LdapCtxFactory&lt;/module-option&gt;</code></pre>
        </div>
    </div>
            <p>
    In WildFly 8, the module options must be specified as element attributes with &quot;value=&quot; as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;module-option name=&quot;java.naming.factory.initial&quot; value=&quot;com.sun.jndi.ldap.LdapCtxFactory&quot;/&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-MigratefromJBossMessagingtoHornetQ"  >
        <h3>Migrate from JBoss Messaging to HornetQ</h3>
    
            <p>
    JBoss Messaging will no longer be included in EAP 6. If your application uses JBoss Messaging as the messaging provider, you will need to make changes to your application to use HornetQ.            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-Beforeyoustart"  >
        <h4>Before you start</h4>
    
<ol class=" "><li class=" ">            <p>
    Shut down the client and server.            </p>
    </li><li class=" ">            <p>
    Make a backup of any JBoss Messaging data. &nbsp;Message data is stored in a database, and the tables are prefixed with &quot;JBM_&quot;. &nbsp;Backup these tables as necessary.            </p>
    </li></ol>    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Transferconfigurations"  >
        <h4>Transfer configurations</h4>
    
            <p>
    Transfer the existing JBoss Messaging configurations to the WildFly 8&nbsp;configuration. These configurations are located in deployment descriptors on the server running JBoss Messaging. This includes the following configurations:            </p>
    <ul class=" "><li class=" ">            <p>
    Connection Factory service configuration files - these files contain JMS connection factories deployed with JBoss Messaging. JBoss Messaging stores these files in a file called <tt class=" ">connection-factories-service.xml</tt> in the deploy/messaging directory of your application server.            </p>
    </li><li class=" ">            <p>
    Destination service configurations - these files contain JMS queues and topics deployed with JBoss Messaging. By default, these are stored in a <tt class=" ">destinations-service.xml</tt> in the deploy/messaging directory of your application server.            </p>
    </li><li class=" ">            <p>
    Message bridge service configurations - these files contain bridge services deployed with JBoss Messaging. No bridges are deployed by default, so the name of the deployment file will vary, depending on your JBoss Messaging installation. &nbsp;<strong class=" ">Note</strong>: WildFly 8&nbsp;doesn't currently support JMS bridges configured in standalone*.xml. &nbsp;This will change in a future version.            </p>
    </li></ul>            <p>
    Refer to <a href="https://docs.jboss.org/author/display/WFLY8/Messaging+configuration">Messaging configuration</a> for details on HornetQ configurations.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Modifyapplicationcode"  >
        <h4>Modify application code</h4>
    
            <p>
    If the application code uses standard JMS, no code changes are required. &nbsp;However, if the application will be connecting to a cluster (which is outside the scope of the JMS specification) please carefully review the HornetQ documentation on clustering semantics as HornetQ and JBoss Messaging have taken substantially different approaches in their respective implementations of clustering functionality.            </p>
                <p>
    If the application code uses features specific to JBoss Messaging, modify the code to use equivalent features available in HornetQ (if available).            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Migrateexistingmessages"  >
        <h4>Migrate existing messages</h4>
    
            <p>
    Move any messages in the JBoss Messaging database to the HornetQ journal via a JMS bridge. &nbsp;Instructions for this are available <a href="https://community.jboss.org/wiki/BridgeJMSMessagesFromAS5ToAS7">here</a>.            </p>
                <p>
    For more information on HornetQ, see <a href="http://www.jboss.org/hornetq/docs">HornetQ Project Documentation</a> and the <a href="http://www.jboss.org/hornetq">HornetQ homepage</a>.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ChangesyouneedtomakeforClustering"  >
        <h3>Changes you need to make for Clustering</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-StartingWildFly8%26nbsp%3Bwithclusteringenabled"  >
        <h4>Starting WildFly 8&#160;with clustering enabled</h4>
    
            <p>
    To enable clustering in AS5 and AS6, you needed to start your server instances using the &quot;all&quot; profile (or some derivation of it).<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>$ ./bin/run.sh -c all</code></pre>
        </div>
    </div>
            <p>
    In WildFly 8, the method of enabling clustering depends on whether your servers are started via the domain controller, or as standalone servers.<br/>To enable clustering for servers started via the domain controller, update your domain.xml and designate a server group to use the &quot;ha&quot; profile and &quot;ha-sockets&quot; socket binding group:<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;server-groups&gt;
  &lt;server-group name=&quot;main-server-group&quot; profile=&quot;ha&quot;&gt;
    &lt;jvm name=&quot;default&quot;&gt;
      &lt;heap size=&quot;64m&quot; max-size=&quot;512m&quot;/&gt;
    &lt;/jvm&gt;
    &lt;socket-binding-group ref=&quot;ha-sockets&quot;/&gt;
  &lt;/server-group&gt;
&lt;/server-group&gt;</code></pre>
        </div>
    </div>
            <p>
    To enable clustering for standalone servers, start the server using the appropriate configuration file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>$ ./bin/standalone.sh --server-config=standalone-ha.xml -Djboss.node.name=UNIQUE_NODE_NAME</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Specifyingthebindaddress"  >
        <h4>Specifying the bind address</h4>
    
            <p>
    In AS5 and AS6, you would typically indicate the bind address used for clustering via the &quot;-b&quot; command line argument.<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>$ ./bin/run.sh -c all -b 192.168.0.2</code></pre>
        </div>
    </div>
            <p>
    In WildFly 8, bind addresses are explicitly defined by the relevant socket bindings within the WildFly 8&nbsp;configuration files.  For servers started via the domain controller, bind addresses are specified within <tt class=" ">domain/configuration/host.xml</tt>.  For standalone servers, bind addresses are specified within the <tt class=" ">standalone-ha.xml</tt>:<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;interfaces&gt;
  &lt;interface name=&quot;management&quot;&gt;
    &lt;inet-address value=&quot;192.168.0.2&quot;/&gt;
  &lt;/interface&gt;
  &lt;interface name=&quot;public&quot;&gt;
    &lt;inet-address value=&quot;192.168.0.2&quot;/&gt;
  &lt;/interface&gt;
&lt;/interfaces&gt;</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;socket-binding-groups&gt;
  &lt;socket-binding-group name=&quot;ha-sockets&quot; default-interface=&quot;public&quot;&gt;
    &lt;!-- ... --&gt;
  &lt;/socket-binding-group&gt;
&lt;/socket-binding-groups&gt;</code></pre>
        </div>
    </div>
            <p>
    In the example above, the &quot;public&quot; interface is specified as the default interface for all sockets within the &quot;ha-sockets&quot; socket binding group.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Configure%7B%7BjvmRoute%7D%7Dtosupport%7B%7Bmodjk%7D%7Dand%7B%7Bmodproxy%7D%7D"  >
        <h4>Configure  jvmRoute  to support  mod_jk  and  mod_proxy</h4>
    
            <p>
    In previous releases, the web server <tt class=" ">jvmRoute</tt> was configured using a property in the <tt class=" ">server.xml</tt> file. In AS 7, the <tt class=" ">jvmRoute</tt> attribute is configured in the web subsystem of the server configuration file using the <tt class=" ">instance-id</tt> attribute as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>subsystem xmlns=&quot;urn:jboss:domain:web:1.1&quot; default-virtual-server=&quot;default-host&quot; native=&quot;false&quot; instance-id=&quot;{JVM_ROUTE_SERVER}&quot;&gt;</code></pre>
        </div>
    </div>
            <p>
    The <tt class=" ">JVM_ROUTE_SERVER</tt> above should be replaced by the jvmRoute server ID.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Specifyingmulticastaddress%2Fport"  >
        <h4>Specifying multicast address/port</h4>
    
            <p>
    In AS5 and AS6, you could specify the multicast address and port used for intra-cluster communication using the command line arguments &quot;-u&quot; and &quot;-m&quot;, respectively.<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./bin/run.sh -c all -u 228.11.11.11 -m 45688</code></pre>
        </div>
    </div>
            <p>
    In WildFly 8, the multicast address and port used for intra-cluster communication are defined by the socket-binding referenced by the relevant JGroups protocol stack.<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:jgroups:1.0&quot; default-stack=&quot;udp&quot;&gt;
  &lt;stack name=&quot;udp&quot;&gt;
    &lt;transport type=&quot;UDP&quot; socket-binding=&quot;jgroups-udp&quot;/&gt;
    &lt;!-- ... --&gt;
  &lt;/stack&gt;
&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;socket-binding-groups&gt;
  &lt;socket-binding-group name=&quot;ha-sockets&quot; default-interface=&quot;public&quot;&gt;
    &lt;!-- ... --&gt;
    &lt;socket-binding name=&quot;jgroups-udp&quot; port=&quot;55200&quot; multicast-address=&quot;228.11.11.11&quot; multicast-port=&quot;45688&quot;/&gt;
    &lt;!-- ... --&gt;
  &lt;/socket-binding-group&gt;
&lt;/socket-binding-groups&gt;</code></pre>
        </div>
    </div>
            <p>
    If you prefer to specify the multicast address and port in the command line, you can define the multicast address and ports as system properties and then use those properties on the command line when you start the server. In the following example, &quot;jboss.mcast.addr&quot; is the variable for the multicast address and &quot;jboss.mcast.port&quot; is the variable for the port.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;socket-binding name=&quot;jgroups-udp&quot; port=&quot;55200&quot;
     multicast-address=&quot;${jboss.mcast.addr:230.0.0.4}&quot;
     multicast-port=&quot;${jboss.mcast.port:45688}&quot;/&gt;</code></pre>
        </div>
    </div>
            <p>
    You can then start your server using the following command line arguments:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>$ ./bin/domain.sh -Djboss.mcast.addr=228.11.11.11 -Djboss.mcast.port=45688</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Usinganalternateprotocolstack"  >
        <h4>Using an alternate protocol stack</h4>
    
            <p>
    In AS5 &amp; AS6, you could manipulate the default protocol stack used for all clustering services via the &quot;jboss.default.jgroups.stack&quot; system property.<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./bin/run.sh -c all -Djboss.default.jgroups.stack=tcp</code></pre>
        </div>
    </div>
            <p>
    In WildFly 8, the default protocol stack is defined by the JGroups subsystem within domain.xml or standalone-ha.xml.<br/>e.g.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:jgroups:1.0&quot; default-stack=&quot;udp&quot;&gt;
  &lt;stack name=&quot;udp&quot;&gt;
    &lt;!-- ... --&gt;
  &lt;/stack&gt;
&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-HASingletonDeployment"  >
        <h3>HA Singleton Deployment</h3>
    
            <p>
    TODO: This topic needs content            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Additionalchangesyoumayneedtomake"  >
        <h3>Additional changes you may need to make</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ChangeMavenpluginname"  >
        <h4>Change Maven plugin name</h4>
    
            <p>
    The jboss-maven-plugin has not been updated and does not work In WildFly 8. You must use org.jboss.as.plugins:jboss-as-maven-plugin to deploy to the correct directory.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-UpdateApplicationsThatUseServicestyleDeployments"  >
        <h4>Update Applications That Use Service-style Deployments</h4>
    
            <p>
    Although AS 7 no longer uses service-style descriptors, the container supports these service-style deployments without change where possible. This means that if you used <tt class=" ">jboss-service.xml</tt> or <tt class=" ">jboss-beans.xml</tt> deployment descriptors in your AS5/AS6 application, they should run with little or no modification in AS 7. You can continue to package the files in the EAR or SAR, or you can place the files directly in the deployments directory. If you are running a standalone server, the deployments directory is located here: <tt class=" ">JBOSS_HOME/standalone/deployments/</tt>.&nbsp;            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-DebugandResolveMigrationIssues"  >
        <h3>Debug and Resolve Migration Issues</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-DebugandresolveClassNotFoundExceptionsandNoCLassDefFoundErrors"  >
        <h4>Debug and resolve ClassNotFoundExceptions and NoCLassDefFoundErrors</h4>
    
            <p>
    ClassNotFoundExceptions can occur due to application packaging issues, unresolved dependencies, or missing archives. If the class specified is a class you have created in your application, the problem is mostly likely a packaging issue. If the class is is external to your project, you may need to explicitly define the dependencies on other modules or possibly copy an archive from a previous framework.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-Changetheapplicationstructuretofindclasseswithintheapplication"  >
        <h5>Change the application structure to find classes within the application</h5>
    
            <p>
    If the class specified in the exception is a class written specifically for the application, for example, a business class, you may need to change the packaging of the application. Due to modular class loading changes, your application may no longer be able to find classes within the EAR or WAR. In his case, you may need to move JARs to a different location within the application archive or modify class-path information so classes can be found. For more information on EAR and WAR packaging, see &quot;WAR Class Loading&quot; and &quot;EAR Class Loading&quot; in <a href="https://docs.jboss.org/author/display/AS7/Class+Loading+in+WFLY8">Class Loading in AS7.</a>            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-HowtofindtheJBossmoduledependency"  >
        <h5>How to find the JBoss module dependency</h5>
    
            <p>
    For other classes, to resolve the dependency you will find the JAR that contains the class specified by the ClassNotFoundException by looking in the JBoss WildFly 8&nbsp;modules directory. If you find a module for the class, you must add a dependency to the manifest entry.            </p>
                <p>
    For example, if you see this ClassNotFoundException trace in the log:            </p>
                <p>
    &nbsp;&nbsp;&nbsp; Caused by: java.lang.ClassNotFoundException: org.apache.commons.logging.Log from [Module &quot;deployment.TopicIndex.war:main&quot; from Service Module Loader]<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:188)            </p>
                <p>
    Find the JBoss module containing this class by doing one of the following:            </p>
    <ol class=" "><li class=" ">            <p>
    You can use Tattletale to find the JBoss module name. See the section: <a href="https://docs.jboss.org/author/display/WFLY8/Developer+Guide#DeveloperGuide-UseTattletaletofindapplicationdependencies">Use Tattletale to find application dependencies</a>.            </p>
    </li><li class=" ">            <p>
    You can manually find the module dependencies.            </p>
    <ol class=" "><li class=" ">            <p>
    First determine if there is an obvious module for the class            </p>
    <ol class=" "><li class=" ">            <p>
    Navigate to the <tt class=" ">JBOSS_HOME/modules</tt> directory and look for the module path.            </p>
    </li><li class=" ">            <p>
    in this case, under modules, there is org/apache/commons/logging            </p>
    </li><li class=" ">            <p>
    Open the <tt class=" ">JBOSS_HOME/modules/org/apache/commons/logging/main/module.xml</tt> file and find the module name.            </p>
    </li><li class=" ">            <p>
    Add the module name to the Dependencies in the <tt class=" ">MANIFEST.MF</tt> file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Dependencies: org.apache.commons.logging</code></pre>
        </div>
    </div>
</li></ol></li><li class=" ">            <p>
    If there is no obvious module path for the class            </p>
    <ol class=" "><li class=" ">            <p>
    Determine which JAR contains the class.            </p>
    </li><li class=" ">            <p>
    Find the module containing the JAR in the <tt class=" ">JBOSS_HOME/modules</tt> directory and determine the module name.            </p>
    </li><li class=" ">            <p>
    The module name to the Dependencies in the <tt class=" ">MANIFEST.MF</tt> file            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Dependencies: org.dom4j,org.slf4j.jcl-over-slf4j</code></pre>
        </div>
    </div>
</li></ol></li></ol></li></ol>    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-HowtofindtheJARinpreviousinstall"  >
        <h5>How to find the JAR in previous install</h5>
    
            <p>
    If the class is not found in a JAR packaged in a module defined by the WildFly 8&nbsp;server, find the JAR in your EAP 5.x install or your prior server's lib directory and copy it to your application's <tt class=" ">lib/</tt> directory.            </p>
                <p>
    For example, when you migrate the Seam Booking application from EAP 5.1, you see this ClassNotFoundException in the log:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Caused by: java.lang.NoClassDefFoundError: org/hibernate/validator/ClassValidator<br/>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; at java.lang.Class.getDeclaredMethods0(Native Method) [:1.6.0_25]            </p>
    <ol class=" "><li class=" ">            <p>
    Open a terminal and navigate to the <tt class=" ">EAP5_HOME/</tt> directory.            </p>
    </li><li class=" ">            <p>
    Issue the command:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>grep 'org.hibernate.validator.ClassValidator r' `find . \-name '*.jar'`</code></pre>
        </div>
    </div>
</li><li class=" ">            <p>
    You should see this (one of many) for the result:  Binary file ./jboss-eap-5.1/seam/lib/hibernate-validator.jar matches            </p>
    </li><li class=" ">            <p>
    Copy this JAR to the application's <tt class=" ">lib/</tt> directory.            </p>
    </li><li class=" ">            <p>
    Rebuild and redeploy the application            </p>
    </li></ol>    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-DebugandresolveClassCastExceptions"  >
        <h4>Debug and resolve ClassCastExceptions</h4>
    
            <p>
    This usually happens because the class is being loaded by a different class loader than the class it extends. It can also be a result of the same class existing in multiple JARs.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-RemoveanyunnecessaryJARsfromtheApplicationarchive"  >
        <h5>Remove any unnecessary JARs from the Application archive</h5>
    
            <p>
    First find the JAR that contains the class and determine how it is being loaded. Often you need to find and remove the JAR from the application's WAR or EAR. Then you must find the dependent JBoss module containing the class, and explicitly define the dependency in the <tt class=" ">MANIFEST.MF</tt> file.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Excludeanyconflictingdependenciesusingthe%7B%7Bjbossdeploymentstructure.xml%7D%7Dfile"  >
        <h5>Exclude any conflicting dependencies using the  jboss-deployment-structure.xml  file</h5>
    
            <p>
    There are cases where you will need to copy in older JARs for your applcation. If the newer JARs are loaded as automatic dependencies in WildFly 8, you may see ClassCastExceptions and need to exclude the conflicting module dependencies. This will prevent the server from adding the dependencies. This is an example of the <tt class=" ">exclusions</tt> element in the <tt class=" ">jboss-deployment-structure.xml</tt> file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;exclusions&gt;
    &lt;module name=&quot;org.javassist&quot; /&gt;
&lt;/exclusions&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Debugandresolveclassloadingissues"  >
        <h4>Debug and resolve class loading issues</h4>
    
            <p>
    If you are not able to figure out how the classes are loaded, you can often resolve the problem by printing class loader information to the log. For example, if you see the following ClassCastException in the log:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>java.lang.ClassCastException: com.example1.Foo1 cannot be cast to com.example2.Foo2</code></pre>
        </div>
    </div>
            <p>
    In your code, print the class loader information by logging            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>logger.info(&quot;Class loader for foo1: &quot; + com.example1.Foo1.getClass().getClassLoader().toString());
logger.info(&quot;Class loader for foo2: &quot; + com.example2.Foo2.getClass().getClassLoader().toString());</code></pre>
        </div>
    </div>
            <p>
    The ModuleClassLoader information in the log will show which modules are loading the classes and, based on your application, you will need to determine the best approach to resolve the issue. You might have to remove or move a conflicting JARs, add dependencies through the <tt class=" ">MANIFEST.MF</tt> or <tt class=" ">jboss-deployment-structure.xml</tt> file or excluding dependencies in the <tt class=" ">jboss-deployment-structure.xml</tt> file.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-DebugandresolveNoSuchMethodExceptions"  >
        <h4>Debug and resolve  NoSuchMethodExceptions</h4>
    
            <p>
    A NoSuchMethodException indicates a class version mismatch between JAR files. It indicates your application's calling class was compiled using a different version of the JAR than the one used by the application server runtime.&nbsp; This can occur when you package different versions of common libraries your application, for example Hibernate.  This can also happen if you migrate between versions of JBoss EAP and do not recompile your application against the updated EAP jars. To resolve this problem, remove any common JARs from your application archive, add any dependencies as described above, recompile and deploy your application.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-DebugandresolveDuplicateServiceExceptions"  >
        <h4>Debug and resolve DuplicateServiceExceptions</h4>
    
            <p>
    If you get a DuplicateServiceException for a subdeployment of a JAR  or a message that the WAR application has already been installed when  you deploy your EAR in WildFly 8, it may be due to the way JBoss WS handles  the deployment. In AS6, JBossWS introduced a Context Root Mapping Algorithm or rules for servlet based endpoints to allow it to become seamlessly compatible with TCK6. This means that if you have a WAR and a JAR with the same name within an  EAR, it may create a web context with the same name as the JAR which  will conflict with the WAR context. You can resolve this issue in one of the following ways:            </p>
    <ul class=" "><li class=" ">            <p>
    Rename  the JAR file to a name that is different than the WAR.            </p>
    </li><li class=" ">            <p>
    Provide a &lt;context-root&gt; element in the in <tt class=" ">jboss-web.xml</tt> file.            </p>
    </li><li class=" ">            <p>
    Provide a &lt;context-root&gt; element in the in <tt class=" ">jboss-webservices.xml</tt> file.            </p>
    </li><li class=" ">            <p>
    Customize the &lt;context-root&gt; for the WAR in the <tt class=" ">application.xml</tt> file.            </p>
    </li></ul>    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-DebugandresolveJBossSeamdebugpageerrors."  >
        <h4>Debug and resolve JBoss Seam debug page errors.</h4>
    
            <p>
    Usually the root cause of the exception can be found in one of the links on this page, for example, under the Component org.jboss.seam.caughtException. Use the same technique above under &ldquo;How to Resolve ClassNotFoundExceptions or NoCLassDefFoundErrors&rdquo; to resolve the dependencies.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-EJB2.xSupport"  >
        <h3>EJB 2.x Support</h3>
    
            <p>
    As 7.1 provides support for EJB 2.1, however, you need to make a few code modifications and must start the server with the full profile.            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-ModifytheCodetoUsetheNewJNDINamespaceRules"  >
        <h4>Modify the Code to Use the New JNDI Namespace Rules</h4>
    
            <p>
    Like EJB 3.0, you must use the full JNDI prefix with EJB 2.1. For more information on the new JNDI namespace rules and code examples, see the section 'Update application JNDI namespace names' above.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ReplaceJBossAOPInterceptors"  >
        <h4>Replace JBoss AOP Interceptors</h4>
    
            <p>
    JBoss AOP (Aspect Oriented Programming) is no longer included in WildFly. In previous releases, JBoss AOP was used by the EJB container. However, in AS 7, the EJB container uses a new mechanism. If your application uses JBoss AOP, you need modify your application code as follows.            </p>
    <ul class=" "><li class=" ">            <p>
    Standard EJB3 configurations that were made in the <tt class=" ">ejb3-interceptors-aop.xml</tt> file are now done in the server configuration file. For a standalone server, this is the <tt class=" ">standalone/configuration/standalone.xml</tt> file. If you are running your server in a managed domain, this is the <tt class=" ">domain/configuration/domain.xml</tt> file.            </p>
    </li><li class=" ">            <p>
    Applications that integrate AOP interceptors into the EJB layer must be redesigned to use EJB3 interceptors and CDI. Server side interceptors can be changed to EJB3 interceptors, but there is no client side interceptor in AS 7.            </p>
    </li></ul>    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Modifythe%7B%7Bjbossweb.xml%7D%7DFileDescriptor"  >
        <h4>Modify the  jboss-web.xml  File Descriptor</h4>
    
            <p>
    Modify the &lt;jndi-name&gt; for each &lt;ejb-ref&gt; to use the new JNDI fully qualified lookup format.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Replacethe%7B%7Bjboss.xml%7D%7Ddeploymentdescriptorfile"  >
        <h4>Replace the  jboss.xml  deployment descriptor file</h4>
    
            <p>
    The <tt class=" ">jboss-ejb3.xml</tt> deployment descriptor replaces the <tt class=" ">jboss.xml</tt> deployment descriptor to override and add to the features provided by the Java Enterprise Edition (EE) defined <tt class=" ">ejb3-jar.xml</tt> deployment descriptor. The new file is incompatible with <tt class=" ">jboss.xml</tt>, and the jboss.xml is now ignored in deployments.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-StarttheServerwiththeFullProfiles"  >
        <h4>Start the Server with the Full Profiles</h4>
    
            <p>
    EJB 2.1 requires the Java Enterprise Edition 6 Full Profile. To start AS 7 with the full profile, pass the argument &quot;-c standalone-full.xml&quot; on the command line when you start the server.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Migrationrequiredforothercomponents"  >
        <h3>Migration required for other components</h3>
    
            <p>
    ToDo: Conplete this section            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-HowtomigrateSeam2archivesto%26nbsp%3BWildFly8"  >
        <h3>How to migrate Seam 2 archives to&#160;WildFly 8</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Overview8"  >
        <h4>Overview</h4>
    
            <p>
    When you migrate a Seam 2 application, you will follow the steps outlined in the migration guide. You will need to configure the datasource as noted above. You will need to specify any module dependencies. You will also need to determine if the application has any dependencies on archives that do not ship with AS7 and copy any dependent JARs into the application <tt class=" ">lib/</tt> directory.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Updatethedatasourceconfiguration"  >
        <h4>Update the datasource configuration</h4>
    
            <p>
    Some Seam 2 examples use a default JDBC datasource named <tt class=" ">java:/ExampleDS</tt>. The easiest way is to define this datasource is to add the following datasource definition to the <tt class=" ">JBOSS_HOME/standalone/configuration/standalone.xml</tt> file the :            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;datasource name=&quot;ExampleDS&quot; jndi-name=&quot;java:/ExampleDS&quot; enabled=&quot;true&quot; jta=&quot;true&quot; use-java-context=&quot;true&quot; use-ccm=&quot;true&quot;&gt;
   &lt;connection-url&gt;jdbc:h2:mem:test;DB_CLOSE_DELAY=-1&lt;/connection-url&gt;
   &lt;driver&gt;h2&lt;/driver&gt;
   &lt;security&gt;
      &lt;user-name&gt;sa&lt;/user-name&gt;
      &lt;password&gt;sa&lt;/password&gt;
   &lt;/security&gt;
&lt;/datasource&gt;</code></pre>
        </div>
    </div>
            <p>
    This definition is a copy of the default HSQL datasource defined in WildFly.            </p>
                <p>
    You can also add the datasource using the jboss-cli command line interface:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>$ JBOSS_HOME/bin/jboss-cli.sh --connect
[standalone@localhost:9999 /] data-source add --name=ExampleDS --jndi-name=java:/ExampleDS --connection-url=jdbc:h2:mem:test;DB_CLOSE_DELAY=-1 --driver-name=h2 --user-name=sa --password=sa</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Addanyrequireddependencies"  >
        <h4>Add any required dependencies</h4>
    
            <p>
    Since Seam 2 applications use JSF 1.2, you will need to add dependencies for the JSF 1.2 modules and exclude the JSF 2.0 modules. You will need to create a <tt class=" ">jboss-deployment-structure.xml</tt> file in the EAR <tt class=" ">META-INF/</tt> directory that contains the following data:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;jboss-deployment-structure xmlns=&quot;urn:jboss:deployment-structure:1.0&quot;&gt;
    &lt;deployment&gt;
        &lt;dependencies&gt;
             &lt;module name=&quot;javax.faces.api&quot; slot=&quot;1.2&quot; export=&quot;true&quot;/&gt;
             &lt;module name=&quot;com.sun.jsf-impl&quot; slot=&quot;1.2&quot; export=&quot;true&quot;/&gt;
        &lt;/dependencies&gt;
    &lt;/deployment&gt;
    &lt;sub-deployment name=&quot;jboss-seam-booking.war&quot;&gt;
        &lt;exclusions&gt;
            &lt;module name=&quot;javax.faces.api&quot; slot=&quot;main&quot;/&gt;
            &lt;module name=&quot;com.sun.jsf-impl&quot; slot=&quot;main&quot;/&gt;
        &lt;/exclusions&gt;
        &lt;dependencies&gt;
            &lt;module name=&quot;javax.faces.api&quot; slot=&quot;1.2&quot;/&gt;
            &lt;module name=&quot;com.sun.jsf-impl&quot; slot=&quot;1.2&quot;/&gt;
        &lt;/dependencies&gt;
    &lt;/sub-deployment&gt;
&lt;/jboss-deployment-structure&gt;</code></pre>
        </div>
    </div>
            <p>
    If your application uses any third-party logging frameworks you will need add dependencies as described in that section of the migration guide.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Copydependentarchivesfromoutsideframeworksorotherlocations"  >
        <h4>Copy dependent archives from outside frameworks or other locations</h4>
    
            <p>
    Even if your Seam 2 application uses Hibernate 3, you may still be able to run with the Hibernate 4 module packaged in WildFly. Some hibernate classes are no longer available and you may need to copy one or more of the older hibernate JARs into the <tt class=" ">/lib</tt> directory. If you end up with ClassNotFoundExceptions or ClassCastExceptions involving hibernate classes, you may have to exclude the hibernate module in the deployments section of the <tt class=" ">META-INF/jboss-deployment-structure.xml</tt>            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;jboss-deployment-structure xmlns=&quot;urn:jboss:deployment-structure:1.0&quot;&gt;
    &lt;deployment&gt;
        &lt;exclusions&gt;
            &lt;module name=&quot;org.hibernate&quot;/&gt;
        &lt;/exclusions&gt;
    &lt;deployment&gt;
&lt;/jboss-deployment-structure&gt;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Seam2JPAexampledeploymenton%26nbsp%3BWildFly"  >
        <h4>Seam 2 JPA example deployment on&#160;WildFly</h4>
    
<ol class=" "><li class=" ">            <p>
    Remove the jboss-web.xml file from the jboss-seam-jpa.war/WEB-INF/ directory - Defined class loading in jboss-web.xml is now default behaviour.            </p>
    </li><li class=" ">            <p>
    Comment or remove hibernate property in jboss-seam-jpa.war/WEB-INF/classes/META-INF/persistence.xml:            </p>
        <blockquote>
            <p>
    &lt;!<del class=" ">- &lt;property name=&quot;hibernate.cache.provider_class&quot; value=&quot;org.hibernate.cache.HashtableCacheProvider&quot;/&gt; -</del>&gt;            </p>
            </blockquote>
</li><li class=" ">            <p>
    Add the following dependencies from seam distribution (seam/lib directory) into<br/><i class=" ">jboss-seam-jpa.war/WEB-INF/lib</i> directory, which were in JBoss AS 5/6 and are upgraded in WildFly&nbsp;to higher major version:            </p>
    <ul class=" "><li class=" ">            <p>
    slf4j-api.jar            </p>
    </li><li class=" ">            <p>
    slf4j-log4j12.jar            </p>
    </li><li class=" ">            <p>
    hibernate-entitymanager.jar            </p>
    </li><li class=" ">            <p>
    hibernate-core.jar            </p>
    </li><li class=" ">            <p>
    hibernate-annotations.jar            </p>
    </li><li class=" ">            <p>
    hibernate-commons-annotations.jar            </p>
    </li><li class=" ">            <p>
    hibernate-validator.jar            </p>
    </li></ul></li><li class=" ">            <p>
    Add jboss-deployment-structure.xml to <i class=" ">jboss-seam-jpa.war/WEB-INF/</i> with the following content in it:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;jboss-deployment-structure&gt;
   &lt;deployment&gt;
        &lt;exclusions&gt;
          &lt;module name=&quot;javax.faces.api&quot; slot=&quot;main&quot;/&gt;
          &lt;module name=&quot;com.sun.jsf-impl&quot; slot=&quot;main&quot;/&gt;
        &lt;/exclusions&gt;
        &lt;dependencies&gt;
          &lt;module name=&quot;org.apache.log4j&quot; /&gt;
          &lt;module name=&quot;org.dom4j&quot; /&gt;
          &lt;module name=&quot;org.apache.commons.logging&quot; /&gt;
          &lt;module name=&quot;org.apache.commons.collections&quot; /&gt;
          &lt;module name=&quot;javax.faces.api&quot; slot=&quot;1.2&quot;/&gt;
          &lt;module name=&quot;com.sun.jsf-impl&quot; slot=&quot;1.2&quot;/&gt;
        &lt;/dependencies&gt;
    &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;</code></pre>
        </div>
    </div>
            <p>
                </p>
        <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
    <a href="66322750.html">Name</a>            </td>
                <td rowspan="1" colspan="1">
    <a href="66322750.html">Size</a>            </td>
                <td rowspan="1" colspan="1">
    Creator            </td>
                <td rowspan="1" colspan="1">
    <a href="66322750.html">Creation Date</a>            </td>
                <td rowspan="1" colspan="1">
    Comment            </td>
                <td rowspan="1" colspan="1">
    &nbsp;            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    XML File                <a href="https://docs.jboss.org/author/download/attachments/66322750/jboss-deployment-structure.xml">jboss-deployment-structure.xml</a>            </td>
                <td rowspan="1" colspan="1">
    0.6 kB            </td>
                <td rowspan="1" colspan="1">
    <a href="https://docs.jboss.org/author/display/~manarh">Marek Novotny</a>            </td>
                <td rowspan="1" colspan="1">
    Jul 18, 2011 04:50            </td>
                <td rowspan="1" colspan="1">
    jboss-deployment-structure.xml for Seam 2 JPA example migration            </td>
                <td rowspan="1" colspan="1">
    <ul class=" "><li class="first ">            <p>
    <a href="https://docs.jboss.org/author/pages/editattachment.action?pageId=$page.id&amp;fileName=jboss-deployment-structure.xml">Properties</a>            </p>
    </li><li class=" ">            <p>
    <a href="https://docs.jboss.org/author/pages/removeattachment.action?pageId=$page.id&amp;fileName=jboss-deployment-structure.xml&amp;version=1">Remove</a>            </p>
    </li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
</li></ol>    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-HowtodebugandresolveSeam2JNDIerrors"  >
        <h4>How to debug and resolve Seam 2 JNDI errors</h4>
    
            <p>
    When you migrate a Seam 2 application, you may see javax.naming.NameNotFoundException errors in the log like the following:            </p>
                <p>
    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; javax.naming.NameNotFoundException: Name 'jboss-seam-booking' not found in context ''            </p>
                <p>
    If you don't want to modify JNDI lookups throughout the code, you can modify the application's components.xml file.            </p>
    <ol class=" "><li class=" ">            <p>
    First, you will need to replace the existing core-init element as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;!-- &lt;core:init jndi-pattern=&quot;jboss-seam-booking/#{ejbName}/local&quot; debug=&quot;true&quot; distributable=&quot;false&quot;/&gt;   --&gt;
 &lt;core:init debug=&quot;true&quot; distributable=&quot;false&quot;/&gt;</code></pre>
        </div>
    </div>
</li><li class=" ">            <p>
    Next, find the JNDI binding INFO messages that are printed in the server log when the application is deployed. The JNDI binding messages should look similar to this:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15:01:16,138 INFO <a href="https://docs.jboss.org/author/pages/createpage.action?spaceKey=WFLY8&amp;title=org.jboss.as.ejb3.deployment.processors.EjbJndiBindingsDeploymentUnitProcessor&amp;linkCreation=true&amp;fromPageId=66322750">org.jboss.as.ejb3.deployment.processors.EjbJndiBindingsDeploymentUnitProcessor</a> (MSC service thread 1-1) JNDI bindings for session bean<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; named AuthenticatorAction in &nbsp; deployment unit subdeployment &quot;jboss-seam-booking.jar&quot; of deployment &quot;jboss-seam-booking.ear&quot; are as follows:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;         java:global/jboss-seam-booking/jboss-seam-booking.jar/AuthenticatorAction!org.jboss.seam.example.booking.Authenticator<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;	java:app/jboss-seam-booking.jar/AuthenticatorAction!org.jboss.seam.example.booking.Authenticator<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;         java:module/AuthenticatorAction!org.jboss.seam.example.booking.Authenticator<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;         java:global/jboss-seam-booking/jboss-seam-booking.jar/AuthenticatorAction<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         java:app/jboss-seam-booking.jar/AuthenticatorAction<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; java:module/AuthenticatorAction            </p>
    </li><li class=" ">            <p>
    For each JNDI binding INFO message in the log, add a matching component element to the components.xml file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;component class=&quot;org.jboss.seam.example.booking.AuthenticatorAction&quot; jndi-name=&quot;java:app/jboss-seam-booking.jar/AuthenticatorAction&quot; /&gt;</code></pre>
        </div>
    </div>
</li></ol>    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-RunningSeam3archiveson%26nbsp%3BWildFly"  >
        <h3>Running Seam 3 archives on&#160;WildFly</h3>
    
            <p>
    ToDo: Complete this section            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-MigratingSpringapplications"  >
        <h3>Migrating Spring applications</h3>
    
            <p>
    For information on how to migrate Spring applications, see details at the <a href="https://docs.jboss.org/author/display/WFLY8/Spring+applications+development+and+migration+guide">Spring applications development and migration guide</a>.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ToolsThatCanAssistwithMigration"  >
        <h3>Tools That Can Assist with Migration</h3>
    
    <div class="section-4"  id="66322748_DeveloperGuide-UseTattletaletofindapplicationdependencies"  >
        <h4>Use Tattletale to find application dependencies</h4>
    
            <p>
    Due to the modular class loading changes, you might run into ClassNotFoundExceptions or ClassCastExceptions when you migrate your application. To resolve these dependencies, you will need to find the JARs that contain the classes specified by the exceptions.            </p>
                <p>
    Tattletale is an excellent tool that recursively scans your application and provides detailed reports about its contents. Tattletale 1.2.0.Beta2 or later contains additional support to help with the new JBoss Modules class loading used in WildFly. Tattletale's &quot;jbossas7&quot; report can be used to to automatically identify and specify dependent module names in your application's <tt class=" ">jboss-deployment-structure.xml</tt> file.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-InstallTattletale"  >
        <h5>Install Tattletale</h5>
    
<ol class=" "><li class=" ">            <p>
    Download Tattletale version 1.2.0.Beta2 or newer from <a href="http://sourceforge.net/projects/jboss/files/JBoss%20Tattletale/">http://sourceforge.net/projects/jboss/files/JBoss%20Tattletale/</a>.            </p>
    </li><li class=" ">            <p>
    Unzip the file into the directory of your choice.            </p>
    </li><li class=" ">            <p>
    Modify the <tt class=" ">TATTLETALE_HOME/jboss-tattletale.properties</tt> file by adding jbossas7 to the &quot;profiles&quot; property.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>profiles=java5, java6, ee6, jbossas7</code></pre>
        </div>
    </div>
</li><li class=" ">            <p>
    Uncomment scan and reports in the properties file.            </p>
    </li></ol>    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-CreateandreviewtheTattletalereport"  >
        <h5>Create and review the Tattletale report</h5>
    
<ol class=" "><li class=" ">            <p>
    Create the Tattletale report by issuing the command:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>java -jar TATTLETALE_HOME/tattletale.jar APPLICATION_ARCHIVE OUTPUT_DIRECTORY</code></pre>
        </div>
    </div>
            <p>
    For example:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>java -jar ~/tattletale-1.2.0.Beta1/tattletale.jar applications/jboss-seam-booking.ear output-results/</code></pre>
        </div>
    </div>
</li><li class=" ">            <p>
    In a browser, open the <tt class=" ">OUTPUT_DIRECTORY/index.html</tt> file and click on &quot;JBoss A7&quot; under the &quot;Reports&quot; section.            </p>
    <ol class=" "><li class=" ">            <p>
    The column on the left lists the archives used by the application. Click on the ARCHIVE_NAME link to view details about the archive, such as its location, manifest information, and classes it contains.            </p>
    </li><li class=" ">            <p>
    The <tt class=" ">jboss-deployment-structure.xml</tt> link in the column on the right shows how to specify the module dependency for the archive in the left column. Click on this link to see how to define the deployment dependency module information for this archive.            </p>
    </li></ol></li></ol>    <div class="confbox admonition admonition-note">
        
            <p>
    Tattletale will only find dependencies on the application classes. It will not find dependencies that may be required by classes your application calls or by classes in other JARs included under your application's <tt class=" ">WEB-INF/lib</tt> directory. To identify external dependencies, you will need to look at the &quot;Depends On&quot; report.            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-IronJacamarDatasourceandResourceAdapterMigrationTool"  >
        <h4>IronJacamar Datasource and Resource Adapter Migration Tool</h4>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Summary"  >
        <h5>Summary</h5>
    
            <p>
    In previous versions of the application server, datasources and resource adapters were configured and deployed using a file with a suffix of *-ds.xml. The IronJacamar 1.1 distribution contains a migration tool that can be used to convert the datasource and resource adapter configuration files from previous releases into the configuration format expected by the WildFly&nbsp;server. The tool parses the source configuration file from the previous release, then creates and writes an XML snippet in the appropriate format that can be copied and pasted under the correct subsystem in the server configuration file.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-DownloadandinstallIronJacamar"  >
        <h5>Download and install IronJacamar</h5>
    
<ol class=" "><li class=" ">            <p>
    Download IronJacamar 1.1 from here: <a href="http://www.jboss.org/ironjacamar/downloads/">http://www.jboss.org/ironjacamar/downloads/ </a>.            </p>
    </li><li class=" ">            <p>
    Unzip the file into a directory of your choice.            </p>
    </li><li class=" ">            <p>
    The converter script can be found in the IRONJACAMAR distribution in the following locations:            </p>
    <ol class=" "><li class=" ">            <p>
    Linux script: <tt class=" ">IRONJACAMAR_HOME/doc/as/converter.sh</tt>            </p>
    </li><li class=" ">            <p>
    Windows batch file: <tt class=" ">IRONJACAMAR_HOME/doc/as/converter.bat</tt>            </p>
    </li></ol></li></ol>    <div class="confbox admonition admonition-note">
        
            <p>
    The tool will do a best effort to convert all old attributes and elements to the new format. It will be necessary to make additional changes to the generated file. In the following examples, we will need to make a few changes to the resulting XML. Please, consult this documentation for additional information.            </p>
        </div>
    
    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-UsetheIronJacamarMigrationTooltoconvertadatasourceconfigurationfile."  >
        <h5>Use the IronJacamar Migration Tool to convert a datasource configuration file.</h5>
    
<ol class=" "><li class=" ">            <p>
    Open a terminal or command prompt and CD to the <tt class=" ">IRONJACAMAR_HOME/docs/as/</tt> directory.            </p>
    </li><li class=" ">            <p>
    For Linux, run the converter script by typing the following command in the terminal:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./converter.sh -ds FULLY_QUALIFIED_SOURCE_FILE_NAME FULLY_QUALIFIED_TARGET_FILE_NAME</code></pre>
        </div>
    </div>
            <p>
    For Windows, type:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>converter -ds FULLY_QUALIFIED_SOURCE_FILE_NAME FULLY_QUALIFIED_TARGET_FILE_NAME</code></pre>
        </div>
    </div>
</li><li class=" ">            <p>
    Copy the XML snippet from the target file into the server configuration file under the <tt class=" ">subsystem xmlns=&quot;urn:jboss:domain:datasources:1.0&quot;</tt> <tt class=" ">datasources</tt> element.            </p>
    <ol class=" "><li class=" ">            <p>
    If you are running in domain mode, you need to copy the XML snippet into the <tt class=" ">domain/configuration/domain.xml</tt> file.            </p>
    </li><li class=" ">            <p>
    If you are running in standalone mode, you need to copy the XML snippet into the <tt class=" ">standalone/configuration/standalone.xml</tt> file.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    The tool generates the <tt class=" ">datasources</tt> and <tt class=" ">datasource</tt> element. If you have existing datasources, you need only copy the <tt class=" ">datasource</tt> element into the configuration file.            </p>
        </div>
    
</li></ol></li></ol>            <p>
    Here is an example of the datasource configuration file for the Seam Booking example that shipped with EAP 5.x:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;datasources&gt;
  &lt;local-tx-datasource&gt;
    &lt;jndi-name&gt;bookingDatasource&lt;/jndi-name&gt;
    &lt;connection-url&gt;jdbc:hsqldb:.&lt;/connection-url&gt;
    &lt;driver-class&gt;org.hsqldb.jdbcDriver&lt;/driver-class&gt;
    &lt;user-name&gt;sa&lt;/user-name&gt;
    &lt;password&gt;&lt;/password&gt;
  &lt;/local-tx-datasource&gt;
&lt;/datasources&gt;</code></pre>
        </div>
    </div>
            <p>
    The generated file will contain a <tt class=" ">driver-class</tt> element. The preferred way to define the driver class is using a <tt class=" ">drivers</tt> element. Here is the converted XML with the <tt class=" ">driver-class</tt> and <tt class=" ">drivers</tt> modifications as configured in the WildFly&nbsp;configuration file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:datasources:1.0&quot;&gt;
  &lt;datasources&gt;
    &lt;datasource enabled=&quot;true&quot; jndi-name=&quot;java:jboss/datasources/bookingDatasource&quot; jta=&quot;true&quot;
            pool-name=&quot;bookingDatasource&quot; use-ccm=&quot;true&quot; use-java-context=&quot;true&quot;&gt;
      &lt;connection-url&gt;jdbc:hsqldb:.&lt;/connection-url&gt;
      &lt;!-- We commented out the following driver-class element since it is not the preferred way to define this.
              -&lt;driver-class&gt;org.hsqldb.jdbcDriver&lt;/driver-class&gt;-                                                --&gt;
      &lt;transaction-isolation&gt;TRANSACTION_NONE&lt;/transaction-isolation&gt;
      &lt;pool&gt;
        &lt;prefill&gt;false&lt;/prefill&gt;
        &lt;use-strict-min&gt;false&lt;/use-strict-min&gt;
        &lt;flush-strategy&gt;FailingConnectionOnly&lt;/flush-strategy&gt;
      &lt;/pool&gt;
      &lt;security&gt;
        &lt;user-name&gt;sa&lt;/user-name&gt;
        &lt;password/&gt;
      &lt;/security&gt;
      &lt;validation&gt;
        &lt;validate-on-match&gt;false&lt;/validate-on-match&gt;
        &lt;background-validation&gt;false&lt;/background-validation&gt;
        &lt;use-fast-fail&gt;false&lt;/use-fast-fail&gt;
      &lt;/validation&gt;
      &lt;timeout/&gt;
      &lt;statement&gt;
        &lt;track-statements&gt;false&lt;/track-statements&gt;
      &lt;/statement&gt;
    &lt;/datasource&gt;
    &lt;!-- The following drivers element was not in the generated XML snippet. We added this manually. --&gt;
    &lt;drivers&gt;
      &lt;driver name=&quot;h2&quot; module=&quot;com.h2database.h2&quot;&gt;
        &lt;xa-datasource-class&gt;org.h2.jdbcx.JdbcDataSource&lt;/xa-datasource-class&gt;
        &lt;/driver&gt;
      &lt;/drivers&gt;
  &lt;/datasources&gt;
&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-UsetheIronJacamarMigrationTooltoconvertaresourceadapterconfigurationfile."  >
        <h5>Use the IronJacamar Migration Tool to convert a resource adapter configuration file.</h5>
    
<ol class=" "><li class=" ">            <p>
    Open a terminal or command prompt and CD to the <tt class=" ">IRONJACAMAR_HOME/docs/as/</tt> directory.            </p>
    </li><li class=" ">            <p>
    For Linux, run the converter script by typing the following command in the terminal:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./converter.sh -ra FULLY_QUALIFIED_SOURCE_FILE_NAME FULLY_QUALIFIED_TARGET_FILE_NAME</code></pre>
        </div>
    </div>
            <p>
    For Windows, type:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./converter.sh -ra FULLY_QUALIFIED_SOURCE_FILE_NAME FULLY_QUALIFIED_TARGET_FILE_NAME</code></pre>
        </div>
    </div>
</li><li class=" ">            <p>
    Copy the XML snippet from the target file into the server configuration file under the <tt class=" ">subsystem xmlns=&quot;urn:jboss:domain:resource-adapters:1.0&quot;</tt> element.            </p>
    <ol class=" "><li class=" ">            <p>
    If you are running in domain mode, you need to copy the XML snippet into the <tt class=" ">domain/configuration/domain.xml</tt> file.            </p>
    </li><li class=" ">            <p>
    If you are running in standalone mode, you need to copy the XML snippet into the <tt class=" ">standalone/configuration/standalone.xml</tt> file.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    The tool generates the <tt class=" ">resource-adapters</tt> and <tt class=" ">resource-adapter</tt> element. If you have existing resource-adapters, you need to copy only the <tt class=" ">resource-adapter</tt> element into the configuration file.            </p>
        </div>
    
</li></ol></li></ol>            <p>
    Here is an example of the <tt class=" ">mttestadapter-ds.xml</tt> resource-adapter configuration file from the EAP-5.x TestSuite.:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;!-- ==================================================================== --&gt;
  &lt;!-- ConnectionManager setup for jboss test adapter                       --&gt;
  &lt;!-- Build jmx-api (build/build.sh all) and view for config documentation --&gt;
  &lt;!-- ==================================================================== --&gt;
&lt;connection-factories&gt;
  &lt;tx-connection-factory&gt;
    &lt;jndi-name&gt;JBossTestCF&lt;/jndi-name&gt;
    &lt;xa-transaction/&gt;
    &lt;rar-name&gt;jbosstestadapter.rar&lt;/rar-name&gt;
    &lt;connection-definition&gt;javax.resource.cci.ConnectionFactory&lt;/connection-definition&gt;
    &lt;config-property name=&quot;IntegerProperty&quot; type=&quot;java.lang.Integer&quot;&gt;2&lt;/config-property&gt;
    &lt;config-property name=&quot;BooleanProperty&quot; type=&quot;java.lang.Boolean&quot;&gt;false&lt;/config-property&gt;
    &lt;config-property name=&quot;DoubleProperty&quot; type=&quot;java.lang.Double&quot;&gt;5.5&lt;/config-property&gt;
    &lt;config-property name=&quot;UrlProperty&quot; type=&quot;java.net.URL&quot;&gt;http://www.jboss.org&lt;/config-property&gt;
    &lt;config-property name=&quot;sleepInStart&quot; type=&quot;long&quot;&gt;200&lt;/config-property&gt;
    &lt;config-property name=&quot;sleepInStop&quot; type=&quot;long&quot;&gt;200&lt;/config-property&gt;
  &lt;/tx-connection-factory&gt;
  &lt;tx-connection-factory&gt;
    &lt;jndi-name&gt;JBossTestCF2&lt;/jndi-name&gt;
    &lt;xa-transaction/&gt;
    &lt;rar-name&gt;jbosstestadapter.rar&lt;/rar-name&gt;
    &lt;connection-definition&gt;javax.resource.cci.ConnectionFactory&lt;/connection-definition&gt;
    &lt;config-property name=&quot;IntegerProperty&quot; type=&quot;java.lang.Integer&quot;&gt;2&lt;/config-property&gt;
    &lt;config-property name=&quot;BooleanProperty&quot; type=&quot;java.lang.Boolean&quot;&gt;false&lt;/config-property&gt;
    &lt;config-property name=&quot;DoubleProperty&quot; type=&quot;java.lang.Double&quot;&gt;5.5&lt;/config-property&gt;
    &lt;config-property name=&quot;UrlProperty&quot; type=&quot;java.net.URL&quot;&gt;http://www.jboss.org&lt;/config-property&gt;
    &lt;config-property name=&quot;sleepInStart&quot; type=&quot;long&quot;&gt;200&lt;/config-property&gt;
    &lt;config-property name=&quot;sleepInStop&quot; type=&quot;long&quot;&gt;200&lt;/config-property&gt;
  &lt;/tx-connection-factory&gt;
  &lt;tx-connection-factory&gt;
    &lt;jndi-name&gt;JBossTestCFByTx&lt;/jndi-name&gt;
    &lt;xa-transaction/&gt;
    &lt;track-connection-by-tx&gt;true&lt;/track-connection-by-tx&gt;
    &lt;rar-name&gt;jbosstestadapter.rar&lt;/rar-name&gt;
    &lt;connection-definition&gt;javax.resource.cci.ConnectionFactory&lt;/connection-definition&gt;
    &lt;config-property name=&quot;IntegerProperty&quot; type=&quot;java.lang.Integer&quot;&gt;2&lt;/config-property&gt;
    &lt;config-property name=&quot;BooleanProperty&quot; type=&quot;java.lang.Boolean&quot;&gt;false&lt;/config-property&gt;
    &lt;config-property name=&quot;DoubleProperty&quot; type=&quot;java.lang.Double&quot;&gt;5.5&lt;/config-property&gt;
    &lt;config-property name=&quot;UrlProperty&quot; type=&quot;java.net.URL&quot;&gt;http://www.jboss.org&lt;/config-property&gt;
    &lt;config-property name=&quot;sleepInStart&quot; type=&quot;long&quot;&gt;200&lt;/config-property&gt;
    &lt;config-property name=&quot;sleepInStop&quot; type=&quot;long&quot;&gt;200&lt;/config-property&gt;
  &lt;/tx-connection-factory&gt;
&lt;/connection-factories&gt;</code></pre>
        </div>
    </div>
            <p>
    You will need to replace the class-name attribute &quot;FIXME_MCF_CLASS_NAME&quot; in the generated XML snippet with the class name of the managed connection factory, in this case, &quot;org.jboss.test.jca.adapter.TestManagedConnectionFactory&quot;. Here is the server configuration file with the newly generated and edited configuration data:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:resource-adapters:1.0&quot;&gt;
&lt;resource-adapters&gt;
  &lt;resource-adapter&gt;
    &lt;archive&gt;jbosstestadapter.rar&lt;/archive&gt;
    &lt;transaction-support&gt;XATransaction&lt;/transaction-support&gt;
    &lt;connection-definitions&gt;
      &lt;!-- We replaced the following &quot;FIXME_MCF_CLASS_NAME&quot; class-name value with the correct class name
            &lt;connection-definition class-name=&quot;FIXME_MCF_CLASS_NAME&quot; enabled=&quot;true&quot;
                  jndi-name=&quot;java:jboss/JBossTestCF&quot; pool-name=&quot;JBossTestCF&quot; use-ccm=&quot;true&quot; use-java-context=&quot;true&quot;&gt; --&gt;
      &lt;connection-definition class-name=&quot;org.jboss.test.jca.adapter.TestManagedConnectionFactory&quot; enabled=&quot;true&quot;
                  jndi-name=&quot;java:jboss/JBossTestCF&quot; pool-name=&quot;JBossTestCF&quot; use-ccm=&quot;true&quot; use-java-context=&quot;true&quot;&gt;
        &lt;config-property name=&quot;IntegerProperty&quot;&gt;2&lt;/config-property&gt;
        &lt;config-property name=&quot;sleepInStart&quot;&gt;200&lt;/config-property&gt;
        &lt;config-property name=&quot;sleepInStop&quot;&gt;200&lt;/config-property&gt;
        &lt;config-property name=&quot;BooleanProperty&quot;&gt;false&lt;/config-property&gt;
        &lt;config-property name=&quot;UrlProperty&quot;&gt;http://www.jboss.org&lt;/config-property&gt;
        &lt;config-property name=&quot;DoubleProperty&quot;&gt;5.5&lt;/config-property&gt;
        &lt;pool&gt;
          &lt;prefill&gt;false&lt;/prefill&gt;
          &lt;use-strict-min&gt;false&lt;/use-strict-min&gt;
          &lt;flush-strategy&gt;FailingConnectionOnly&lt;/flush-strategy&gt;
        &lt;/pool&gt;
        &lt;security&gt;
          &lt;application/&gt;
        &lt;/security&gt;
        &lt;timeout/&gt;
        &lt;validation&gt;
          &lt;background-validation&gt;false&lt;/background-validation&gt;
          &lt;use-fast-fail&gt;false&lt;/use-fast-fail&gt;
        &lt;/validation&gt;
      &lt;/connection-definition&gt;
    &lt;/connection-definitions&gt;
  &lt;/resource-adapter&gt;
  &lt;resource-adapter&gt;
    &lt;archive&gt;jbosstestadapter.rar&lt;/archive&gt;
    &lt;transaction-support&gt;XATransaction&lt;/transaction-support&gt;
    &lt;connection-definitions&gt;
       &lt;!-- We replaced the following &quot;FIXME_MCF_CLASS_NAME&quot; class-name value with the correct class name
             &lt;connection-definition class-name=&quot;FIXME_MCF_CLASS_NAME&quot; enabled=&quot;true&quot;
                   jndi-name=&quot;java:jboss/JBossTestCF2&quot; pool-name=&quot;JBossTestCF2&quot; use-ccm=&quot;true&quot; use-java-context=&quot;true&quot;&gt; --&gt;
      &lt;connection-definition class-name=&quot;org.jboss.test.jca.adapter.TestManagedConnectionFactory&quot; enabled=&quot;true&quot;
              jndi-name=&quot;java:jboss/JBossTestCF2&quot; pool-name=&quot;JBossTestCF2&quot; use-ccm=&quot;true&quot; use-java-context=&quot;true&quot;&gt;
        &lt;config-property name=&quot;IntegerProperty&quot;&gt;2&lt;/config-property&gt;
        &lt;config-property name=&quot;sleepInStart&quot;&gt;200&lt;/config-property&gt;
        &lt;config-property name=&quot;sleepInStop&quot;&gt;200&lt;/config-property&gt;
        &lt;config-property name=&quot;BooleanProperty&quot;&gt;false&lt;/config-property&gt;
        &lt;config-property name=&quot;UrlProperty&quot;&gt;http://www.jboss.org&lt;/config-property&gt;
        &lt;config-property name=&quot;DoubleProperty&quot;&gt;5.5&lt;/config-property&gt;
        &lt;pool&gt;
          &lt;prefill&gt;false&lt;/prefill&gt;
          &lt;use-strict-min&gt;false&lt;/use-strict-min&gt;
          &lt;flush-strategy&gt;FailingConnectionOnly&lt;/flush-strategy&gt;
        &lt;/pool&gt;
        &lt;security&gt;
          &lt;application/&gt;
        &lt;/security&gt;
        &lt;timeout/&gt;
        &lt;validation&gt;
          &lt;background-validation&gt;false&lt;/background-validation&gt;
          &lt;use-fast-fail&gt;false&lt;/use-fast-fail&gt;
        &lt;/validation&gt;
      &lt;/connection-definition&gt;
    &lt;/connection-definitions&gt;
  &lt;/resource-adapter&gt;
  &lt;resource-adapter&gt;
    &lt;archive&gt;jbosstestadapter.rar&lt;/archive&gt;
    &lt;transaction-support&gt;XATransaction&lt;/transaction-support&gt;
    &lt;connection-definitions&gt;
      &lt;!-- We replaced the following &quot;FIXME_MCF_CLASS_NAME&quot; class-name value with the correct class name
             &lt;connection-definition class-name=&quot;FIXME_MCF_CLASS_NAME&quot; enabled=&quot;true&quot;
                   jndi-name=&quot;java:jboss/JBossTestCFByTx&quot; pool-name=&quot;JBossTestCFByTx&quot; use-ccm=&quot;true&quot; use-java-context=&quot;true&quot;&gt; --&gt;
      &lt;connection-definition class-name=&quot;org.jboss.test.jca.adapter.TestManagedConnectionFactory&quot; enabled=&quot;true&quot;
              jndi-name=&quot;java:jboss/JBossTestCFByTx&quot; pool-name=&quot;JBossTestCFByTx&quot; use-ccm=&quot;true&quot; use-java-context=&quot;true&quot;&gt;
        &lt;config-property name=&quot;IntegerProperty&quot;&gt;2&lt;/config-property&gt;
        &lt;config-property name=&quot;sleepInStart&quot;&gt;200&lt;/config-property&gt;
        &lt;config-property name=&quot;sleepInStop&quot;&gt;200&lt;/config-property&gt;
        &lt;config-property name=&quot;BooleanProperty&quot;&gt;false&lt;/config-property&gt;
        &lt;config-property name=&quot;UrlProperty&quot;&gt;http://www.jboss.org&lt;/config-property&gt;
        &lt;config-property name=&quot;DoubleProperty&quot;&gt;5.5&lt;/config-property&gt;
        &lt;pool&gt;
          &lt;prefill&gt;false&lt;/prefill&gt;
          &lt;use-strict-min&gt;false&lt;/use-strict-min&gt;
          &lt;flush-strategy&gt;FailingConnectionOnly&lt;/flush-strategy&gt;
        &lt;/pool&gt;
        &lt;security&gt;
          &lt;application/&gt;
        &lt;/security&gt;
        &lt;timeout/&gt;
        &lt;validation&gt;
          &lt;background-validation&gt;false&lt;/background-validation&gt;
          &lt;use-fast-fail&gt;false&lt;/use-fast-fail&gt;
        &lt;/validation&gt;
      &lt;/connection-definition&gt;
    &lt;/connection-definitions&gt;
  &lt;/resource-adapter&gt;
&lt;/resource-adapters&gt;&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
            <p>
    For more information about this migration tool, go to <a href="http://docs.jboss.org/ironjacamar/userguide/1.1/en-US/html/tools.html#tools_migration">IronJacamar Migration Tool </a>.            </p>
        </div>
    
    </div>
    
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-EJBinvocationsfromaremotestandaloneclientusingJNDI"  >
        <h2>EJB invocations from a remote standalone client using JNDI</h2>
    
            <p>
    This chapter explains how to invoke EJBs from a remote client by using the JNDI API to first lookup the bean proxy and then invoke on that proxy.            </p>
        <div class="confbox admonition admonition-info">
        
            <p>
    After you have read this article, do remember to take a look at <a href="https://docs.jboss.org/author/display/WFLY8/Remote+EJB+invocations+via+JNDI+-+EJB+client+API+or+remote-naming+project">Remote EJB invocations via JNDI - EJB client API or remote-naming project</a>            </p>
        </div>
    
            <p>
    Before getting into the details, we would like the users to know that we have introduced a new EJB client API, which is a WildFly-specific API and allows invocation on remote EJBs. This client API isn't based on JNDI. So remote clients need not rely on JNDI API to invoke on EJBs. A separate document covering the EJB remote client API will be made available. For now, you can refer to the javadocs of the EJB client project at <a href="http://docs.jboss.org/ejbclient/">http://docs.jboss.org/ejbclient/</a>. In this document, we'll just concentrate on the traditional JNDI based invocation on EJBs. So let's get started:            </p>
        <div class="section-3"  id="66322748_DeveloperGuide-DeployingyourEJBsontheserverside%3A"  >
        <h3>Deploying your EJBs on the server side:</h3>
    
    <div class="confbox admonition admonition-note">
        
            <p>
    Users who already have EJBs deployed on the server side can just skip to the next section.            </p>
        </div>
    
            <p>
    As a first step, you'll have to deploy your application containing the EJBs on the AS7 server. If you want those EJBs to be remotely invocable, then you'll have to expose atleast one remote view for that bean. In this example, let's consider a simple Calculator stateless bean which exposes a RemoteCalculator remote business interface. We'll also have a simple stateful CounterBean which exposes a RemoteCounter remote business interface. Here's the code:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>package org.jboss.as.quickstarts.ejb.remote.stateless;

/**
 * @author Jaikiran Pai
 */
public interface RemoteCalculator {

    int add(int a, int b);

    int subtract(int a, int b);
}</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>package org.jboss.as.quickstarts.ejb.remote.stateless;

import javax.ejb.Remote;
import javax.ejb.Stateless;

/**
 * @author Jaikiran Pai
 */
@Stateless
@Remote(RemoteCalculator.class)
public class CalculatorBean implements RemoteCalculator {

    @Override
    public int add(int a, int b) {
        return a + b;
    }

    @Override
    public int subtract(int a, int b) {
        return a - b;
    }
}</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>package org.jboss.as.quickstarts.ejb.remote.stateful;

/**
 * @author Jaikiran Pai
 */
public interface RemoteCounter {

    void increment();

    void decrement();

    int getCount();
}</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>package org.jboss.as.quickstarts.ejb.remote.stateful;

import javax.ejb.Remote;
import javax.ejb.Stateful;

/**
 * @author Jaikiran Pai
 */
@Stateful
@Remote(RemoteCounter.class)
public class CounterBean implements RemoteCounter {

    private int count = 0;

    @Override
    public void increment() {
        this.count++;
    }

    @Override
    public void decrement() {
        this.count--;
    }

    @Override
    public int getCount() {
        return this.count;
    }
}</code></pre>
        </div>
    </div>
            <p>
    Let's package this in a jar (how you package it in a jar is out of scope of this chapter) named &quot;jboss-as-ejb-remote-app.jar&quot; and deploy it to the server. Make sure that your deployment has been processed successfully and there aren't any errors.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-WritingaremoteclientapplicationforaccessingandinvokingtheEJBsdeployedontheserver"  >
        <h3>Writing a remote client application for accessing and invoking the EJBs deployed on the server</h3>
    
            <p>
    The next step is to write an application which will invoke the EJBs that you deployed on the server. In WildFly, you can either choose to use the WildFly 8&nbsp;specific EJB client API to do the invocation or use JNDI to lookup a proxy for your bean and invoke on that returned proxy. In this chapter we will concentrate on the JNDI lookup and invocation and will leave the EJB client API for a separate chapter.            </p>
                <p>
    So let's take a look at what the client code looks like for looking up the JNDI proxy and invoking on it. Here's the entire client code which invokes on a stateless bean:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>package org.jboss.as.quickstarts.ejb.remote.client;

import javax.naming.Context;
import javax.naming.InitialContext;
import javax.naming.NamingException;
import java.security.Security;
import java.util.Hashtable;

import org.jboss.as.quickstarts.ejb.remote.stateful.CounterBean;
import org.jboss.as.quickstarts.ejb.remote.stateful.RemoteCounter;
import org.jboss.as.quickstarts.ejb.remote.stateless.CalculatorBean;
import org.jboss.as.quickstarts.ejb.remote.stateless.RemoteCalculator;
import org.jboss.sasl.JBossSaslProvider;

/**
 * A sample program which acts a remote client for a EJB deployed on AS7 server.
 * This program shows how to lookup stateful and stateless beans via JNDI and then invoke on them
 *
 * @author Jaikiran Pai
 */
public class RemoteEJBClient {

    public static void main(String[] args) throws Exception {
        // Invoke a stateless bean
        invokeStatelessBean();

        // Invoke a stateful bean
        invokeStatefulBean();
    }

    /**
     * Looks up a stateless bean and invokes on it
     *
     * @throws NamingException
     */
    private static void invokeStatelessBean() throws NamingException {
        // Let's lookup the remote stateless calculator
        final RemoteCalculator statelessRemoteCalculator = lookupRemoteStatelessCalculator();
        System.out.println(&quot;Obtained a remote stateless calculator for invocation&quot;);
        // invoke on the remote calculator
        int a = 204;
        int b = 340;
        System.out.println(&quot;Adding &quot; + a + &quot; and &quot; + b + &quot; via the remote stateless calculator deployed on the server&quot;);
        int sum = statelessRemoteCalculator.add(a, b);
        System.out.println(&quot;Remote calculator returned sum = &quot; + sum);
        if (sum != a + b) {
            throw new RuntimeException(&quot;Remote stateless calculator returned an incorrect sum &quot; + sum + &quot; ,expected sum was &quot; + (a + b));
        }
        // try one more invocation, this time for subtraction
        int num1 = 3434;
        int num2 = 2332;
        System.out.println(&quot;Subtracting &quot; + num2 + &quot; from &quot; + num1 + &quot; via the remote stateless calculator deployed on the server&quot;);
        int difference = statelessRemoteCalculator.subtract(num1, num2);
        System.out.println(&quot;Remote calculator returned difference = &quot; + difference);
        if (difference != num1 - num2) {
            throw new RuntimeException(&quot;Remote stateless calculator returned an incorrect difference &quot; + difference + &quot; ,expected difference was &quot; + (num1 - num2));
        }
    }

    /**
     * Looks up a stateful bean and invokes on it
     *
     * @throws NamingException
     */
    private static void invokeStatefulBean() throws NamingException {
        // Let's lookup the remote stateful counter
        final RemoteCounter statefulRemoteCounter = lookupRemoteStatefulCounter();
        System.out.println(&quot;Obtained a remote stateful counter for invocation&quot;);
        // invoke on the remote counter bean
        final int NUM_TIMES = 20;
        System.out.println(&quot;Counter will now be incremented &quot; + NUM_TIMES + &quot; times&quot;);
        for (int i = 0; i &lt; NUM_TIMES; i++) {
            System.out.println(&quot;Incrementing counter&quot;);
            statefulRemoteCounter.increment();
            System.out.println(&quot;Count after increment is &quot; + statefulRemoteCounter.getCount());
        }
        // now decrementing
        System.out.println(&quot;Counter will now be decremented &quot; + NUM_TIMES + &quot; times&quot;);
        for (int i = NUM_TIMES; i &gt; 0; i--) {
            System.out.println(&quot;Decrementing counter&quot;);
            statefulRemoteCounter.decrement();
            System.out.println(&quot;Count after decrement is &quot; + statefulRemoteCounter.getCount());
        }
    }

    /**
     * Looks up and returns the proxy to remote stateless calculator bean
     *
     * @return
     * @throws NamingException
     */
    private static RemoteCalculator lookupRemoteStatelessCalculator() throws NamingException {
        final Hashtable jndiProperties = new Hashtable();
        jndiProperties.put(Context.URL_PKG_PREFIXES, &quot;org.jboss.ejb.client.naming&quot;);
        final Context context = new InitialContext(jndiProperties);
        // The app name is the application name of the deployed EJBs. This is typically the ear name
        // without the .ear suffix. However, the application name could be overridden in the application.xml of the
        // EJB deployment on the server.
        // Since we haven't deployed the application as a .ear, the app name for us will be an empty string
        final String appName = &quot;&quot;;
        // This is the module name of the deployed EJBs on the server. This is typically the jar name of the
        // EJB deployment, without the .jar suffix, but can be overridden via the ejb-jar.xml
        // In this example, we have deployed the EJBs in a jboss-as-ejb-remote-app.jar, so the module name is
        // jboss-as-ejb-remote-app
        final String moduleName = &quot;jboss-as-ejb-remote-app&quot;;
        // AS7 allows each deployment to have an (optional) distinct name. We haven't specified a distinct name for
        // our EJB deployment, so this is an empty string
        final String distinctName = &quot;&quot;;
        // The EJB name which by default is the simple class name of the bean implementation class
        final String beanName = CalculatorBean.class.getSimpleName();
        // the remote view fully qualified class name
        final String viewClassName = RemoteCalculator.class.getName();
        // let's do the lookup
        return (RemoteCalculator) context.lookup(&quot;ejb:&quot; + appName + &quot;/&quot; + moduleName + &quot;/&quot; + distinctName + &quot;/&quot; + beanName + &quot;!&quot; + viewClassName);
    }

    /**
     * Looks up and returns the proxy to remote stateful counter bean
     *
     * @return
     * @throws NamingException
     */
    private static RemoteCounter lookupRemoteStatefulCounter() throws NamingException {
        final Hashtable jndiProperties = new Hashtable();
        jndiProperties.put(Context.URL_PKG_PREFIXES, &quot;org.jboss.ejb.client.naming&quot;);
        final Context context = new InitialContext(jndiProperties);
        // The app name is the application name of the deployed EJBs. This is typically the ear name
        // without the .ear suffix. However, the application name could be overridden in the application.xml of the
        // EJB deployment on the server.
        // Since we haven't deployed the application as a .ear, the app name for us will be an empty string
        final String appName = &quot;&quot;;
        // This is the module name of the deployed EJBs on the server. This is typically the jar name of the
        // EJB deployment, without the .jar suffix, but can be overridden via the ejb-jar.xml
        // In this example, we have deployed the EJBs in a jboss-as-ejb-remote-app.jar, so the module name is
        // jboss-as-ejb-remote-app
        final String moduleName = &quot;jboss-as-ejb-remote-app&quot;;
        // AS7 allows each deployment to have an (optional) distinct name. We haven't specified a distinct name for
        // our EJB deployment, so this is an empty string
        final String distinctName = &quot;&quot;;
        // The EJB name which by default is the simple class name of the bean implementation class
        final String beanName = CounterBean.class.getSimpleName();
        // the remote view fully qualified class name
        final String viewClassName = RemoteCounter.class.getName();
        // let's do the lookup (notice the ?stateful string as the last part of the jndi name for stateful bean lookup)
        return (RemoteCounter) context.lookup(&quot;ejb:&quot; + appName + &quot;/&quot; + moduleName + &quot;/&quot; + distinctName + &quot;/&quot; + beanName + &quot;!&quot; + viewClassName + &quot;?stateful&quot;);
    }
}</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    The entire server side and client side code is hosted at the github repo here <a href="https://github.com/wildfly/quickstart/tree/master/ejb-remote">ejb-remote</a>            </p>
        </div>
    
            <p>
    The code has some comments which will help you understand each of those lines. But we'll explain here in more detail what the code does. As a first step in the client code, we'll do a lookup of the EJB using a JNDI name. In AS7, for remote access to EJBs, you use the ejb: namespace with the following syntax:            </p>
                <p>
    <strong class=" ">For stateless beans:</strong>            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>ejb:&lt;app-name&gt;/&lt;module-name&gt;/&lt;distinct-name&gt;/&lt;bean-name&gt;!&lt;fully-qualified-classname-of-the-remote-interface&gt;</code></pre>
        </div>
    </div>
            <p>
    <strong class=" ">For stateful beans:</strong>            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>ejb:&lt;app-name&gt;/&lt;module-name&gt;/&lt;distinct-name&gt;/&lt;bean-name&gt;!&lt;fully-qualified-classname-of-the-remote-interface&gt;?stateful</code></pre>
        </div>
    </div>
            <p>
    The ejb: namespace identifies it as a EJB lookup and is a constant (i.e. doesn't change) for doing EJB lookups. The rest of the parts in the jndi name are as follows:            </p>
                <p>
    <strong class=" ">app-name</strong> : This is the name of the .ear (without the .ear suffix) that you have deployed on the server and contains your EJBs.            </p>
    <ul class=" "><li class=" ">            <p>
    Java EE 6 allows you to override the application name, to a name of your choice by setting it in the application.xml. If the deployment uses uses such an override then the app-name used in the JNDI name should match that name.            </p>
    </li><li class=" ">            <p>
    EJBs can also be deployed in a .war or a plain .jar (like we did in step 1). In such cases where the deployment isn't an .ear file, then the app-name must be an empty string, while doing the lookup.            </p>
    </li></ul>            <p>
    <strong class=" ">module-name</strong> : This is the name of the .jar (without the .jar suffix) that you have deployed on the server and the contains your EJBs. If the EJBs are deployed in a .war then the module name is the .war name (without the .war suffix).            </p>
    <ul class=" "><li class=" ">            <p>
    Java EE 6 allows you to override the module name, by setting it in the ejb-jar.xml/web.xml of your deployment. If the deployment uses such an override then the module-name used in the JNDI name should match that name.            </p>
    </li><li class=" ">            <p>
    Module name part cannot be an empty string in the JNDI name            </p>
    </li></ul>            <p>
    <strong class=" ">distinct-name</strong> : This is a WildFly-specific name which can be optionally assigned to the deployments that are deployed on the server. More about the purpose and usage of this will be explained in a separate chapter. If a deployment doesn't use distinct-name then, use an empty string in the JNDI name, for distinct-name            </p>
                <p>
    <strong class=" ">bean-name</strong> : This is the name of the bean for which you are doing the lookup. The bean name is typically the unqualified classname of the bean implementation class, but can be overriden through either ejb-jar.xml or via annotations. The bean name part cannot be an empty string in the JNDI name.            </p>
                <p>
    <strong class=" ">fully-qualified-classname-of-the-remote-interface</strong> : This is the fully qualified class name of the interface for which you are doing the lookup. The interface should be one of the remote interfaces exposed by the bean on the server. The fully qualified class name part cannot be an empty string in the JNDI name.            </p>
                <p>
    For stateful beans, the JNDI name expects an additional &quot;?stateful&quot; to be appended after the fully qualified interface name part. This is because for stateful beans, a new session gets created on JNDI lookup and the EJB client API implementation doesn't contact the server during the JNDI lookup to know what kind of a bean the JNDI name represents (we'll come to this in a while). So the JNDI name itself is expected to indicate that the client is looking up a stateful bean, so that an appropriate session can be created.            </p>
                <p>
    Now that we know the syntax, let's see our code and check what JNDI name it uses. Since our stateless EJB named CalculatorBean is deployed in a jboss-as-ejb-remote-app.jar (without any ear) and since we are looking up the org.jboss.as.quickstarts.ejb.remote.stateless.RemoteCalculator remote interface, our JNDI name will be:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>ejb:/jboss-as-ejb-remote-app//CalculatorBean!org.jboss.as.quickstarts.ejb.remote.stateless.RemoteCalculator</code></pre>
        </div>
    </div>
            <p>
    That's what the lookupRemoteStatelessCalculator() method in the above client code uses.            </p>
                <p>
    For the stateful EJB named CounterBean which is deployed in hte same jboss-as-ejb-remote-app.jar and which exposes the org.jboss.as.quickstarts.ejb.remote.stateful.RemoteCounter, the JNDI name will be:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>ejb:/jboss-as-ejb-remote-app//CounterBean!org.jboss.as.quickstarts.ejb.remote.stateful.RemoteCounter?stateful</code></pre>
        </div>
    </div>
            <p>
    That's what the lookupRemoteStatefulCounter() method in the above client code uses.            </p>
                <p>
    Now that we know of the JNDI name, let's take a look at the following piece of code in the lookupRemoteStatelessCalculator():            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>final Hashtable jndiProperties = new Hashtable();
jndiProperties.put(Context.URL_PKG_PREFIXES, &quot;org.jboss.ejb.client.naming&quot;);
final Context context = new InitialContext(jndiProperties);</code></pre>
        </div>
    </div>
            <p>
    Here we are creating a JNDI InitialContext object by passing it some JNDI properties. The Context.URL_PKG_PREFIXES is set to org.jboss.ejb.client.naming. This is necessary because we should let the JNDI API know what handles the ejb: namespace that we use in our JNDI names for lookup. The &quot;org.jboss.ejb.client.naming&quot; has a URLContextFactory implementation which will be used by the JNDI APIs to parse and return an object for ejb: namespace lookups. You can either pass these properties to the constructor of the InitialContext class or have a jndi.properites file in the classpath of the client application, which (atleast) contains the following property:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>java.naming.factory.url.pkgs=org.jboss.ejb.client.naming</code></pre>
        </div>
    </div>
            <p>
    So at this point, we have setup the InitialContext and also have the JNDI name ready to do the lookup. You can now do the lookup and the appropriate proxy which will be castable to the remote interface that you used as the fully qualified class name in the JNDI name, will be returned. Some of you might be wondering, how the JNDI implementation knew which server address to look, for your deployed EJBs. The answer is in AS7, the proxies returned via JNDI name lookup for ejb: namespace do not connect to the server unless an invocation on those proxies is done.            </p>
                <p>
    Now let's get to the point where we invoke on this returned proxy:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>// Let's lookup the remote stateless calculator
        final RemoteCalculator statelessRemoteCalculator = lookupRemoteStatelessCalculator();
        System.out.println(&quot;Obtained a remote stateless calculator for invocation&quot;);
        // invoke on the remote calculator
        int a = 204;
        int b = 340;
        System.out.println(&quot;Adding &quot; + a + &quot; and &quot; + b + &quot; via the remote stateless calculator deployed on the server&quot;);
        int sum = statelessRemoteCalculator.add(a, b);</code></pre>
        </div>
    </div>
            <p>
    We can see here that the proxy returned after the lookup is used to invoke the add(...) method of the bean. It's at this point that the JNDI implementation (which is backed by the EJB client API) needs to know the server details. So let's now get to the important part of setting up the EJB client context properties.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-SettingupEJBclientcontextproperties"  >
        <h3>Setting up EJB client context properties</h3>
    
            <p>
    A EJB client context is a context which contains contextual information for carrying out remote invocations on EJBs. This is a WildFly-specific API. The EJB client context can be associated with multiple EJB receivers. Each EJB receiver is capable of handling invocations on different EJBs. For example, an EJB receiver &quot;Foo&quot; might be able to handle invocation on a bean identified by app-A/module-A/distinctinctName-A/Bar!RemoteBar, whereas a EJB receiver named &quot;Blah&quot; might be able to handle invocation on a bean identified by app-B/module-B/distinctName-B/BeanB!RemoteBean. Each such EJB receiver knows about what set of EJBs it can handle and each of the EJB receiver knows which server target to use for handling the invocations on the bean. For example, if you have a AS7 server at 10.20.30.40 IP address which has its remoting port opened at 4447 and if that's the server on which you deployed that CalculatorBean, then you can setup a EJB receiver which knows its target address is 10.20.30.40:4447. Such an EJB receiver will be capable enough to communicate to the server via the JBoss specific EJB remote client protocol (details of which will be explained in-depth in a separate chapter).            </p>
                <p>
    Now that we know what a EJB client context is and what a EJB receiver is, let's see how we can setup a client context with 1 EJB receiver which can connect to 10.20.30.40 IP address at port 4447. That EJB client context will then be used (internally) by the JNDI implementation to handle invocations on the bean proxy.            </p>
                <p>
    The client will have to place a jboss-ejb-client.properties file in the classpath of the application. The jboss-ejb-client.properties can contain the following properties:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>endpoint.name=client-endpoint
remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false

remote.connections=default

remote.connection.default.host=10.20.30.40
remote.connection.default.port = 8080
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false

remote.connection.default.username=appuser
remote.connection.default.password=apppassword</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    The above properties file is just an example. The actual file that was used for this sample program is available here for reference <a href="https://github.com/wildfly/quickstart/blob/master/ejb-remote/client/src/main/resources/jboss-ejb-client.properties">jboss-ejb-client.properties</a>            </p>
        </div>
    
            <p>
    We'll see what each of it means.            </p>
                <p>
    First the endpoint.name property. We mentioned earlier that the EJB receivers will communicate with the server for EJB invocations. Internally, they use JBoss&nbsp;Remoting project to carry out the communication. The endpoint.name property represents the name that will be used to create the client side of the enpdoint. The endpoint.name property is optional and if not specified in the jboss-ejb-client.properties file, it will default to &quot;config-based-ejb-client-endpoint&quot; name.            </p>
                <p>
    Next is the remote.connectionprovider.create.options.&lt;....&gt; properties:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false</code></pre>
        </div>
    </div>
            <p>
    The &quot;remote.connectionprovider.create.options.&quot; property prefix can be used to pass the options that will be used while create the connection provider which will handle the &quot;remote:&quot; protocol. In this example we use the &quot;remote.connectionprovider.create.options.&quot; property prefix to pass the &quot;org.xnio.Options.SSL_ENABLED&quot; property value as false. That property will then be used during the connection provider creation. Similarly other properties can be passed too, just append it to the &quot;remote.connectionprovider.create.options.&quot; prefix            </p>
                <p>
    Next we'll see:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>remote.connections=default</code></pre>
        </div>
    </div>
            <p>
    This is where you define the connections that you want to setup for communication with the remote server. The &quot;remote.connections&quot; property uses a comma separated value of connection &quot;names&quot;. The connection names are just logical and are used grouping together the connection configuration properties later on in the properties file. The example above sets up a single remote connection named &quot;default&quot;. There can be more than one connections that are configured. For example:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>remote.connections=one, two</code></pre>
        </div>
    </div>
            <p>
    Here we are listing 2 connections named &quot;one&quot; and &quot;two&quot;. Ultimately, each of the connections will map to a EJB receiver. So if you have 2 connections, that will setup 2 EJB receivers that will be added to the EJB client context. Each of these connections will be configured with the connection specific properties as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>remote.connection.default.host=10.20.30.40
remote.connection.default.port = 8080
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false</code></pre>
        </div>
    </div>
            <p>
    As you can see we are using the &quot;remote.connection.&lt;connection-name&gt;.&quot; prefix for specifying the connection specific property. The connection name here is &quot;default&quot; and we are setting the &quot;host&quot; property of that connection to point to 10.20.30.40. Similarly we set the &quot;port&quot; for that connection to 4447.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    By default WildFly uses 8080 as the remoting port. The EJB client API uses the http port, with the http-upgrade functionality, for communicating with the server for remote invocations, so that's the port we use in our client programs (unless the server is configured for some other http port)            </p>
        </div>
    
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>remote.connection.default.username=appuser
remote.connection.default.password=apppassword</code></pre>
        </div>
    </div>
            <p>
    The given user/password must be set by using the command bin/add-user.sh &#65279;(or.bat).<br/>The user and password must be set because the security-realm is enabled for the subsystem remoting (see standalone*.xml or domain.xml) by default.<br/>If you do not need the security for remoting you might remove the attribute security-realm in the configuration.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    security-realm is enabled by default.            </p>
        </div>
    
            <p>
    We then use the &quot;remote.connection.&lt;connection-name&gt;.connect.options.&quot; property prefix to setup options that will be used during the connection creation.            </p>
                <p>
    Here's an example of setting up multiple connections with different properties for each of those:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false

remote.connections=one, two

remote.connection.one.host=localhost
remote.connection.one.port=6999
remote.connection.one.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false

remote.connection.two.host=localhost
remote.connection.two.port=7999
remote.connection.two.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false</code></pre>
        </div>
    </div>
            <p>
    As you can see we setup 2 connections &quot;one&quot; and &quot;two&quot; which both point to &quot;localhost&quot; as the &quot;host&quot; but different ports. Each of these connections will internally be used to create the EJB receivers in the EJB client context.            </p>
                <p>
    So that's how the jboss-ejb-client.properties file can be setup and placed in the classpath.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UsingadifferentfileforsettingupEJBclientcontext"  >
        <h3>Using a different file for setting up EJB client context</h3>
    
            <p>
    The EJB client code will by default look for jboss-ejb-client.properties in the classpath. However, you can specify a different file of your choice by setting the &quot;jboss.ejb.client.properties.file.path&quot; system property which points to a properties file on your filesystem, containing the client context configurations. An example for that would be &quot;-Djboss.ejb.client.properties.file.path=/home/me/my-client/custom-jboss-ejb-client.properties&quot;            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Settinguptheclientclasspathwiththejarsthatarerequiredtoruntheclientapplication"  >
        <h3>Setting up the client classpath with the jars that are required to run the client application</h3>
    
            <p>
    A jboss-client jar is shipped in the distribution. It's available at WILDFLY_HOME/bin/client/jboss-client.jar. Place this jar in the classpath of your client application.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    If you are using Maven to build the client application, then please follow the instructions in the WILDFLY_HOME/bin/client/README.txt to add this jar as a Maven dependency.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Summary2"  >
        <h3>Summary</h3>
    
            <p>
    In the above examples, we saw what it takes to invoke a EJB from a remote client. To summarize:            </p>
    <ul class=" "><li class=" ">            <p>
    On the server side you need to deploy EJBs which expose the remote views.            </p>
    </li><li class=" ">            <p>
    On the client side you need a client program which:            </p>
    <ul class=" "><li class=" ">            <p>
    Has a jboss-ejb-client.properties in its classpath to setup the server connection information            </p>
    </li><li class=" ">            <p>
    Either has a jndi.properties to specify the java.naming.factory.url.pkgs property or passes that as a property to the InitialContext constructor            </p>
    </li><li class=" ">            <p>
    Setup the client classpath to include the jboss-client jar that's required for remote invocation of the EJBs. The location of the jar is mentioned above. You'll also need to have your application's bean interface jars and other jars that are required by your application, in the client classpath            </p>
    </li></ul></li></ul>    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-EJBinvocationsfromaremoteserver"  >
        <h2>EJB invocations from a remote server</h2>
    
            <p>
    The purpose of this chapter is to demonstrate how to lookup and invoke on EJBs deployed on an WildFly&nbsp;server instance <strong class=" ">from another</strong> WildFly&nbsp;server instance. This is different from invoking the EJBs <a href="https://docs.jboss.org/author/display/AS71/EJB+invocations+from+a+remote+client+using+JNDI">from a remote standalone client</a>            </p>
                <p>
    Let's call the server, from which the invocation happens to the EJB, as   &quot;Client Server&quot; and the server on which the bean is deployed as the   &quot;Destination Server&quot;.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    Note that this chapter deals with the case where the bean is deployed on the &quot;Destination Server&quot; but <strong class=" ">not</strong> on the &quot;Client Server&quot;.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Applicationpackaging"  >
        <h3>Application packaging</h3>
    
            <p>
    In this example, we'll consider a EJB which is packaged in a myejb.jar which is within a myapp.ear. Here's how it would look like:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>myapp.ear
|
|---- myejb.jar
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|---- &lt;org.myapp.ejb.*&gt; // EJB classes</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    Note that packaging itself isn't really important in the context of this article. You can deploy the EJBs in any standard way (.ear, .war or .jar).            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Beans"  >
        <h3>Beans</h3>
    
            <p>
    In our example, we'll consider a simple stateless session bean which is as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>package org.myapp.ejb;

public interface Greeter {
&nbsp;&nbsp; &nbsp;
&nbsp;&nbsp;&nbsp; String greet(String user);
}</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>package org.myapp.ejb;

import javax.ejb.Remote;
import javax.ejb.Stateless;

@Stateless
@Remote (Greeter.class)
public class GreeterBean implements Greeter {

&nbsp;&nbsp;&nbsp; @Override
&nbsp;&nbsp;&nbsp; public String greet(String user) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return &quot;Hello &quot; + user + &quot;, have a pleasant day!&quot;;
&nbsp;&nbsp;&nbsp; }
}</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Security"  >
        <h3>Security</h3>
    
            <p>
    WildFly 8&nbsp;is secure by default. What this means is that no communication can happen with an WildFly&nbsp;instance from a remote client (irrespective of whether it is a standalone client or another server instance) without passing the appropriate credentials. Remember that in this example, our &quot;client server&quot; will be communicating with the &quot;destination server&quot;. So in order to allow this communication to happen successfully, we'll have to configure user credentials which we will be using during this communication. So let's start with the necessary configurations for this.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Configuringauseronthe%22DestinationServer%22"  >
        <h3>Configuring a user on the &quot;Destination Server&quot;</h3>
    
            <p>
    As a first step we'll configure a user on the destination server who will be allowed to access the destination server. We create the user using the <tt class=" ">add-user</tt> script that's available in the JBOSS_HOME/bin folder. In this example, we'll be configuring a <tt class=" ">Application User</tt> named <tt class=" ">ejb</tt> and with a password <tt class=" ">test</tt> in the <tt class=" ">ApplicationRealm</tt>. Running the <tt class=" ">add-user</tt> script is an interactive process and you will see questions/output as follows:            </p>
        <div class="confbox programlisting">
                    <div class="title">add-user</div>
                <div class="content">
        <pre><code>jpai@jpai-laptop:bin$ ./add-user.sh

What type of user do you wish to add?
&amp;nbsp;a) Management User (mgmt-users.properties)
&amp;nbsp;b) Application User (application-users.properties)
(a): b

Enter the details of the new user to add.
Realm (ApplicationRealm) :
Username : ejb
Password :
Re-enter Password :
What roles do you want this user to belong to? (Please enter a comma separated list, or leave blank for none)\[&amp;nbsp; \]:
About to add user 'ejb' for realm 'ApplicationRealm'
Is this correct yes/no? yes
Added user 'ejb' to file '/jboss-as-7.1.1.Final/standalone/configuration/application-users.properties'
Added user 'ejb' to file '/jboss-as-7.1.1.Final/domain/configuration/application-users.properties'
Added user 'ejb' with roles to file '/jboss-as-7.1.1.Final/standalone/configuration/application-roles.properties'
Added user 'ejb' with roles to file '/jboss-as-7.1.1.Final/domain/configuration/application-roles.properties'</code></pre>
        </div>
    </div>
            <p>
    As you can see in the output above we have now configured a user on the destination server who'll be allowed to access this server. We'll use this user credentials later on in the client server for communicating with this server. The important bits to remember are the user we have created in this example is <tt class=" ">ejb</tt> and the password&nbsp; is <tt class=" ">test.</tt>            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    Note that you can use any username and password combination you want to.            </p>
        </div>
    
    <div class="confbox admonition admonition-note">
        
            <p>
    You do <strong class=" ">not</strong> require the server to be started to add a user using the add-user script.            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Startthe%22DestinationServer%22"  >
        <h3>Start the &quot;Destination Server&quot;</h3>
    
            <p>
    As a next step towards running this example, we'll start the &quot;Destination Server&quot;. In this example, we'll use the standalone server and use the <i class=" ">standalone-full.xml</i> configuration. The startup command will look like:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./standalone.sh -server-config=standalone-full.xml</code></pre>
        </div>
    </div>
            <p>
    Ensure that the server has started without any errors.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    It's very important to note that if you are starting both the server instances on the same machine, then each of those server instances <strong class=" ">must</strong> have a unique <tt class=" ">jboss.node.name</tt> system property. You can do that by passing an appropriate value for <tt class=" ">-Djboss.node.name</tt> system property to the startup script:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./standalone.sh -server-config=standalone-full.xml -Djboss.node.name=&lt;add appropriate value here&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Deployingtheapplication"  >
        <h3>Deploying the application</h3>
    
            <p>
    The application (<i class=" ">myapp.ear</i> in our case) will be deployed to &quot;Destination Server&quot;. The process of deploying the application is out of scope of this chapter. You can either use the Command Line Interface or the Admin console or any IDE or manually copy it to JBOSS_HOME/standalone/deployments folder (for standalone server). Just ensure that the application has been deployed successfully.            </p>
                <p>
    So far, we have built a EJB application and deployed it on the &quot;Destination Server&quot;. Now let's move to the &quot;Client Server&quot; which acts as the client for the deployed EJBs on the &quot;Destination Server&quot;.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Configuringthe%22ClientServer%22topointtotheEJBremotingconnectoronthe%22DestinationServer%22"  >
        <h3>Configuring the &quot;Client Server&quot; to point to the EJB remoting connector on the &quot;Destination Server&quot;</h3>
    
            <p>
    As a first step on the &quot;Client Server&quot;, we need to let the server know about the &quot;Destination Server&quot;'s EJB remoting connector, over which it can communicate during the EJB invocations. To do that, we'll have to add a &quot;<i class=" ">remote-outbound-connection</i>&quot; to the remoting subsystem on the &quot;Client Server&quot;. The &quot;<i class=" ">remote-outbound-connection</i>&quot; configuration indicates that a outbound connection will be created to a remote server instance from that server. The &quot;<i class=" ">remote-outbound-connection</i>&quot; will be backed by a &quot;<i class=" ">outbound-socket-binding</i>&quot; which will point to a remote host and a remote port (of the &quot;Destination Server&quot;). So let's see how we create these configurations.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Startthe%22ClientServer%22"  >
        <h3>Start the &quot;Client Server&quot;</h3>
    
            <p>
    In this example, we'll start the &quot;Client Server&quot; on the same machine as the &quot;Destination Server&quot;. We have copied the entire server installation to a different folder and while starting the &quot;Client Server&quot; we'll use a port-offset (of 100 in this example) to avoid port conflicts:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>./standalone.sh -server-config=standalone-full.xml -Djboss.socket.binding.port-offset=100</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Createasecurityrealmontheclientserver"  >
        <h3>Create a security realm on the client server</h3>
    
            <p>
    Remember that we need to communicate with a secure destination server. In order to do that the client server has to pass the user credentials to the destination server. Earlier we created a user on the destination server who'll be allowed to communicate with that server. Now on the &quot;client server&quot; we'll create a security-realm which will be used to pass the user information.            </p>
                <p>
    In this example we'll use a security realm which stores a Base64 encoded password and then passes on that credentials when asked for. Earlier we created a user named <tt class=" ">ejb</tt> and password <tt class=" ">test</tt>. So our first task here would be to create the base64 encoded version of the password <tt class=" ">test</tt>. You can use any utility which generates you a base64 version for a string. I used <a href="http://www.base64encode.org/">this online site</a> which generates the base64 encoded string. So for the <tt class=" ">test</tt> password, the base64 encoded version is <tt class=" ">dGVzdA==</tt>            </p>
        <div class="confbox admonition admonition-tip">
        
            <p>
    While generating the base64 encoded string make sure that you don't have any trailing or leading spaces for the original password. That can lead to incorrect encoded versions being generated.            </p>
        </div>
    
    <div class="confbox admonition admonition-tip">
        
            <p>
    With new versions the add-user script will show the base64 password if you type 'y' if you've been ask            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Is this new user going to be used for one AS process to connect to another AS process e.g. slave domain controller?</code></pre>
        </div>
    </div>
    </div>
    
            <p>
    Now that we have generated that base64 encoded password, let's use in the in the security realm that we are going to configure on the &quot;client server&quot;. I'll first shutdown the client server and edit the standlaone-full.xml file to add the following in the <tt class=" ">&lt;management&gt;</tt> section            </p>
                <p>
    Now let's create a &quot;<i class=" ">security-realm</i>&quot; for the base64 encoded password.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>/core-service=management/security-realm=ejb-security-realm:add()
/core-service=management/security-realm=ejb-security-realm/server-identity=secret:add(value=dGVzdA==)</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    Notice that the CLI show the message <i class=" ">&quot;process-state&quot; =&gt; &quot;reload-required&quot;</i>, so you have to restart the server before you can use this change.            </p>
        </div>
    
            <p>
    upon successful invocation of this command, the following configuration will be created in the <i class=" ">management</i> section:            </p>
        <div class="confbox programlisting">
                    <div class="title">standalone-full.xml</div>
                <div class="content">
        <pre><code>&lt;management&gt;
        &lt;security-realms&gt;
            ...
            &lt;security-realm name=&quot;ejb-security-realm&quot;&gt;
                &lt;server-identities&gt;
                    &lt;secret value=&quot;dGVzdA==&quot;/&gt;
                &lt;/server-identities&gt;
            &lt;/security-realm&gt;
        &lt;/security-realms&gt;
...</code></pre>
        </div>
    </div>
            <p>
    As you can see I have created a security realm named &quot;ejb-security-realm&quot; (you can name it anything) with the base64 encoded password. So that completes the security realm configuration for the client server. Now let's move on to the next step.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Createaoutboundsocketbindingonthe%22ClientServer%22"  >
        <h3>Create a outbound-socket-binding on the &quot;Client Server&quot;</h3>
    
            <p>
    Let's first create a <i class=" ">outbound-socket-binding</i> which points the &quot;Destination Server&quot;'s host and port. We'll use the CLI to create this configuration:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=remote-ejb:add(host=localhost, port=8080)</code></pre>
        </div>
    </div>
            <p>
    The above command will create a outbound-socket-binding named &quot;<i class=" ">remote-ejb</i>&quot; (we can name it anything) which points to &quot;localhost&quot; as the host and port 8080 as the destination port. Note that the host information should match the host/IP of the &quot;Destination Server&quot; (in this example we are running on the same machine so we use &quot;localhost&quot;) and&nbsp; the port information should match the http-remoting connector port used by the EJB subsystem (by default it's 8080). When this command is run successfully, we'll see that the standalone-full.xml (the file which we used to start the server) was updated with the following outbound-socket-binding in the socket-binding-group:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;socket-binding-group name=&quot;standard-sockets&quot; default-interface=&quot;public&quot; port-offset=&quot;${jboss.socket.binding.port-offset:0}&quot;&gt;
        ...
        &lt;outbound-socket-binding name=&quot;remote-ejb&quot;&gt;
            &lt;remote-destination host=&quot;localhost&quot; port=&quot;8080&quot;/&gt;
        &lt;/outbound-socket-binding&gt;
    &lt;/socket-binding-group&gt;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Createa%22remoteoutboundconnection%22whichusesthisnewlycreated%22outboundsocketbinding%22"  >
        <h3>Create a &quot;remote-outbound-connection&quot; which uses this newly created &quot;outbound-socket-binding&quot;</h3>
    
            <p>
    Now let's create a &quot;<i class=" ">remote-outbound-connection</i>&quot; which will use the newly created outbound-socket-binding (pointing to the EJB remoting connector of the &quot;Destination Server&quot;). We'll continue to use the CLI to create this configuration:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>/subsystem=remoting/remote-outbound-connection=remote-ejb-connection:add(outbound-socket-binding-ref=remote-ejb, protocol=http-remoting, security-realm=ejb-security-realm, username=ejb)</code></pre>
        </div>
    </div>
            <p>
    The above command creates a remote-outbound-connection, named &quot;<i class=" ">remote-ejb-connection</i>&quot; (we can name it anything), in the remoting subsystem and uses the previously created &quot;<i class=" ">remote-ejb</i>&quot; outbound-socket-binding (notice the outbound-socket-binding-ref in that command) with the http-remoting protocol. Furthermore, we also set the security-realm attribute to point to the security-realm that we created in the previous step. Also notice that we have set the username attribute to use the user name who is allowed to communicate with the destination server.            </p>
                <p>
    What this step does is, it creates a outbound connection, on the client server, to the remote destination server and sets up the username to the user who allowed to communicate with that destination server and also sets up the security-realm to a pre-configured security-realm capable of passing along the user credentials (in this case the password). This way when a connection has to be established from the client server to the destination server, the connection creation logic will have the necessary security credentials to pass along and setup a successful secured connection.            </p>
                <p>
    Now let's run the following two operations to set some default connection creation options for the outbound connection:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>/subsystem=remoting/remote-outbound-connection=remote-ejb-connection/property=SASL_POLICY_NOANONYMOUS:add(value=false)</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>/subsystem=remoting/remote-outbound-connection=remote-ejb-connection/property=SSL_ENABLED:add(value=false)</code></pre>
        </div>
    </div>
            <p>
    Ultimately, upon successful invocation of this command, the following configuration will be created in the remoting subsystem:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:remoting:1.1&quot;&gt;
....
            &lt;outbound-connections&gt;
                &lt;remote-outbound-connection name=&quot;remote-ejb-connection&quot; outbound-socket-binding-ref=&quot;remote-ejb&quot; protocol=&quot;http-remoting&quot; security-realm=&quot;ejb-security-realm&quot; username=&quot;ejb&quot;&gt;
                    &lt;properties&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;SASL_POLICY_NOANONYMOUS&quot; value=&quot;false&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;SSL_ENABLED&quot; value=&quot;false&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/properties&gt;
                &lt;/remote-outbound-connection&gt;
            &lt;/outbound-connections&gt;
        &lt;/subsystem&gt;</code></pre>
        </div>
    </div>
            <p>
    From a server configuration point of view, that's all we need on the &quot;Client Server&quot;. Our next step is to deploy an application on the &quot;Client Server&quot; which will invoke on the bean deployed on the &quot;Destination Server&quot;.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Packagingtheclientapplicationonthe%22ClientServer%22"  >
        <h3>Packaging the client application on the &quot;Client Server&quot;</h3>
    
            <p>
    Like on the &quot;Destination Server&quot;, we'll use .ear packaging for the client application too. But like previously mentioned, that's not mandatory. You can even use a .war or .jar deployments. Here's how our client application packaging will look like:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>client-app.ear
|
|--- META-INF
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|--- jboss-ejb-client.xml
|
|--- web.war
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|--- WEB-INF/classes
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|
|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;|---- &lt;org.myapp.FooServlet&gt; // classes in the web app</code></pre>
        </div>
    </div>
            <p>
    In the client application we'll use a servlet which invokes on the bean deployed on the &quot;Destination Server&quot;. We can even invoke the bean on the &quot;Destination Server&quot; from a EJB on the &quot;Client Server&quot;. The code remains the same (JNDI lookup, followed by invocation on the proxy). The important part to notice in this client application is the file <i class=" ">jboss-ejb-client.xml</i> which is packaged in the META-INF folder of a top level deployment (in this case our client-app.ear). This <i class=" ">jboss-ejb-client.xml</i> contains the EJB client configurations which will be used during the EJB invocations for finding the appropriate destinations (also known as, EJB receivers). The contents of the jboss-ejb-client.xml are explained next.            </p>
        <div class="confbox admonition admonition-note">
        
            <p>
    If your application is deployed as a top level .war  deployment, then the jboss-ejb-client.xml is expected to be placed in  .war/WEB-INF/ folder (i.e. the same location where you place any web.xml  file).            </p>
        </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Contentsonjbossejbclient.xml"  >
        <h3>Contents on jboss-ejb-client.xml</h3>
    
            <p>
    The jboss-ejb-client.xml will look like:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;jboss-ejb-client xmlns=&quot;urn:jboss:ejb-client:1.0&quot;&gt;
    &lt;client-context&gt;
        &lt;ejb-receivers&gt;
            &lt;remoting-ejb-receiver outbound-connection-ref=&quot;remote-ejb-connection&quot;/&gt;
        &lt;/ejb-receivers&gt;
    &lt;/client-context&gt;
&lt;/jboss-ejb-client&gt;</code></pre>
        </div>
    </div>
            <p>
    You'll notice that we have configured the EJB client context (for this application) to use a remoting-ejb-receiver which points to our earlier created &quot;<i class=" ">remote-outbound-connection</i>&quot; named &quot;<i class=" ">remote-ejb-connection</i>&quot;. This links the EJB client context to use the &quot;<i class=" ">remote-ejb-connection</i>&quot; which ultimately points to the EJB remoting connector on the &quot;Destination Server&quot;.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Deploytheclientapplication"  >
        <h3>Deploy the client application</h3>
    
            <p>
    Let's deploy the client application on the &quot;Client Server&quot;. The process of deploying the application is out of scope, of this chapter. You can use either the CLI or the admin console or a IDE or deploy manually to JBOSS_HOME/standalone/deployments folder. Just ensure that the application is deployed successfully.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Clientcodeinvokingthebean"  >
        <h3>Client code invoking the bean</h3>
    
            <p>
    We mentioned that we'll be using a servlet to invoke on the bean, but the code to invoke the bean isn't servlet specific and can be used in other components (like EJB) too. So let's see how it looks like:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>import javax.naming.Context;
import java.util.Hashtable;
import javax.naming.InitialContext;

...
public void invokeOnBean() {
        try {
            final Hashtable props = new Hashtable();
            // setup the ejb: namespace URL factory
            props.put(Context.URL_PKG_PREFIXES, &quot;org.jboss.ejb.client.naming&quot;);
            // create the InitialContext
            final Context context = new javax.naming.InitialContext(props);

            // Lookup the Greeter bean using the ejb: namespace syntax which is explained here https://docs.jboss.org/author/display/AS71/EJB+invocations+from+a+remote+client+using+JNDI
            final Greeter bean = (Greeter) context.lookup(&quot;ejb:&quot; + &quot;myapp&quot; + &quot;/&quot; + &quot;myejb&quot; + &quot;/&quot; + &quot;&quot; + &quot;/&quot; + &quot;GreeterBean&quot; + &quot;!&quot; + org.myapp.ejb.Greeter.class.getName());

			// invoke on the bean
			final String greeting = bean.greet(&quot;Tom&quot;);

            System.out.println(&quot;Received greeting: &quot; + greeting);

        } catch (Exception e) {
            throw new RuntimeException(e);
        }
}</code></pre>
        </div>
    </div>
            <p>
    That's it! The above code will invoke on the bean deployed on the &quot;Destination Server&quot; and return the result.            </p>
        </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-RemoteEJBinvocationsviaJNDIWhichapproachtouse%3F"  >
        <h2>Remote EJB invocations via JNDI - Which approach to use?</h2>
    
<div class=" error">            <p>
    Couldn't find a page to include called: <a href="https://docs.jboss.org/author/pages/createpage.action?spaceKey=WFLY8&amp;title=Remote+EJB+invocations+via+JNDI+-+EJB+client+API+or+remote-naming+project%3F&amp;linkCreation=true&amp;fromPageId=66322748">Remote EJB invocations via JNDI - EJB client API or remote-naming project?</a>            </p>
    </div>    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-JBossEJB3referenceguide"  >
        <h2>JBoss EJB 3 reference guide</h2>
    
            <p>
    This chapter details the extensions that are available when developing Enterprise Java Beans <sup class=" ">tm</sup> on WildFly 8.            </p>
                <p>
    Currently there is no support for configuring the extensions using an implementation specific descriptor file.            </p>
        <div class="section-3"  id="66322748_DeveloperGuide-ResourceAdapterforMessageDrivenBeans"  >
        <h3>Resource Adapter for Message Driven Beans</h3>
    
            <p>
    Each Message Driven Bean must be connected to a resource adapter.            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-SpecificationofResourceAdapterusingMetadataAnnotations"  >
        <h4>Specification of Resource Adapter using Metadata Annotations</h4>
    
            <p>
    The <tt class=" ">ResourceAdapter</tt> annotation is used to specify the resource adapter with which the MDB should connect.            </p>
                <p>
    The <tt class=" ">value</tt> of the annotation is the name of the deployment unit containing the resource adapter. For example <tt class=" ">jms-ra.rar</tt>.            </p>
                <p>
    For example:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>@MessageDriven(messageListenerInterface = PostmanPat.class)
@ResourceAdapter(&quot;ejb3-rar.rar&quot;)</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-RunasPrincipal"  >
        <h3>as Principal</h3>
    
            <p>
    Whenever a run-as role is specified for a given method invocation the default anonymous principal is used as the caller principal. This principal can be overridden by specifying a run-as principal.            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-SpecificationofRunasPrincipalusingMetadataAnnotations"  >
        <h4>Specification of Run-as Principal using Metadata Annotations</h4>
    
            <p>
    The <tt class=" ">RunAsPrincipal</tt> annotation is used to specify the run-as principal to use for a given method invocation.            </p>
                <p>
    The <tt class=" ">value</tt> of the annotation specifies the name of the principal to use. The actual type of the principal is undefined and should not be relied upon.            </p>
                <p>
    Using this annotation without specifying a run-as role is considered an error.            </p>
                <p>
    For example:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>@RunAs(&quot;admin&quot;)
@RunAsPrincipal(&quot;MyBean&quot;)</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-SecurityDomain"  >
        <h3>Security Domain</h3>
    
            <p>
    Each Enterprise Java Bean <sup class=" ">tm</sup> can be associated with a security domain. Only when an EJB is associated with a security domain will authentication and authorization be enforced.            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-SpecificationofSecurityDomainusingMetadataAnnotations"  >
        <h4>Specification of Security Domain using Metadata Annotations</h4>
    
            <p>
    The <tt class=" ">SecurityDomain</tt> annotation is used to specify the security domain to associate with the EJB.            </p>
                <p>
    The <tt class=" ">value</tt> of the annotation is the name of the security domain to be used.            </p>
                <p>
    For example:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>@SecurityDomain(&quot;other&quot;)</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-TransactionTimeout"  >
        <h3>Transaction Timeout</h3>
    
            <p>
    For any newly started transaction a transaction timeout can be specified in seconds.            </p>
                <p>
    When a transaction timeout of <tt class=" ">0</tt> is used, then the actual transaction timeout will default to the domain configured default.<br/><i class=" ">TODO: add link to tx subsystem</i>            </p>
                <p>
    Although this is only applicable when using transaction attribute <tt class=" ">REQUIRED</tt> or <tt class=" ">REQUIRES_NEW</tt> the application server will not detect invalid setups.            </p>
        <div class="confbox admonition admonition-note">
            <div class="title">New Transactions</div>
        
            <p>
    Take care that even when transaction attribute <tt class=" ">REQUIRED</tt> is specified, the timeout will only be applicable if a <strong class=" ">new</strong> transaction is started.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-SpecificationofTransactionTimeoutwithMetadataAnnotations"  >
        <h4>Specification of Transaction Timeout with Metadata Annotations</h4>
    
            <p>
    The <tt class=" ">TransactionTimeout</tt> annotation is used to specify the transaction timeout for a given method.            </p>
                <p>
    The <tt class=" ">value</tt> of the annotation is the timeout used in the given <tt class=" ">unit</tt> granularity. It must be a positive integer or 0. Whenever 0 is specified the default domain configured timeout is used.            </p>
                <p>
    The <tt class=" ">unit</tt> specifies the granularity of the <tt class=" ">value</tt>. The actual value used is converted to seconds. Specifying a granularity lower than <tt class=" ">SECONDS</tt> is considered an error, even when the computed value will result in an even amount of seconds.            </p>
                <p>
    For example:@TransactionTimeout(value = 10, unit = TimeUnit.SECONDS)            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-SpecificationofTransactionTimeoutintheDeploymentDescriptor"  >
        <h4>Specification of Transaction Timeout in the Deployment Descriptor</h4>
    
            <p>
    The <tt class=" ">trans-timeout</tt> element is used to define the transaction  timeout for business, home, component, and message-listener interface  methods; no-interface view methods; web service endpoint methods; and  timeout callback methods.            </p>
                <p>
    The <tt class=" ">trans-timeout</tt> element resides in the <tt class=" ">urn:trans-timeout</tt> namespace and is part of the standard <tt class=" ">container-transaction</tt> element as defined in the jboss namespace.            </p>
                <p>
    For the rules when a <tt class=" ">container-transaction</tt> is applicable please refer to EJB 3.1 FR 13.3.7.2.1.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-Exampleof%7B%7Btranstimeout%7D%7D"  >
        <h5>Example of  trans-timeout</h5>
    
    <div class="confbox programlisting">
                    <div class="title">jboss-ejb3.xml</div>
                <div class="content">
        <pre><code>&lt;jboss:ejb-jar xmlns:jboss=&quot;http://www.jboss.com/xml/ns/javaee&quot;
               xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
               xmlns:tx=&quot;urn:trans-timeout&quot;
               xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
               xsi:schemaLocation=&quot;http://www.jboss.com/xml/ns/javaee http://www.jboss.org/j2ee/schema/jboss-ejb3-2_0.xsd
http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd
urn:trans-timeout http://www.jboss.org/j2ee/schema/trans-timeout-1_0.xsd&quot;
               version=&quot;3.1&quot;
               impl-version=&quot;2.0&quot;&gt;
    &lt;assembly-descriptor&gt;
        &lt;container-transaction&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;BeanWithTimeoutValue&lt;/ejb-name&gt;
                &lt;method-name&gt;*&lt;/method-name&gt;
                &lt;method-intf&gt;Local&lt;/method-intf&gt;
            &lt;/method&gt;
            &lt;tx:trans-timeout&gt;
                &lt;tx:timeout&gt;10&lt;/tx:timeout&gt;
                &lt;tx:unit&gt;Seconds&lt;/tx:unit&gt;
            &lt;/tx:trans-timeout&gt;
        &lt;/container-transaction&gt;
    &lt;/assembly-descriptor&gt;
&lt;/jboss:ejb-jar&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Timerservice"  >
        <h3>Timer service</h3>
    
            <p>
    The service is responsible to call the registered timeout methods of the different session beans.            </p>
        <div class="confbox admonition admonition-info">
        
            <p>
    A persistent timer will be identified by the name of the EAR, the name of the sub-deployment JAR and the Bean's name.<br/>If one of those names are changed (e.g. EAR name contain a version) the timer entry became orphaned and the timer event will not longer be fired.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Singleeventtimer"  >
        <h4>Single event timer</h4>
    
            <p>
    The timer is will be started once at the specified time.            </p>
                <p>
    In case of a server restart the timeout method of a persistent timer will only be called directly if the specified time is elapsed.<br/>If the timer is not persistent (since EJB3.1 see 18.2.3) it will be not longer available if JBoss is restarted or the application is redeployed.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Recurringtimer"  >
        <h4>Recurring timer</h4>
    
            <p>
    The timer will be started at the specified first occurrence and after that point at each time if the interval is elapsed.<br/>If the timer will be started during the last execution is not finished the execution will be suppressed with a warning to avoid concurrent execution.            </p>
                <p>
    In case of server downtime for a persistent timer, the timeout method will be called only once if one, or more than one, interval is elapsed.<br/>If the timer is not persistent (since EJB3.1 see 18.2.3) it will not longer be active after the server is restarted or the application is redeployed.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Calendartimer"  >
        <h4>Calendar timer</h4>
    
            <p>
    The timer will be started if the schedule expression match. It will be automatically deactivated and removed if there will be no next expiration possible, i.e. If you set a specific year.            </p>
                <p>
    For example:            </p>
        <blockquote>
            <p>
    @Schedule( ... dayOfMonth=&quot;1&quot;, month=&quot;1&quot;, year=&quot;2012&quot;)<br/>// start once at 01-01-2012 00:00:00            </p>
            </blockquote>
    <div class="section-5"  id="66322748_DeveloperGuide-Programmaticcalendartimer"  >
        <h5>Programmatic calendar timer</h5>
    
            <p>
    If the timer is persistent it will be fetched at server start and the missed timeouts are called concurrent.<br/>If a persistent timer contains an end date it will be executed once nevertheless how many times the execution was missed. Also a retry will be suppressed if the timeout method throw an Exception.<br/>In case of such expired timer access to the given Timer object might throw a NoMoreTimeoutExcption or NoSuchObjectException.            </p>
                <p>
    If the timer is non persistent it will not longer be active after the server is restarted or the application is redeployed.            </p>
                <p>
    <strong class=" ">TODO</strong>: clarify whether this should happen concurrently/blocked or even fired only once like a recurring timer!            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Annotatedcalendartimer"  >
        <h5>Annotated calendar timer</h5>
    
            <p>
    If the timer is non persistent it will not activated for missed events during the server is down. In case of server start the timer is scheduled based on the @Schedule annotation.            </p>
                <p>
    If the timer is persistent (default if not deactivated by annotation) all missed events are fetched at server start and the annotated timeout method is called concurrent.            </p>
                <p>
    <strong class=" ">TODO</strong>: clarify whether this should happen concurrently/blocked or even fired only once like a recurring timer!            </p>
        </div>
    
    </div>
    
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-JPAreferenceguide"  >
        <h2>JPA reference guide</h2>
    
<ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Introduction">Introduction</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UpdateyourPersistence.xmlforHibernate4.3.0">Update your Persistence.xml for Hibernate 4.3.0</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Entitymanager">Entity manager</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Applicationmanagedentitymanager">Application-managed entity manager</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Containermanagedentitymanager">Container-managed entity manager</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PersistenceContext">Persistence Context</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-TransactionscopedPersistenceContext">Transaction-scoped Persistence Context</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ExtendedPersistenceContext">Extended Persistence Context</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ExtendedPersistenceContextInheritance">Extended Persistence Context Inheritance</a>            </p>
    </li></ul></li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Entities">Entities</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Deployment">Deployment</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Troubleshooting">Troubleshooting</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-BackgroundontheJipijapaproject">Background on the Jipijapa project</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PackagingpersistenceproviderswithyourapplicationandwhichJipijapaartifactstoinclude">Packaging persistence providers with your application and which Jipijapa artifacts to include</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingtheHibernate4.3.xJPApersistenceprovider">Using the Hibernate 4.3.x JPA persistence provider</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingtheInfinispansecondlevelcache">Using the Infinispan second level cache</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-ReplacingthecurrentHibernate4.3.xjarswithanewerversion">Replacing the current Hibernate 4.3.x jars with a newer version</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PackagingtheHibernate3.5orgreater3.xJPApersistenceproviderwithyourapplication">Packaging the Hibernate 3.5 or greater 3.x JPA persistence provider with your application</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-SharingtheHibernate3.5orgreaterJPApersistenceproviderbetweenmultipleapplications">Sharing the Hibernate 3.5 or greater JPA persistence provider between multiple applications</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingOpenJPA">Using OpenJPA</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingEclipseLink">Using EclipseLink</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingDataNucleus">Using DataNucleus</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-UsingHibernateOGM">Using Hibernate OGM</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-NativeHibernateuse">Native Hibernate use</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-InjectionofHibernateSessionandSessionFactoryInjectionofHibernateSessionandSessionFactory">Injection of Hibernate Session and SessionFactoryInjection of Hibernate Session and SessionFactory</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Hibernateproperties">Hibernate properties</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Persistenceunitproperties">Persistence unit properties</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Determinethepersistenceprovidermodule">Determine the persistence provider module</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-BindingEntityManagerFactory%2FEntityManagertoJNDI">Binding EntityManagerFactory/EntityManager to JNDI</a>            </p>
    </li><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-Community">Community</a>            </p>
    <ul class=" "><li class=" ">            <p>
    <a href="66322748.html#66322748_DeveloperGuide-PeoplewhohavecontributedtotheWildFlyJPAlayer%3A">People who have contributed to the WildFly JPA layer:</a>            </p>
    </li></ul></li></ul>    <div class="section-3"  id="66322748_DeveloperGuide-Introduction"  >
        <h3>Introduction</h3>
    
            <p>
    The WildFly 8&nbsp;JPA subsystem implements the JPA 2.0 container-managed requirements. Deploys the persistence unit definitions, the persistence unit/context annotations and persistence unit/context references in the deployment descriptor. JPA Applications use the Hibernate (core) 4.0 persistence provider, that is included with WildFly. The JPA subsystem uses the standard SPI (javax.persistence.spi.PersistenceProvider) to access the Hibernate persistence provider and some additional extensions as well.            </p>
                <p>
    During application deployment, JPA use is detected (e.g. persistence.xml or @PersistenceContext/Unit annotations) and injects Hibernate dependencies into the application deployment. This makes it easy to deploy JPA applications.            </p>
                <p>
    In the remainder of this documentation, &rdquo;entity manager&rdquo; refers to an instance of the <i class=" ">javax.persistence.EntityManager</i> class. <a href="http://download.oracle.com/javaee/6/api/javax/persistence/package-summary.html">Javadoc for the JPA interfaces </a><a href="http://download.oracle.com/javaee/6/api/javax/persistence/package-summary.html">http://download.oracle.com/javaee/6/api/javax/persistence/package-summary.html</a> and <a href="http://jcp.org/aboutJava/communityprocess/pfd/jsr317/index.html">JPA 2.0 specification.</a> <a href="http://docs.jboss.org/hibernate/core/4.0/">The index of </a><a href="http://docs.jboss.org/hibernate/core/4.0/">Hibernate documentation</a><a href="http://docs.jboss.org/hibernate/core/4.0/">is here</a>.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UpdateyourPersistence.xmlforHibernate4.3.0"  >
        <h3>Update your Persistence.xml for Hibernate 4.3.0</h3>
    
            <p>
    The persistence provider class name in Hibernate 4.3.0 is <strong class=" ">org.hibernate.jpa.HibernatePersistenceProvider</strong>.            </p>
                <p>
    Instead of specifying:            </p>
                <p>
    <strong class=" ">&lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;</strong>            </p>
                <p>
    Switch to*:*            </p>
                <p>
    <strong class=" ">&lt;provider&gt;org.hibernate.jpa.HibernatePersistenceProvider&lt;/provider&gt;</strong>            </p>
                <p>
    Or remove the persistence provider class name from your persistence.xml (so the default provider will be used).            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Entitymanager"  >
        <h3>Entity manager</h3>
    
            <p>
    The entity manager is similar to the Hibernate Session class; applications use it to create/read/update/delete data (and related operations). Applications can use application-managed or container-managed entity managers. Keep in mind that the entity manager is not expected to be thread safe (don't inject it into a servlet class variable which is visible to multiple threads).            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Applicationmanagedentitymanager"  >
        <h3>Application-managed entity manager</h3>
    
            <p>
    Application-managed entity managers provide direct access to the underlying persistence provider (org.hibernate.ejb.HibernatePersistence). The scope of the application-managed entity manager is from when the application creates it and lasts until the app closes it. Use the <i class=" ">@PersistenceUnit</i> annotation to inject a persistence unit into a <i class=" ">javax.persistence.EntityManagerFactory</i>. The EntityManagerFactory can return an application-managed entity manager.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Containermanagedentitymanager"  >
        <h3>Container-managed entity manager</h3>
    
            <p>
    Container-managed entity managers auto-magically manage the underlying persistence provider for the application. Container-managed entity managers may use transaction-scoped persistence contexts or extended persistence contexts. The container-managed entity manager will create instances of the underlying persistence provider as needed. Every time that a new underlying persistence provider (<i class=" ">org.hibernate.ejb.HibernatePersistence</i>) instance is created, a new persistence context is also created (as an implementation detail of the underlying persistence provider).            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-PersistenceContext"  >
        <h3>Persistence Context</h3>
    
            <p>
    The JPA persistence context contains the entities managed by the persistence provider. The persistence context acts like a first level (transactional) cache for interacting with the datasource. Loaded entities are placed into the persistence context before being returned to the application. Entities changes are also placed into the persistence context (to be saved in the database when the transaction commits).            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-TransactionscopedPersistenceContext"  >
        <h3>Transaction-scoped Persistence Context</h3>
    
            <p>
    The transaction-scoped persistence context coordinates with the (active) JTA transaction.&nbsp; When the transaction commits, the persistence context is flushed to the datasource (entity objects are detached but may still be referenced by application code).&nbsp; All entity changes that are expected to be saved to the datasource, must be made during a transaction.&nbsp; Entities read outside of a transaction will be detached when the entity manager invocation completes.&nbsp; Example transaction-scoped persistence context is below.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>@Stateful  // will use container managed transactions
public class CustomerManager {
  @PersistenceContext(unitName = &quot;customerPU&quot;) // default type is PersistenceContextType.TRANSACTION
  EntityManager em;
  public customer createCustomer(String name, String address) {
    Customer customer = new Customer(name, address);
    em.persist(customer);  // persist new Customer when JTA transaction completes (when method ends).
                           // internally:
                           //    1. Look for existing &quot;customerPU&quot; persistence context in active JTA transaction and use if found.
                           //    2. Else create new &quot;customerPU&quot; persistence context (e.g. instance of org.hibernate.ejb.HibernatePersistence)
                           //       and put in current active JTA transaction.
    return customer;       // return Customer entity (will be detached from the persistence context when caller gets control)
  }  // Transaction.commit will be called, Customer entity will be persisted to the database and &quot;customerPU&quot; persistence context closed</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ExtendedPersistenceContext"  >
        <h3>Extended Persistence Context</h3>
    
            <p>
    The (ee container managed) extended persistence context can span multiple transactions and allows data modifications to be queued up (like a shopping cart), without an active JTA transaction (to be applied during the next JTA TX). The Container-managed extended persistence context can only be injected into a stateful session bean.&nbsp;            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>@PersistenceContext(type = PersistenceContextType.EXTENDED, unitName = &quot;inventoryPU&quot;)
EntityManager em;</code></pre>
        </div>
    </div>
    <div class="section-4"  id="66322748_DeveloperGuide-ExtendedPersistenceContextInheritance"  >
        <h4>Extended Persistence Context Inheritance</h4>
    
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>JPA 2.0 specification section 7.6.2.1

If a stateful session bean instantiates a stateful session bean (executing in the same EJB container instance) which also has such an extended persistence context, the extended persistence context of the first stateful session bean is inherited by the second stateful session bean and bound to it, and this rule recursively applies&mdash;independently of whether transactions are active or not at the point of the creation of the stateful session beans.</code></pre>
        </div>
    </div>
            <p>
    By default, the current stateful session bean being created, will (<strong class=" ">deeply</strong>) inherit the extended persistence context from any stateful session bean executing in the current Java thread.&nbsp; The <strong class=" ">deep</strong> inheritance of extended persistence context includes walking multiple levels up the stateful bean call stack (inheriting from parent beans).&nbsp; The <strong class=" ">deep</strong> inheritance of extended persistence context includes sibling beans.&nbsp; For example, parentA references child beans beanBwithXPC &amp;&nbsp; beanCwithXPC.&nbsp; Even though parentA doesn't have an extended persistence context, beanBwithXPC &amp; beanCwithXPC will share the same extended persistence context.&nbsp;            </p>
                <p>
    Some other EE application servers, use <strong class=" ">shallow</strong> inheritance, where stateful session bean only inherit from the parent stateful session bean (if there is a parent bean).&nbsp; Sibling beans do not share the same extended persistence context unless their (common) parent bean also has the same extended persistence context.            </p>
                <p>
    Applications can include a (top-level) <strong class=" ">jboss-all.xml</strong> deployment descriptor that specifies either the (default) <strong class=" ">DEEP</strong> extended persistence context inheritance or <strong class=" ">SHALLOW</strong>.            </p>
                <p>
    The AS/docs/schema/jboss-jpa_1_0.xsd describes the <strong class=" ">jboss-jpa</strong> deployment descriptor that may be included in the <strong class=" ">jboss-all.xml</strong>.&nbsp; Below is an example of using <strong class=" ">SHALLOW</strong> extended persistence context inheritance:            </p>
        <blockquote>
            <p>
    &lt;jboss&gt;<br/>&nbsp;&nbsp;&nbsp; &lt;jboss-jpa xmlns=&quot;http://www.jboss.com/xml/ns/javaee&quot;&gt;<br/>&nbsp;&nbsp;&nbsp; &lt;extended-persistence inheritance=&quot;SHALLOW&quot;/&gt;<br/>&nbsp; &nbsp; &lt;/jboss-jpa&gt;<br/>&lt;/jboss&gt;&nbsp;            </p>
            </blockquote>
            <p>
    Below is an example of using <strong class=" ">DEEP</strong> extended persistence inheritance:            </p>
        <blockquote>
            <p>
    &lt;jboss&gt;<br/>&nbsp;&nbsp;&nbsp; &lt;jboss-jpa xmlns=&quot;http://www.jboss.com/xml/ns/javaee&quot;&gt;<br/>&nbsp;&nbsp;&nbsp; &lt;extended-persistence inheritance=&quot;DEEP&quot;/&gt;<br/>&nbsp;&nbsp;&nbsp; &lt;/jboss-jpa&gt;<br/>&lt;/jboss&gt;            </p>
            </blockquote>
            <p>
    The AS console/cli can change the <strong class=" ">default</strong> extended persistence context setting (DEEP or SHALLOW).&nbsp; The following cli commands will read the current JPA settings and enable SHALLOW extended persistence context inheritance for applications that do not include the <strong class=" ">jboss-jpa</strong> deployment descriptor:            </p>
        <blockquote>
            <p>
    ./jboss-cli.sh<br/>cd subsystem=jpa<br/>:read-resource<br/>:write-attribute(name=default-extended-persistence-inheritance,value=&quot;SHALLOW&quot;)            </p>
            </blockquote>
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Entities"  >
        <h3>Entities</h3>
    
            <p>
    JPA 2.0 makes it easy to use your (pojo) plain old Java class to represent a database table row.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>@PersistenceContext EntityManager em;
Integer bomPk = getIndexKeyValue();
BillOfMaterials bom = em.find(BillOfMaterials.class, bomPk); // read existing table row into BillOfMaterials class

BillOfMaterials createdBom = new BillOfMaterials(&quot;...&quot;);     // create new entity
em.persist(createdBom);  // createdBom is now managed and will be saved to database when the current JTA transaction completes</code></pre>
        </div>
    </div>
            <p>
    The entity lifecycle is managed by the underlying persistence provider.            </p>
    <ul class=" "><li class=" ">            <p>
    New (transient): an entity is new if it has just been instantiated using the new operator, and it is not associated with a persistence context. It has no persistent representation in the database and no identifier value has been assigned.            </p>
    </li><li class=" ">            <p>
    Managed (persistent): a managed entity instance is an instance with a persistent identity that is currently associated with a persistence context.            </p>
    </li><li class=" ">            <p>
    Detached: the entity instance is an instance with a persistent identity that is no longer associated with a persistence context, usually because the persistence context was closed or the instance was evicted from the context.            </p>
    </li><li class=" ">            <p>
    Removed: a removed entity instance is an instance with a persistent identity, associated with a persistence context, but scheduled for removal from the database.            </p>
    </li></ul>    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Deployment"  >
        <h3>Deployment</h3>
    
            <p>
    The persistence.xml contains the persistence unit configuration (e.g. datasource name) and as described in the JPA 2.0 spec (section 8.2), the jar file or directory whose META-INF directory contains the persistence.xml file is termed the root of the persistence unit. In Java EE environments, the root of a persistence unit must be one of the following (quoted directly from the JPA 2.0 specification):            </p>
                <p>
    &quot;            </p>
    <ul class=" "><li class=" ">            <p>
    an EJB-JAR file            </p>
    </li><li class=" ">            <p>
    the WEB-INF/classes directory of a WAR file            </p>
    </li><li class=" ">            <p>
    a jar file in the WEB-INF/lib directory of a WAR file            </p>
    </li><li class=" ">            <p>
    a jar file in the EAR library directory            </p>
    </li><li class=" ">            <p>
    an application client jar file            </p>
    </li></ul>            <p>
    The persistence.xml can specify either a JTA datasource or a non-JTA datasource. The JTA datasource is expected to be used within the EE environment (even when reading data without an active transaction). If a datasource is not specified, the default-datasource will instead be used (must be configured).            </p>
                <p>
    NOTE: Java Persistence 1.0 supported use of a jar file in the root of the EAR as the root of a persistence unit. This use is no longer supported. Portable applications should use the EAR library directory for this case instead.            </p>
                <p>
    &quot;            </p>
                <p>
    Question: Can you have a EAR/META-INF/persistence.xml?            </p>
                <p>
    Answer: No, the above may deploy but it could include other archives also in the EAR, so you may have deployment issues for other reasons.&nbsp; Better to put the persistence.xml in an EAR/lib/somePuJar.jar.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Troubleshooting"  >
        <h3>Troubleshooting</h3>
    
            <p>
    The <strong class=" ">org.jboss.as.jpa</strong> logging can be enabled to get the following information:            </p>
    <ul class=" "><li class=" ">            <p>
    INFO - when persistence.xml has been parsed, starting of persistence unit service (per deployed persistence.xml), stopping of persistence unit service            </p>
    </li><li class=" ">            <p>
    DEBUG - informs about entity managers being injected, creating/reusing transaction scoped entity manager for active transaction            </p>
    </li><li class=" ">            <p>
    TRACE - shows how long each entity manager operation took in milliseconds, application searches for a persistence unit, parsing of persistence.xml            </p>
    </li></ul>            <p>
    To enable TRACE, open the as/standalone/configuration/standalone.xml (or as/domain/configuration/domain.xml) file. Search for <strong class=" ">&lt;subsystem xmlns=&quot;urn:jboss:domain:logging:1.0&quot;&gt;</strong> and add the <strong class=" ">org.jboss.as.jpa</strong> category.&nbsp; You need to change the console-handler level from <strong class=" ">INFO</strong> to <strong class=" ">TRACE</strong>.&nbsp;            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:logging:1.0&quot;&gt;
     &lt;console-handler name=&quot;CONSOLE&quot;&gt;
      &lt;level name=&quot;TRACE&quot; /&gt;
    &nbsp; ...
     &lt;/console-handler&gt;

     &lt;/periodic-rotating-file-handler&gt;
     &lt;logger category=&quot;com.arjuna&quot;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;    &lt;level name=&quot;WARN&quot; /&gt;
 &nbsp;&nbsp;&nbsp; &lt;/logger&gt;

     &lt;logger category=&quot;org.jboss.as.jpa&quot;&gt;
   &nbsp;&nbsp;&nbsp;&nbsp; &lt;level name=&quot;TRACE&quot; /&gt;
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/logger&gt;

     &lt;logger category=&quot;org.apache.tomcat.util.modeler&quot;&gt;
   &nbsp;&nbsp;&nbsp;&nbsp; &lt;level name=&quot;WARN&quot; /&gt;
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/logger&gt;
     ...</code></pre>
        </div>
    </div>
            <p>
    To see what is going on at the JDBC level,  enable <strong class=" ">jboss.jdbc.spy</strong> TRACE and add spy=&quot;true&quot; to the datasource.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;datasource jndi-name=&quot;java:jboss/datasources/...&quot; pool-name=&quot;...&quot; enabled=&quot;true&quot; spy=&quot;true&quot;&gt;
&lt;logger category=&quot;jboss.jdbc.spy&quot;&gt;
&nbsp; &lt;level name=&quot;TRACE&quot;/&gt;
&lt;/logger&gt;</code></pre>
        </div>
    </div>
            <p>
    To troubleshoot issues with the Hibernate second level cache, try enabling trace for <strong class=" ">org.hibernate.SQL + org.hibernate.cache.infinispan + org.infinispan:</strong>            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:logging:1.0&quot;&gt;
     &lt;console-handler name=&quot;CONSOLE&quot;&gt;
      &lt;level name=&quot;TRACE&quot; /&gt;
    &nbsp; ...
     &lt;/console-handler&gt;

     &lt;/periodic-rotating-file-handler&gt;
     &lt;logger category=&quot;com.arjuna&quot;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;    &lt;level name=&quot;WARN&quot; /&gt;
 &nbsp;&nbsp;&nbsp; &lt;/logger&gt;

     &lt;logger category=&quot;org.hibernate.SQL&quot;&gt;
   &nbsp;&nbsp;&nbsp;&nbsp; &lt;level name=&quot;TRACE&quot; /&gt;
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/logger&gt;

     &lt;logger category=&quot;org.hibernate&quot;&gt;
   &nbsp;&nbsp;&nbsp;&nbsp; &lt;level name=&quot;TRACE&quot; /&gt;
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/logger&gt;
&nbsp;     &lt;logger category=&quot;org.infinispan&quot;&gt;
   &nbsp;&nbsp;&nbsp;&nbsp; &lt;level name=&quot;TRACE&quot; /&gt;
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/logger&gt;

     &lt;logger category=&quot;org.apache.tomcat.util.modeler&quot;&gt;
   &nbsp;&nbsp;&nbsp;&nbsp; &lt;level name=&quot;WARN&quot; /&gt;
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/logger&gt;
     ...</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-BackgroundontheJipijapaproject"  >
        <h3>Background on the Jipijapa project</h3>
    
            <p>
    The <a href="https://github.com/jipijapa/jipijapa">Jipijapa</a> project goal is to improve application platform integration with JPA persistence providers.&nbsp; Jipijapa provides additional integration that makes it easier to use various persistence providers.&nbsp; For example, look <a href="https://github.com/jipijapa/jipijapa/blob/master/hibernate4_3/src/main/java/org/jboss/as/jpa/hibernate4/HibernatePersistenceProviderAdaptor.java#L85">here at how the Hibernate environment</a> is setup automatically (so that JPA deployments can just work).&nbsp; Also, application persistence unit definitions (persistence.xml) can override most settings.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-PackagingpersistenceproviderswithyourapplicationandwhichJipijapaartifactstoinclude"  >
        <h3>Packaging persistence providers with your application and which Jipijapa artifacts to include</h3>
    
            <p>
    Applications that include a copy of a persistence provider, should include one of the following Jipijapa integration jars, so that WildFly can easily deploy your application.&nbsp; The alternative to including persistence providers with your application, is to instead use the persistence provider as a static module (each of the below providers already have a placeholder static module that you can copy provider jars into).            </p>
        <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Persistence Provider            </td>
                <td rowspan="1" colspan="1">
    WildFly Version            </td>
                <td rowspan="1" colspan="1">
    Group ID            </td>
                <td rowspan="1" colspan="1">
    Artifact ID            </td>
                <td rowspan="1" colspan="1">
    Version            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Hibernate ORM 4.3.x            </td>
                <td rowspan="1" colspan="1">
    8.1.0.Final            </td>
                <td rowspan="1" colspan="1">
    org.jipijapa            </td>
                <td rowspan="1" colspan="1">
    jipijapa-hibernate4-3            </td>
                <td rowspan="1" colspan="1">
    1.1.0.Final            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    Hibernate ORM 4.0.x, 4.1.x, 4.2.x            </td>
                <td rowspan="1" colspan="1">
    8.1.0.Final            </td>
                <td rowspan="1" colspan="1">
    org.jipijapa            </td>
                <td rowspan="1" colspan="1">
    jipijapa-hibernate4-1            </td>
                <td rowspan="1" colspan="1">
    1.1.0.Final            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    Hibernate ORM version 3.x            </td>
                <td rowspan="1" colspan="1">
    8.1.0.Final            </td>
                <td rowspan="1" colspan="1">
    org.jipijapa            </td>
                <td rowspan="1" colspan="1">
    jipijapa-hibernate3            </td>
                <td rowspan="1" colspan="1">
    1.1.0.Final            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    EclipseLink            </td>
                <td rowspan="1" colspan="1">
    8.1.0.Final            </td>
                <td rowspan="1" colspan="1">
    org.jipijapa            </td>
                <td rowspan="1" colspan="1">
    jipijapa-eclipselink            </td>
                <td rowspan="1" colspan="1">
    1.1.0.Final            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    OpenJPA            </td>
                <td rowspan="1" colspan="1">
    8.1.0.Final            </td>
                <td rowspan="1" colspan="1">
    org.jipijapa            </td>
                <td rowspan="1" colspan="1">
    jipijapa-openjpa            </td>
                <td rowspan="1" colspan="1">
    1.1.0.Final            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UsingtheHibernate4.3.xJPApersistenceprovider"  >
        <h3>Using the Hibernate 4.3.x JPA persistence provider</h3>
    
            <p>
    Hibernate 4.3.x is packaged with WildFly&nbsp;and is the default persistence provider.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UsingtheInfinispansecondlevelcache"  >
        <h3>Using the Infinispan second level cache</h3>
    
            <p>
    To enable the second level cache with Hibernate 4, just set the <strong class=" ">hibernate.cache.use_second_level_cache</strong> property to true, as is done in the following example (also set the <a href="http://docs.oracle.com/javaee/6/api/javax/persistence/SharedCacheMode.html">shared-cache-mode</a> accordingly). By default the application server uses Infinispan as the cache provider for <strong class=" ">JPA applications</strong>, so you don't need specify anything on top of that:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;persistence xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot; version=&quot;1.0&quot;&gt;
&lt;persistence-unit name=&quot;2lc_example_pu&quot;&gt;
   &lt;description&gt;example of enabling the second level cache.&lt;/description&gt;
   &lt;jta-data-source&gt;java:jboss/datasources/mydatasource&lt;/jta-data-source&gt;
   &lt;shared-cache-mode&gt;ENABLE_SELECTIVE&lt;/shared-cache-mode&gt;
   &lt;properties&gt;
      &lt;property name=&quot;hibernate.cache.use_second_level_cache&quot; value=&quot;true&quot;/&gt;
   &lt;/properties&gt;
&lt;/persistence-unit&gt;
&lt;/persistence&gt;</code></pre>
        </div>
    </div>
            <p>
    Here is an example of enabling the second level cache for a Hibernate native API hibernate.cfg.xml file:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;property name=&quot;hibernate.cache.region.factory_class&quot; value=&quot;org.jboss.as.jpa.hibernate4.infinispan.InfinispanRegionFactory&quot;/&gt;
&lt;property name=&quot;hibernate.cache.infinispan.cachemanager&quot; value=&quot;java:jboss/infinispan/container/hibernate&quot;/&gt;
&lt;property name=&quot;hibernate.transaction.manager_lookup_class&quot; value=&quot;org.hibernate.transaction.JBossTransactionManagerLookup&quot;/&gt;
&lt;property name=&quot;hibernate.cache.use_second_level_cache&quot; value=&quot;true&quot;/&gt;</code></pre>
        </div>
    </div>
            <p>
    The Hibernate native API application will also need a MANIFEST.MF:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Dependencies: org.infinispan,org.hibernate</code></pre>
        </div>
    </div>
            <p>
    <a href="https://docs.jboss.org/author/display/ISPN/Using+Infinispan+as+JPA-Hibernate+Second+Level+Cache+Provider">Infinispan Hibernate/JPA second level cache provider documentation</a> contains advanced configuration information but you should bear in mind  that when Hibernate runs within WildFly 8, some of  those configuration options, such as region factory, are not needed.  Moreover, the application server providers you with option of selecting a  different cache container for Infinispan via <strong class=" ">hibernate.cache.infinispan.container</strong> persistence property. To reiterate, this property is not mandatory and a  default container is already deployed for by the application server to  host the second level cache.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-ReplacingthecurrentHibernate4.3.xjarswithanewerversion"  >
        <h3>Replacing the current Hibernate 4.3.x jars with a newer version</h3>
    
            <p>
    Just update the current wildfly/modules/system/layers/base/org/hibernate/main folder to contain the newer version (after stopping your WildFly server instance).&nbsp;            </p>
    <ol class=" "><li class=" ">            <p>
    Delete *.index files in wildfly/modules/system/layers/base/org/hibernate/main and wildfly/modules/system/layers/base/org/hibernate/envers/main folders.            </p>
    </li><li class=" ">            <p>
    Backup the current contents of wildfly/modules/system/layers/base/org/hibernate in case you make a mistake.            </p>
    </li><li class=" ">            <p>
    Remove the older jars and copy new Hibernate jars into wildfly/modules/system/layers/base/org/hibernate/main + wildfly/modules/system/layers/base/org/hibernate/envers/main.            </p>
    </li><li class=" ">            <p>
    Update the wildfly/modules/system/layers/base/org/hibernate/main/module.xml + wildfly/modules/system/layers/base/org/hibernate/envers/main/module.xml to name the jars that you copied in.            </p>
    </li></ol>    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-PackagingtheHibernate3.5orgreater3.xJPApersistenceproviderwithyourapplication"  >
        <h3>Packaging the Hibernate 3.5 or greater 3.x JPA persistence provider with your application</h3>
    
            <p>
    WildFly 8&nbsp;allows the packaging of Hibernate 3.5 (or greater) persistence provider jars with the application. The JPA deployer will detect the presence of a persistence provider in the application and <strong class=" ">jboss.as.jpa.providerModule</strong> needs to be set to <strong class=" ">hibernate3-bundled</strong>.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;persistence xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot; version=&quot;1.0&quot;&gt;
    &lt;persistence-unit name=&quot;plannerdatasource_pu&quot;&gt;
        &lt;description&gt;Hibernate 3 Persistence Unit.&lt;/description&gt;
        &lt;jta-data-source&gt;java:jboss/datasources/PlannerDS&lt;/jta-data-source&gt;
        &lt;properties&gt;
&nbsp;&nbsp;&nbsp;         &lt;property name=&quot;hibernate.show_sql&quot; value=&quot;false&quot; /&gt;
        &nbsp;&nbsp;&nbsp; &lt;property name=&quot;jboss.as.jpa.providerModule&quot; value=&quot;hibernate3-bundled&quot; /&gt;
        &lt;/properties&gt;
    &lt;/persistence-unit&gt;
&lt;/persistence&gt;</code></pre>
        </div>
    </div>
            <p>
    The WildFly testsuite contains a test that packages jars from the Hibernate 3.6.5.Final jars in the ear lib.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-SharingtheHibernate3.5orgreaterJPApersistenceproviderbetweenmultipleapplications"  >
        <h3>Sharing the Hibernate 3.5 or greater JPA persistence provider between multiple applications</h3>
    
            <p>
    Applications can share the same Hibernate3 (for Hibernate 3.5 or greater) persistence provider by manually creating an <strong class=" ">org.hibernate:3</strong> module (in the AS/modules folder). Steps to create the Hibernate3 module:            </p>
    <ol class=" "><li class=" ">            <p>
    In a command shell, go to the AS installation and change into the modules/org folder.<br/><strong class=" ">cd WF\modules\modules\system\layers\base\org\hibernate\3</strong>            </p>
    </li><li class=" ">            <p>
    Copy the Hibernate3 jars into this folder<br/>(hibernate3-core.jar, hibernate3-commons-annotations.jar,  hibernate3-entitymanager.jar needed for Hibernate 3.x).            </p>
    </li><li class=" ">            <p>
    Update the module.xml file to name each jar you copied in as a &quot;resource-root&quot;:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!-- Represents the Hibernate 3.x module&nbsp; --&gt;
&lt;module xmlns=&quot;urn:jboss:module:1.1&quot; name=&quot;org.hibernate&quot; slot=&quot;3&quot;&gt;
&nbsp;&nbsp;&nbsp; &lt;resources&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;jipijapa-hibernate3-1.0.1.Final.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;hibernate3-core.jar&quot;/&gt;
        &lt;resource-root path=&quot;hibernate3-commons-annotations.jar&quot;/&gt;
        &lt;resource-root path=&quot;hibernate3-entitymanager.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/resources&gt;

&nbsp;&nbsp;&nbsp; &lt;dependencies&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;asm.asm&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.annotation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.enterprise.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.persistence.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.transaction.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.validation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.xml.bind.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.antlr&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.apache.commons.collections&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.dom4j&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.javassist&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.as.jpa.spi&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.jandex&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.logging&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &lt;module name=&quot;org.slf4j&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.vfs&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/dependencies&gt;
&lt;/module&gt;</code></pre>
        </div>
    </div>
</li></ol><ol class=" "><li class=" ">    <div class="confbox programlisting">
                <div class="content">
        <pre><code></code></pre>
        </div>
    </div>
</li></ol>            <p>
    In your persistence.xml, you will refer to the Hibernate 3 persistence provider as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;persistence xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot; version=&quot;1.0&quot;&gt;
    &lt;persistence-unit name=&quot;crm_pu&quot;&gt;
&nbsp;&nbsp;&nbsp;     &lt;description&gt;CRM Persistence Unit.&lt;/description&gt;
        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
    &nbsp;&nbsp;&nbsp; &lt;jta-data-source&gt;java:jboss/datasources/CRMDS&lt;/jta-data-source&gt;
    &nbsp;&nbsp;&nbsp; &lt;properties&gt;
&nbsp;&nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; &lt;property name=&quot;jboss.as.jpa.providerModule&quot; value=&quot;org.hibernate:3&quot; /&gt;
    &nbsp;&nbsp;&nbsp; &lt;/properties&gt;
    &lt;/persistence-unit&gt;
&lt;/persistence&gt;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UsingOpenJPA"  >
        <h3>Using OpenJPA</h3>
    
            <p>
    You need to copy the OpenJPA jars (e.g. openjpa-all.jar serp.jar) into the WildFly modules/system/layers/base/org/apache/openjpa/main folder and update modules/system/layers/base/org/apache/openjpa/main/module.xml to include the same jar file names that you copied in.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code> &lt;module xmlns=&quot;urn:jboss:module:1.1&quot; name=&quot;org.apache.openjpa&quot;&gt;
&nbsp;&nbsp;&nbsp; &lt;resources&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;jipijapa-openjpa-1.0.1.Final.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;openjpa-all.jar&quot;/&gt;
        &lt;resource-root path=&quot;serp.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/resources&gt;

&nbsp;&nbsp;&nbsp; &lt;dependencies&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.annotation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.enterprise.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.persistence.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.transaction.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.validation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.xml.bind.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.apache.commons.collections&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.apache.commons.lang&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.as.jpa.spi&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.logging&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.vfs&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.jandex&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/dependencies&gt;
&lt;/module&gt;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UsingEclipseLink"  >
        <h3>Using EclipseLink</h3>
    
            <p>
    You need to copy the EclipseLink jar (e.g. eclipselink-2.5.1.jar or eclipselink.jar as in the example below) into the WildFly modules/system/layers/base/org/eclipse/persistence/main folder and update modules/system/layers/base/org/eclipse/persistence/main/module.xml to include the EclipseLink jar (take care to use the jar name that you copied in).&nbsp; If you happen to leave the EclipseLink version number in the jar name, the module.xml should reflect that.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code> &lt;module xmlns=&quot;urn:jboss:module:1.1&quot; name=&quot;org.eclipse.persistence&quot;&gt;
&nbsp;&nbsp;&nbsp; &lt;resources&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;jipijapa-eclipselink-1.0.1.Final.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;eclipselink.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/resources&gt;

&nbsp;&nbsp;&nbsp; &lt;dependencies&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;asm.asm&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.annotation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.enterprise.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.jms.api&quot;/&gt;
        &lt;module name=&quot;javax.persistence.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.transaction.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.validation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.xml.bind.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.antlr&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.apache.commons.collections&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.dom4j&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.javassist&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.as.jpa.spi&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.logging&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.vfs&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/dependencies&gt;
&lt;/module&gt;</code></pre>
        </div>
    </div>
            <p>
    As a workaround for&nbsp; issue<a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=414974">id=414974</a>, set (WildFly) system property &quot;eclipselink.archive.factory&quot; to value &quot;org.jipijapa.eclipselink.JBossArchiveFactoryImpl&quot; via jboss-cli.sh command (WildFly server needs to be running when this command is issued):            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>jboss-cli.sh --connect '/system-property=eclipselink.archive.factory:add(value=org.jipijapa.eclipselink.JBossArchiveFactoryImpl)'</code></pre>
        </div>
    </div>
            <p>
    .&nbsp; The following shows what the standalone.xml (or your WildFly configuration you are using) file might look like after updating the system properties:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;system-properties&gt;
   ...
   &lt;property name=&quot;eclipselink.archive.factory&quot; value=&quot;org.jipijapa.eclipselink.JBossArchiveFactoryImpl&quot;/&gt;
&lt;/system-properties&gt;</code></pre>
        </div>
    </div>
            <p>
    You should then be able to deploy applications with persistence.xml that include;            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;provider&gt;org.eclipse.persistence.jpa.PersistenceProvider&lt;/provider&gt;</code></pre>
        </div>
    </div>
            <p>
    Also refer to page <a href="https://community.jboss.org/wiki/HowToUseEclipseLinkWithAS7">how to use EclipseLink with WildFly guide here</a>.            </p>
                <p>
    One may encounter following exception (found on WildFly 8.1.0 with EclipseLink 2.5.2):            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Caused by: java.lang.ClassNotFoundException: javax.ws.rs.ext.ExceptionMapper from [Module &quot;org.eclipse.persistence:main&quot; from local module loader...</code></pre>
        </div>
    </div>
            <p>
    Problem can be solved by adding missing module dependency into modules/system/layers/base/org/eclipse/persistence/main/module.xml:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;module name=&quot;javax.ws.rs.api&quot;/&gt;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UsingDataNucleus"  >
        <h3>Using DataNucleus</h3>
    
            <p>
    Read the <a href="http://www.datanucleus.org/servlet/wiki/pages/viewpage.action?pageId=27688962">how to use DataNucleus with WildFly guide here</a>.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-UsingHibernateOGM"  >
        <h3>Using Hibernate OGM</h3>
    
            <p>
    This section is a work in progress.            </p>
                <p>
    Example persistence.xml:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;persistence xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot; version=&quot;1.0&quot;&gt;
&nbsp; &lt;persistence-unit name=&quot;MINIMAL&quot;&gt;
&nbsp;&nbsp;&nbsp; &lt;provider&gt;org.hibernate.ogm.jpa.HibernateOgmPersistence&lt;/provider&gt;

&nbsp;&nbsp;&nbsp; &lt;properties&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;jboss.as.jpa.classtransformer&quot; value=&quot;false&quot; /&gt;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;jboss.as.jpa.adapterModule&quot; value=&quot;org.jboss.as.jpa.hibernate:4&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/properties&gt;
&nbsp; &lt;/persistence-unit&gt;
&lt;/persistence&gt;</code></pre>
        </div>
    </div>
            <p>
    The Hibernate ORM module needs to depend on OGM.&nbsp; Change AS7/modules/org/hibernate/main/module.xml to:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;module xmlns=&quot;urn:jboss:module:1.1&quot; name=&quot;org.hibernate&quot;&gt;
&nbsp;&nbsp;&nbsp; &lt;resources&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;hibernate-core-4.1.6.Final.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;hibernate-entitymanager-4.1.6.Final.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;hibernate-infinispan-4.1.6.Final.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- Insert resources here --&gt;
&nbsp;&nbsp;&nbsp; &lt;/resources&gt;

&nbsp;&nbsp;&nbsp; &lt;dependencies&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;asm.asm&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.persistence.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.transaction.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.validation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.antlr&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.apache.commons.collections&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.dom4j&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.infinispan&quot; optional=&quot;true&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.javassist&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.as.jpa.hibernate&quot; slot=&quot;4&quot; optional=&quot;true&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.logging&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.hibernate.envers&quot; services=&quot;import&quot; optional=&quot;true&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.hibernate&quot; slot=&quot;ogm&quot; services=&quot;import&quot;/&gt;
&nbsp;&nbsp; &nbsp;&lt;module name=&quot;org.hibernate.commons-annotations&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/dependencies&gt;
&lt;/module&gt;</code></pre>
        </div>
    </div>
            <p>
    The AS7/modules/org/hibernate/ogm folder should contain the OGM jars and the following module.xml:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;module xmlns=&quot;urn:jboss:module:1.1&quot; name=&quot;org.hibernate&quot; slot=&quot;ogm&quot;&gt;
&nbsp;&nbsp;&nbsp; &lt;resources&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;resource-root path=&quot;hibernate-ogm-core-4.0.0-SNAPSHOT.jar&quot;/&gt;
&nbsp;&nbsp; &nbsp;&lt;resource-root path=&quot;hibernate-ogm-infinispan-4.0.0-SNAPSHOT.jar&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- Insert resources here --&gt;
&nbsp;&nbsp;&nbsp; &lt;/resources&gt;

&nbsp;&nbsp;&nbsp; &lt;dependencies&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.persistence.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.transaction.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;javax.validation.api&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.dom4j&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.infinispan&quot; optional=&quot;true&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.as.jpa.hibernate&quot; slot=&quot;4&quot; optional=&quot;true&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;module name=&quot;org.jboss.logging&quot;/&gt;
&nbsp;&nbsp; &nbsp;&lt;module name=&quot;org.hibernate.commons-annotations&quot;/&gt;
&nbsp;&nbsp; &nbsp;&lt;module name=&quot;org.hibernate&quot; export=&quot;true&quot;/&gt;
&nbsp;&nbsp;&nbsp; &lt;/dependencies&gt;
&lt;/module&gt;</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-NativeHibernateuse"  >
        <h3>Native Hibernate use</h3>
    
            <p>
    Applications that use the Hibernate API directly, are referred to here as native Hibernate applications. Native Hibernate applications, can choose to use the Hibernate jars included with WildFly 8&nbsp;or they can package their own copy of the Hibernate jars. Applications that utilize JPA will automatically have the JBoss AS  Hibernate injected onto the application deployment classpath. Meaning that JPA applications,  should expect to use the Hibernate jars included in WildFly.            </p>
                <p>
    Example MANIFEST.MF entry to add Hibernate dependency:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>Manifest-Version: 1.0
...
Dependencies: org.hibernate</code></pre>
        </div>
    </div>
            <p>
    If you use the Hibernate native api in your application and also use the JPA api to access the same entities (from the same Hibernate session/EntityManager), you could get surprising results&nbsp; (e.g. HibernateSession.saveOrUpdate(entity) is different than EntityManager.merge(entity).&nbsp; Each entity should be managed by either Hibernate native API or JPA code.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-InjectionofHibernateSessionandSessionFactoryInjectionofHibernateSessionandSessionFactory"  >
        <h3>Injection of Hibernate Session and SessionFactoryInjection of Hibernate Session and SessionFactory</h3>
    
            <p>
    You can inject a org.hibernate.Session and org.hibernate.SessionFactory directly, just as you can do with EntityManagers and EntityManagerFactorys.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>import org.hibernate.Session;
import org.hibernate.SessionFactory;
@Stateful public class MyStatefulBean ... {
&nbsp;&nbsp; @PersistenceContext(unitName=&quot;crm&quot;) Session session1;
&nbsp;&nbsp; @PersistenceContext(unitName=&quot;crm2&quot;, type=EXTENDED) Session extendedpc;
&nbsp;&nbsp; @PersistenceUnit(unitName=&quot;crm&quot;) SessionFactory factory;
}</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Hibernateproperties"  >
        <h3>Hibernate properties</h3>
    
            <p>
    WildFly automatically sets the following Hibernate (4.x) properties (if not already set in persistence unit definition):            </p>
        <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Property            </td>
                <td rowspan="1" colspan="1">
    Purpose            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <span style="color: #555555;">
<strong class=" ">hibernate.id.new_generator_mappings</strong>    </span>
    <span style="color: #555555;">
=true    </span>
            </td>
                <td rowspan="1" colspan="1">
    New applications should let this default to true, older applications with existing data might need to set to false (see note below).&nbsp; It really depends on whether your application uses the @GeneratedValue(AUTO) which will generates new key values for newly created entities.&nbsp; The application can override this value (in the persistence.xml).            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">hibernate.transaction.jta.platform</strong>= instance of org.hibernate.service.jta.platform.spi.JtaPlatform interface            </td>
                <td rowspan="1" colspan="1">
    The transaction manager, user transaction and transaction synchronization registry is passed into Hibernate via this class.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">hibernate.ejb.resource_scanner</strong> = instance of org.hibernate.ejb.packaging.Scanner interface            </td>
                <td rowspan="1" colspan="1">
    Instance of entity scanning class is passed in that knows how to use the AS annotation indexer (for faster deployment).            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">hibernate.transaction.manager_lookup_class</strong>            </td>
                <td rowspan="1" colspan="1">
    This property is removed if found in the persistence.xml (could conflict with JtaPlatform)            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">hibernate.session_factory_name</strong> = qualified persistence unit name            </td>
                <td rowspan="1" colspan="1">
    Is set to the application name + persistence unit name (application can specify a different value but it needs to be unique across all application deployments on the AS instance).            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">hibernate.session_factory_name_is_jndi</strong> = false            </td>
                <td rowspan="1" colspan="1">
    only set if the application didn't specify a value for hibernate.session_factory_name.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">hibernate.ejb.entitymanager_factory_name =&nbsp;</strong> qualified persistence unit name            </td>
                <td rowspan="1" colspan="1">
    Is set to the application name + persistence unit name (application can specify a different value but it needs to be unique across all application deployments on the AS instance).            </td>
        </tr>
</tbody>        </table>
            </div>
            <p>
    In Hibernate 4.x, if <strong class=" ">new_generator_mappings</strong> is <strong class=" ">true</strong>:            </p>
    <ul class=" "><li class=" ">            <p>
    @GeneratedValue(AUTO) maps to org.hibernate.id.enhanced.SequenceStyleGenerator            </p>
    </li><li class=" ">            <p>
    @GeneratedValue(TABLE) maps to org.hibernate.id.enhanced.TableGenerator            </p>
    </li><li class=" ">            <p>
    @GeneratedValue(SEQUENCE) maps to org.hibernate.id.enhanced.SequenceStyleGenerator            </p>
    </li></ul>            <p>
    In Hibernate 4.x, if <strong class=" ">new_generator_mappings</strong> is <strong class=" ">false</strong>:            </p>
    <ul class=" "><li class=" ">            <p>
    @GeneratedValue(AUTO) maps to Hibernate &quot;native&quot;            </p>
    </li><li class=" ">            <p>
    @GeneratedValue(TABLE) maps to org.hibernate.id.MultipleHiLoPerTableGenerator            </p>
    </li><li class=" ">            <p>
    @GeneratedValue(SEQUENCE) to Hibernate &quot;seqhilo&quot;            </p>
    </li></ul>    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Persistenceunitproperties"  >
        <h3>Persistence unit properties</h3>
    
            <p>
    The following properties are supported in the persistence unit definition (in the persistence.xml file):            </p>
        <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Property            </td>
                <td rowspan="1" colspan="1">
    Purpose            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">jboss.as.jpa.providerModule</strong>            </td>
                <td rowspan="1" colspan="1">
    name of the persistence provider module (default is <strong class=" ">org.hibernate</strong>). Should be <strong class=" ">hibernate3-bundled</strong> if Hibernate 3 jars are in the application archive (adapterModule and adapterClass will automatically be set for <strong class=" ">hibernate3-bundled</strong>).&nbsp; Should be <strong class=" ">application</strong>, if a persistence provider is packaged with the application.&nbsp; See note below about some module names that are built in (based on the <strong class=" ">provider</strong>).            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">jboss.as.jpa.adapterModule</strong>            </td>
                <td rowspan="1" colspan="1">
    name of the integration classes that help WildFly&nbsp;to work with the persistence provider. Current valid values are <strong class=" ">org.jboss.as.jpa.hibernate:4</strong> (Hibernate 4 integration classes) and <strong class=" ">org.jboss.as.jpa.hibernate:3</strong> (Hibernate 3 integration classes). Other integration adapter modules are expected to be added.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">jboss.as.jpa.adapterClass</strong>            </td>
                <td rowspan="1" colspan="1">
    class name of the integration adapter. Current valid values are <strong class=" ">org.jboss.as.jpa.hibernate3.HibernatePersistenceProviderAdaptor</strong> and <strong class=" ">org.jboss.as.jpa.hibernate4.HibernatePersistenceProviderAdaptor</strong>.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">jboss.as.jpa.managed</strong>            </td>
                <td rowspan="1" colspan="1">
    set to <strong class=" ">false</strong> to disable container managed JPA access to the persistence unit.&nbsp; The default is <strong class=" ">true</strong>, which enables container managed JPA access to the persistence unit.&nbsp; This is typically set to <strong class=" ">false</strong> for Seam 2.x + Spring applications.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">jboss.as.jpa.classtransformer</strong>            </td>
                <td rowspan="1" colspan="1">
    set to <strong class=" ">false</strong> to disable class transformers for the persistence unit.&nbsp; The default is <strong class=" ">true</strong>, which allows class enhancing/rewriting.&nbsp; Hibernate also needs persistence unit property <strong class=" ">hibernate.ejb.use_class_enhancer</strong> to be true, for class enhancing to be enabled.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">wildfly.jpa.default-unit</strong>            </td>
                <td rowspan="1" colspan="1">
    set to <strong class=" ">true</strong> to choose the default persistence unit in an application.&nbsp; This is useful if you inject a persistence context without specifying the unitName (@PersistenceContext EntityManager em) but have multiple persistence units specified in your persistence.xml.            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">wildfly.jpa.twophasebootstrap</strong>            </td>
                <td rowspan="1" colspan="1">
    persistence providers (like Hibernate ORM 4.3.x via EntityManagerFactoryBuilder), allow a two phase persistence unit bootstrap, which improves JPA integration with CDI.&nbsp; Setting the <strong class=" ">wildfly.jpa.twophasebootstrap</strong> hint to false, disables the two phase bootstrap (for the persistence unit that contains the hint).            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">wildfly.jpa.allowdefaultdatasourceuse</strong>            </td>
                <td rowspan="1" colspan="1">
    set to false to prevent persistence unit from using the default data source.&nbsp; Defaults to true.&nbsp; This is only important for persistence units that do not specify a datasource.            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Determinethepersistenceprovidermodule"  >
        <h3>Determine the persistence provider module</h3>
    
            <p>
    As mentioned above, if the <strong class=" ">jboss.as.jpa.providerModule</strong> property is not specified, the provider module name is determined by the <strong class=" ">provider</strong> name specified in the persistence.xml.&nbsp; The mapping is:            </p>
        <div class="tablewrap">
        <table>
<thead class=" ">    <tr>
            <td rowspan="1" colspan="1">
    Provider Name            </td>
                <td rowspan="1" colspan="1">
    Module name            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
    blank            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">org.hibernate</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">org.hibernate.ejb.HibernatePersistence</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">org.hibernate</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">org.hibernate.ogm.jpa.HibernateOgmPersistence</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">org.hibernate:ogm</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">oracle.toplink.essentials.PersistenceProvider</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">oracle.toplink</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">oracle.toplink.essentials.ejb.cmp3.EntityManagerFactoryProvider</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">oracle.toplink</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">org.eclipse.persistence.jpa.PersistenceProvider</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">org.eclipse.persistence</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">org.datanucleus.api.jpa.PersistenceProviderImpl</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">org.datanucleus</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">org.datanucleus.store.appengine.jpa.DatastorePersistenceProvider</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">org.datanucleus:appengine</strong>            </td>
        </tr>
    <tr>
            <td rowspan="1" colspan="1">
    <strong class=" ">org.apache.openjpa.persistence.PersistenceProviderImpl</strong>            </td>
                <td rowspan="1" colspan="1">
    <strong class=" ">org.apache.openjpa</strong>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-BindingEntityManagerFactory%2FEntityManagertoJNDI"  >
        <h3>Binding EntityManagerFactory/EntityManager to JNDI</h3>
    
            <p>
    By default WildFly does <strong class=" ">not</strong> bind the entity manager factory to JNDI. However, you can explicitly configure this in the persistence.xml of your application by setting the <tt class=" ">jboss.entity.manager.factory.jndi.name</tt> <tt class=" ">hint. The value of that property should be the JNDI name to which the entity manager factory should be bound.</tt>            </p>
                <p>
    <tt class=" ">You can also bind a container managed (transaction scoped) entity manager to JNDI as well,&nbsp;}}via hint</tt> <tt class=" ">jboss.entity.manager.jndi.name</tt>{<tt class=" ">}{{.&nbsp; As a reminder, a transaction scoped entity manager (persistence context), acts as a proxy that always gets an unique underlying entity manager (at the persistence provider level).</tt>            </p>
                <p>
    <tt class=" ">Here's an example:</tt>            </p>
        <div class="confbox programlisting">
                    <div class="title">persistence.xml</div>
                <div class="content">
        <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;persistence version=&quot;2.0&quot;
&nbsp;&nbsp; xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
&nbsp;&nbsp; xsi:schemaLocation=&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://java.sun.com/xml/ns/persistence
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd&quot;&gt;
&nbsp;&nbsp; &lt;persistence-unit name=&quot;myPU&quot;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- If you are running in a production environment, add a managed
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data source, the example data source is just for proofs of concept! --&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;jta-data-source&gt;java:jboss/datasources/ExampleDS&lt;/jta-data-source&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;properties&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- Bind entity manager factory to JNDI at java:jboss/myEntityManagerFactory --&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;jboss.entity.manager.factory.jndi.name&quot; value=&quot;java:jboss/myEntityManagerFactory&quot; /&gt;
         &lt;property name=&quot;jboss.entity.manager.jndi.name&quot; value=&quot;java:/myEntityManager&quot;/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/properties&gt;
&nbsp;&nbsp; &lt;/persistence-unit&gt;
&lt;/persistence&gt;</code></pre>
        </div>
    </div>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>@Stateful
public class ExampleSFSB {
  public void createSomeEntityWithTransactionScopedEM(String name) {
    Context context = new InitialContext();
    javax.persistence.EntityManager entityManager = (javax.persistence.EntityManager) context.lookup(&quot;java:/myEntityManager&quot;);
    SomeEntity someEntity = new SomeEntity();
   &nbsp;someEntity.setName(name);    entityManager.persist(name);
  }
}
</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Community"  >
        <h3>Community</h3>
    
            <p>
    Many thanks to the community, for reporting issues, solutions and code changes. A number of people have been answering Wildfly forum questions related to JPA usage. I would like to thank them for this, as well as those reporting issues. For those of you that haven't downloaded the AS source code and started hacking patches together. I would like to encourage you to start by reading <a href="https://community.jboss.org/wiki/HackingOnWildFly">Hacking on WildFly</a>. You will find that it easy very easy to find your way around the WildFly/JPA/* source tree and make changes. Also, new for WildFly, is the JipiJapa project that contains additional integration code that makes EE JPA application deployments work better.&nbsp; The following list of contributors should grow over time, I hope to see more of you listed here.            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-PeoplewhohavecontributedtotheWildFlyJPAlayer%3A"  >
        <h4>People who have contributed to the WildFly JPA layer:</h4>
    
<ul class=" "><li class=" ">            <p>
    <a href="https://community.jboss.org/people/wolfc">Carlo de Wolf</a> (lead of the EJB3 project)            </p>
    </li><li class=" ">            <p>
    <strong class=" "><a href="http://in.relation.to/Bloggers/Steve">Steve Ebersole</a></strong> (lead of the Hibernate ORM project)            </p>
    </li><li class=" ">            <p>
    <strong class=" "><a href="https://community.jboss.org/people/swd847">Stuart Douglas</a></strong> (lead of the Seam Persistence project, WildFly project team member/committer)            </p>
    </li><li class=" ">            <p>
    <a href="https://community.jboss.org/people/jaikiran">Jaikiran Pai</a> (Active member of JBoss forums and JBoss EJB3 project team member)            </p>
    </li><li class=" ">            <p>
    <a href="http://relation.to/Bloggers/StrongLiu">Strong Liu</a> (leads the productization effort of Hibernate in the EAP product)            </p>
    </li><li class=" ">            <p>
    <strong class=" "><a href="https://community.jboss.org/people/smarlow">Scott Marlow</a></strong> (lead of the WildFly container JPA sub-project)            </p>
    </li><li class=" ">            <p>
    <strong class=" "><a href="https://community.jboss.org/people/alaisi">Antti Laisi</a></strong> <strong class=" ">(OpenJPA integration changes)</strong>            </p>
    </li><li class=" ">            <p>
    <a href="https://docs.jboss.org/author/display/~galder.zamarreno">Galder Zamarre&ntilde;o</a> (Infinispan 2lc documentation)            </p>
    </li><li class=" ">            <p>
    <a href="https://docs.jboss.org/author/display/~sannegrinovero">Sanne Grinovero</a> (Infinispan 2lc documentation)            </p>
    </li><li class=" ">            <p>
    <a href="https://issues.jboss.org/secure/ViewProfile.jspa?name=pferraro">Paul Ferraro</a> (Infinispan 2lc integration)            </p>
    </li></ul>            <p>
    &nbsp;            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-OSGideveloperguide"  >
        <h2>OSGi developer guide</h2>
    
<div class=" error">            <p>
    Couldn't find a page to include called: <a href="https://docs.jboss.org/author/pages/createpage.action?spaceKey=WFLY8&amp;title=OSGi+Developer+Guide&amp;linkCreation=true&amp;fromPageId=66322748">OSGi Developer Guide</a>            </p>
    </div>    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-JNDIreferenceguide"  >
        <h2>JNDI reference guide</h2>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Overview9"  >
        <h3>Overview</h3>
    
            <p>
    WildFly offers several mechanisms to retrieve components by name. Every WildFly&nbsp;instance has it's own local JNDI namespace (<tt class=" ">java:</tt>) which is unique per JVM. The layout of this namespace is primarily governed by the Java EE specification. Applications which share the same WildFly instance can use this namespace to intercommunicate. In addition to local JNDI, a variety of mechanisms exist to access remote components.            </p>
    <ul class=" "><li class=" ">            <p>
    Client JNDI - This is a mechanism by which remote components can be accessed using the JNDI APIs, but <strong class=" "><i class=" ">without network round-trips</i></strong>. This approach is the most efficient, and <strong class=" "><i class=" ">removes a potential single point of failure</i></strong>. For this reason, it is highly recommended to use Client JNDI over traditional remote JNDI access. However, to make this possible, it does require that all names follow a strict layout, so user customizations are not possible. Currently only access to remote EJBs is supported via the <tt class=" ">ejb:</tt> namespace. Future revisions will likely add a JMS client JNDI namespace.            </p>
    </li><li class=" ">            <p>
    Traditional Remote JNDI - This is a more familiar approach to EE application developers, where the client performs a remote component name lookup against a server, and a proxy/stub to the component is serialized as part of the name lookup and returned to the client. The client then invokes a method on the proxy which results in another remote network call to the underlying service. In a nutshell, traditional remote JNDI involves two calls to invoke an EE component, whereas Client JNDI requires one. It does however allow for customized names, and for a centralised directory for multiple application servers. This centralized directory is, however, <i class=" ">a single point of failure</i>.&nbsp;            </p>
    </li><li class=" ">            <p>
    EE Application Client / Server-To-Server Delegation - This approach is where local names are bound as an <i class=" ">alias</i>&nbsp;to a remote name using one of the above mechanisms. This is useful in that it allows applications to only ever reference standard portable Java EE names in both code and deployment descriptors. It also allows for the application to be unaware of network topology details/ This can even work with Java SE clients by using the little known EE Application Client feature. This feature allows you to run an extremely minimal AS server around your application, so that you can take advantage of certain core services such as naming and injection. &nbsp;            </p>
    </li></ul>    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-LocalJNDI"  >
        <h3>Local JNDI</h3>
    
            <p>
    The Java EE platform specification defines the following JNDI contexts:            </p>
    <ul class=" "><li class=" ">            <p>
    <tt class=" ">java:comp</tt> - The namespace is scoped to the current component (i.e. EJB)            </p>
    </li><li class=" ">            <p>
    <tt class=" ">java:module</tt> - Scoped to the current module            </p>
    </li><li class=" ">            <p>
    <tt class=" ">java:app</tt> - Scoped to the current application            </p>
    </li><li class=" ">            <p>
    <tt class=" ">java:global</tt> - Scoped to the application server            </p>
    </li></ul>            <p>
    In addition to the standard namespaces, WildFly also provides the following two global namespaces:            </p>
    <ul class=" "><li class=" ">            <p>
    java:jboss            </p>
    </li><li class=" ">            <p>
    java:/            </p>
    </li></ul>    <div class="confbox admonition admonition-note">
        
            <p>
    Only entries within the&nbsp;<tt class=" ">java:jboss/exported</tt> context are accessible over remote JNDI.            </p>
        </div>
    
    <div class="confbox admonition admonition-note">
        
            <p>
    For web deployments <tt class=" ">java:comp</tt> is aliased to <tt class=" ">java:module</tt>, so EJB's deployed in a war do not have their own comp namespace.            </p>
        </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-BindingentriestoJNDI"  >
        <h4>Binding entries to JNDI</h4>
    
            <p>
    There are several methods that can be used to bind entries into JNDI in WildFly.            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-Usingadeploymentdescriptor"  >
        <h5>Using a deployment descriptor</h5>
    
            <p>
    For Java EE applications the recommended way is to use a <a href="https://docs.jboss.org/author/display/AS71/Deployment+Descriptors+used+In+AS7.1">deployment descriptor</a> to create the binding. For example the following <tt class=" ">web.xml</tt> binds the string <tt class=" ">&quot;Hello World&quot;</tt> to <tt class=" ">java:global/mystring</tt> and the string <tt class=" ">&quot;Hello Module&quot;</tt> to <tt class=" ">java:comp/env/hello</tt> (any non absolute JNDI name is relative to <tt class=" ">java:comp/env</tt> context).            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;
         version=&quot;3.1&quot;&gt;
    &lt;env-entry&gt;
        &lt;env-entry-name&gt;java:global/mystring&lt;/env-entry-name&gt;
        &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;
        &lt;env-entry-value&gt;Hello World&lt;/env-entry-value&gt;
    &lt;/env-entry&gt;
    &lt;env-entry&gt;
        &lt;env-entry-name&gt;hello&lt;/env-entry-name&gt;
        &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;
        &lt;env-entry-value&gt;Hello Module&lt;/env-entry-value&gt;
    &lt;/env-entry&gt;
&lt;/web-app&gt;</code></pre>
        </div>
    </div>
            <p>
    For more details, see the <a href="http://jcp.org/en/jsr/detail?id=342">Java EE Platform Specification</a>.            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-Programatically"  >
        <h5>Programatically</h5>
    
    <div class="section-6"  id="66322748_DeveloperGuide-JavaEEApplications"  >
        <h6>Java EE Applications</h6>
    
    </div>
    
    <div class="section-6"  id="66322748_DeveloperGuide-"  >
        <h6></h6>
    
            <p>
    Standard Java EE applications may use the standard JNDI API, included with Java SE, to bind entries in the global namespaces (the standard <tt class=" ">java:comp</tt>, <tt class=" ">java:module</tt> and <tt class=" ">java:app</tt> namespaces are read-only, as mandated by the Java EE Platform Specification).            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>  InitialContext initialContext = new InitialContext();
  initialContext.bind(&quot;java:global/a&quot;, 100);</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    There is no need to unbind entries created programatically, since WildFly tracks which bindings belong to a deployment, and the bindings are automatically removed when the deployment is undeployed.            </p>
        </div>
    
    <div class="section-7"  id="66322748_DeveloperGuide-WildFlyModulesandExtensions"  >
        <h7>WildFly Modules and Extensions</h7>
    
    </div>
    
    </div>
    
    <div class="section-6"  id="66322748_DeveloperGuide-2"  >
        <h6></h6>
    
            <p>
    With respect to code in WildFly Modules/Extensions, which is executed out of a Java EE application context, using the standard JNDI API may result in a UnsupportedOperationException if the target namespace uses a WritableServiceBasedNamingStore. To work around that, the bind() invocation needs to be wrapped using WildFly proprietary APIs:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>  InitialContext initialContext = new InitialContext();
  WritableServiceBasedNamingStore.pushOwner(serviceTarget);
  try {
    initialContext.bind(&quot;java:global/a&quot;, 100);
  } finally {
    WritableServiceBasedNamingStore.popOwner();
  }</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    The ServiceTarget removes the bind when uninstalled, thus using one out of the module/extension domain usage should be avoided, unless entries are removed using unbind().            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-NamingSubsystemConfiguration"  >
        <h5>Naming Subsystem Configuration</h5>
    
            <p>
    It is also possible to bind to one of the three global namespaces using configuration in the naming subsystem. This can be done by either editing the <tt class=" ">standalone.xml/domain.xml</tt> file directly, or through the management API.            </p>
                <p>
    Four different types of bindings are supported:            </p>
    <ul class=" "><li class=" ">            <p>
    Simple - A primitive or java.net.URL entry (default is&nbsp;<tt class=" ">java.lang.String</tt>).            </p>
    </li><li class=" ">            <p>
    Object Factory - This allows to to specify the <tt class=" ">javax.naming.spi.ObjectFactory</tt> that is used to create the looked up value.            </p>
    </li><li class=" ">            <p>
    External Context - An external context to federate, such as an LDAP Directory Service&nbsp;            </p>
    </li><li class=" ">            <p>
    Lookup - The allows to create JNDI aliases, when this entry is looked up it will lookup the target and return the result.            </p>
    </li></ul>            <p>
    An example standalone.xml might look like:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:naming:2.0&quot; &gt;
  &lt;bindings&gt;
    &lt;simple name=&quot;java:global/a&quot; value=&quot;100&quot; type=&quot;int&quot; /&gt;
    &lt;simple name=&quot;java:global/jbossDocs&quot; value=&quot;https://docs.jboss.org&quot; type=&quot;java.net.URL&quot; /&gt;
&nbsp;   &lt;object-factory name=&quot;java:global/b&quot; module=&quot;com.acme&quot; class=&quot;org.acme.MyObjectFactory&quot; /&gt;
    &lt;external-context name=&quot;java:global/federation/ldap/example&rdquo; class=&quot;javax.naming.directory.InitialDirContext&quot; cache=&quot;true&quot;&gt;
      &lt;environment&gt;
        &lt;property name=&quot;java.naming.factory.initial&quot; value=&ldquo;com.sun.jndi.ldap.LdapCtxFactory&rdquo; /&gt;
        &lt;property name=&quot;java.naming.provider.url&quot; value=&ldquo;ldap://ldap.example.com:389&rdquo; /&gt;
        &lt;property name=&quot;java.naming.security.authentication&quot; value=&ldquo;simple&rdquo; /&gt;
        &lt;property name=&quot;java.naming.security.principal&quot; value=&ldquo;uid=admin,ou=system&rdquo; /&gt;
        &lt;property name=&quot;java.naming.security.credentials&quot; value=&ldquo;secret&rdquo; /&gt;
      &lt;/environment&gt;
    &lt;/external-context&gt;
    &lt;lookup name=&quot;java:global/c&quot; lookup=&quot;java:global/b&quot; /&gt;
 &lt;/bindings&gt;
&lt;/subsystem&gt;</code></pre>
        </div>
    </div>
            <p>
    The CLI may also be used to bind an entry. As an example:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>/subsystem=naming/binding=java\:global\/mybinding:add(binding-type=simple, type=long, value=1000)</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
        
            <p>
    WildFly's Administrator Guide includes a section describing in detail the Naming subsystem configuration.            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-RetrievingentriesfromJNDI"  >
        <h4>Retrieving entries from JNDI</h4>
    
    <div class="section-5"  id="66322748_DeveloperGuide-ResourceInjection"  >
        <h5>Resource Injection</h5>
    
            <p>
    For Java EE applications the recommended way to lookup a JNDI entry is to use <tt class=" ">@Resource</tt> injection:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>  @Resource(lookup = &quot;java:global/mystring&quot;)
  private String myString;

  @Resource(name = &quot;hello&quot;)
  private String hello;

  @Resource
  ManagedExecutorService executor;</code></pre>
        </div>
    </div>
            <p>
    Note that <tt class=" ">@Resource</tt> is more than a JNDI lookup, it also binds an entry in the component's JNDI environment. The new bind JNDI name is defined by <tt class=" ">@Resource</tt>'s <tt class=" ">name</tt> attribute, which value, if unspecified, is the Java type concatenated with&nbsp;<tt class=" ">/</tt>&nbsp;and the field's name, for instance <tt class=" ">java.lang.String/myString</tt>. More, similar to when using deployment descriptors to bind JNDI entries. unless the name is an absolute JNDI name, it is considered relative to&nbsp;<tt class=" ">java:comp/env</tt>. For instance, with respect to the field named <tt class=" ">myString</tt> above, the <tt class=" ">@Resource</tt>'s <tt class=" ">lookup</tt> attribute instructs WildFly to lookup the value in <tt class=" ">java:global/mystring</tt>, bind it in <tt class=" ">java:comp/env/java.lang.String/myString</tt>, and then inject such value into the field.            </p>
                <p>
    With respect to the field named <tt class=" ">hello</tt>, there is no <tt class=" ">lookup</tt> attribute value defined, so the responsibility to provide the entry's value is delegated to the deployment descriptor. Considering that the deployment descriptor was the <tt class=" ">web.xml</tt> previously shown, which defines an environment entry with same <tt class=" ">hello</tt> name, then WildFly inject the valued defined in the deployment descriptor into the field.            </p>
                <p>
    The <tt class=" ">executor</tt> field has no attributes specified, so the bind's name would default to <tt class=" ">java:comp/env/javax.enterprise.concurrent.ManagedExecutorService/executor</tt>, but there is no such entry in the deployment descriptor, and when that happens it's up to WildFly to provide a default value or null, depending on the field's Java type. In this particular case WildFly would inject the default instance of a managed executor service, the value in <tt class=" ">java:comp/DefaultManagedExecutorService</tt>, as mandated by the EE Concurrency Utilities 1.0 Specification (JSR 236).            </p>
        </div>
    
    <div class="section-5"  id="66322748_DeveloperGuide-StandardJavaSEJNDIAPI"  >
        <h5>Standard Java SE JNDI API</h5>
    
            <p>
    Java EE applications may use, without any additional configuration needed, the standard JNDI API to lookup an entry from JNDI:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>  String myString = (String) new InitialContext().lookup(&quot;java:global/mystring&quot;);</code></pre>
        </div>
    </div>
            <p>
    or simply            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>  String myString = InitialContext.doLookup(&quot;java:global/mystring&quot;);</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-RemoteJNDI"  >
        <h3>Remote JNDI</h3>
    
            <p>
    WildFly supports two different types of remote JNDI. The old jnp based JNDI implementation used in JBoss AS versions prior to 7.x is no longer supported.            </p>
        <div class="section-4"  id="66322748_DeveloperGuide-remote%3A"  >
        <h4>remote:</h4>
    
            <p>
    The <tt class=" ">remote:</tt> protocol uses the WildFly&nbsp;remoting protocol to lookup items from the servers local JNDI. To use it, you must have the appropriate jars on the class path, if you are maven user can be done simply by adding the following to your <tt class=" ">pom.xml</tt>:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.wildfly&lt;/groupId&gt;
  &lt;artifactId&gt;wildfly-ejb-client-bom&lt;/artifactId&gt;
  &lt;version&gt;8.0.0.Final&lt;/version&gt;
  &lt;type&gt;pom&lt;/type&gt;
  &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
        </div>
    </div>
            <p>
    If you are not using maven a shaded jar that contains all required classes<br/>can be found in the <tt class=" ">bin/client</tt> directory of WildFly's distribution.            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>final Properties env = new Properties();
env.put(Context.INITIAL_CONTEXT_FACTORY, org.jboss.naming.remote.client.InitialContextFactory.class.getName());
env.put(Context.PROVIDER_URL, &quot;remote://localhost:4447&quot;);
remoteContext = new InitialContext(env);</code></pre>
        </div>
    </div>
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-ejb%3A"  >
        <h4>ejb:</h4>
    
            <p>
    The ejb: namespace is provided by the jboss-ejb-client library. This protocol allows you to look up EJB's, using their application name, module name, ejb name and interface type.            </p>
                <p>
    This is a client side JNDI implementation. Instead of looking up an EJB on the server the lookup name contains enough information for the client side library to generate a proxy with the EJB information. When you invoke a method on this proxy it will use the current EJB client context to perform the invocation. If the current context does not have a connection to a server with the specified EJB deployed then an error will occur. Using this protocol it is possible to look up EJB's that do not actually exist, and no error will be thrown until the proxy is actually used. The exception to this is stateful session beans, which need to connect to a server when they are created in order to create the session bean instance on the server.            </p>
                <p>
    Some examples are:            </p>
                <p>
    <tt class=" ">ejb:myapp/myejbjar/MyEjbName!com.test.MyRemoteInterface</tt><br/><tt class=" ">ejb:myapp/myejbjar/MyStatefulName!comp.test.MyStatefulRemoteInterface?stateful</tt>            </p>
                <p>
    The first example is a lookup of a singleton, stateless or EJB 2.x home interface. This lookup will not hit the server, instead a proxy will be generated for the remote interface specified in the name. The second example is for a stateful session bean, in this case the JNDI lookup will hit the server, in order to tell the server to create the SFSB session.            </p>
                <p>
    For more details on how the server connections are configured, please see <a href="66322770.html">EJB invocations from a remote client using JNDI</a>.            </p>
        </div>
    
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-Springapplicationsdevelopmentandmigrationguide"  >
        <h2>Spring applications development and migration guide</h2>
    
            <p>
    This document details the main points that need to be considered by Spring developers that wish to develop new applications or to migrate existing applications to be run into WildFly 8.            </p>
        <div class="section-3"  id="66322748_DeveloperGuide-DependenciesandModularity"  >
        <h3>Dependencies and Modularity</h3>
    
            <p>
    WildFly 8&nbsp;has a modular class loading strategy, different from previous versions of JBoss AS, which enforces a better class loading isolation between deployments and the application server itself. A detailed description can be found in the documentation dedicated to&nbsp;<a href="https://docs.jboss.org/author/display/AS7/Class+Loading+in+AS7">class loading in WildFly 8</a>.            </p>
                <p>
    This reduces significantly the risk of running into a class loading conflict and allows applications to package their own dependencies if they choose to do so. This makes it easier for Spring applications that package their own dependencies - such as logging frameworks or persistence providers to run on WildFly 8.&nbsp;            </p>
                <p>
    At the same time, this does not mean that duplications and conflicts cannot exist on the classpath. Some module dependencies are implicit, depending on the type of deployment as shown&nbsp;<a href="https://docs.jboss.org/author/display/AS7/Implicit+module+dependencies+for+deployments">here</a>.&nbsp;            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-Persistenceusageguide"  >
        <h3>Persistence usage guide</h3>
    
            <p>
    Depending on the strategy being used, Spring applications can be:            </p>
    <ul class=" "><li class=" ">            <p>
    native Hibernate applications;            </p>
    </li><li class=" ">            <p>
    JPA-based applications;            </p>
    </li><li class=" ">            <p>
    native JDBC applications;            </p>
    </li></ul>    </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-NativeSpring%2FHibernateapplications"  >
        <h3>Native Spring/Hibernate applications</h3>
    
            <p>
    Applications that use the Hibernate API directly with Spring (i.e. through either one of LocalSessionFactoryBean or AnnotationSessionFactoryBean) may use a version of Hibernate 3 packaged inside the application. Hibernate 4 (which is provided through the 'org.hibernate' module of WildFly 8) is not supported by Spring 3.0 and Spring 3.1 (and may be supported by Spring 3.2 as described in&nbsp;<a href="https://jira.springsource.org/browse/SPR-8096">SPR-8096</a>), so adding this module as a dependency is not a solution.            </p>
        </div>
    
    <div class="section-3"  id="66322748_DeveloperGuide-JPAbasedapplications"  >
        <h3>based applications</h3>
    
            <p>
    Spring applications using JPA may choose between:            </p>
    <ul class=" "><li class=" ">            <p>
    using a server-deployed persistence unit;            </p>
    </li><li class=" ">            <p>
    using a Spring-managed persistence unit.            </p>
    </li></ul>    <div class="section-4"  id="66322748_DeveloperGuide-Usingserverdeployedpersistenceunits"  >
        <h4>Using server-deployed persistence units</h4>
    
            <p>
    Applications that use a server-deployed persistence unit must observe the typical Java EE rules in what concerns dependency management, i.e.&nbsp;the javax.persistence classes and persistence provider (Hibernate) are contained in modules which are added automatically by the application when the persistence unit is deployed.            </p>
                <p>
    In order to use the server-deployed persistence units from within Spring, either the persistence context or the persistence unit need to be registered in JNDI via web.xml as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;persistence-context-ref&gt;
    &lt;persistence-context-ref-name&gt;persistence/petclinic-em&lt;/persistence-unit-ref-name&gt;
    &lt;persistence-unit-name&gt;petclinic&lt;/persistence-unit-name&gt;
&lt;/persistence-context-ref&gt;</code></pre>
        </div>
    </div>
            <p>
    or, respectively:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;persistence-unit-ref&gt;
&nbsp; &nbsp; &lt;persistence-unit-ref-name&gt;persistence/petclinic-emf&lt;/persistence-unit-ref-name&gt;
&nbsp; &nbsp; &lt;persistence-unit-name&gt;petclinic&lt;/persistence-unit-name&gt;
&lt;/persistence-unit-ref&gt;</code></pre>
        </div>
    </div>
            <p>
    When doing so, the persistence context or persistence unit are available to be looked up in JNDI, as follows:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;jee:jndi-lookup id=&quot;entityManager&quot; jndi-name=&quot;java:comp/env/persistence/petclinic-em&quot;&nbsp;
            expected-type=&quot;javax.persistence.EntityManager&quot;/&gt;</code></pre>
        </div>
    </div>
            <p>
    or            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;jee:jndi-lookup id=&quot;entityManagerFactory&quot; jndi-name=&quot;java:comp/env/persistence/petclinic-emf&quot;&nbsp;
            expected-type=&quot;javax.persistence.EntityManagerFactory&quot;/&gt;</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
            <div class="title">JNDI binding</div>
        
            <p>
    JNDI binding via persistence.xml properties is not supported in&nbsp;WildFly 8.            </p>
        </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-UsingSpringmanagedpersistenceunits"  >
        <h4>Using Spring-managed persistence units</h4>
    
            <p>
    Spring applications running in WildFly 8&nbsp;may also create persistence units on their own, using the LocalContainerEntityManagerFactoryBean. This is what these applications need to consider:            </p>
        <div class="section-5"  id="66322748_DeveloperGuide-Placementofthepersistenceunitdefinitions"  >
        <h5>Placement of the persistence unit definitions</h5>
    
            <p>
    When the application server encounters a deployment that has a file named META-INF/persistence.xml (or, for that matter, WEB-INF/classes/META-INF/persistence.xml), it will attempt to create a persistence unit based on what is provided in the file. In most cases, such definition files are not compliant with the Java EE requirements, mostly because required elements such as the datasource of the persistence unit are supposed to be provided by the Spring context definitions, which will fail the deployment of the persistence unit, and consequently of the entire deployment.            </p>
                <p>
    Spring applications can easily avoid this type of conflict, by using a feature of the LocalContainerEntityManagerFactoryBean which is designed for this purpose. Persistence unit definition files can exist in other locations than META-INF/persistence.xml and the location can be indicated through the persistenceXmlLocation property of the factory bean class.            </p>
                <p>
    Assuming that the persistence unit is in the META-INF/jpa-persistence.xml, the corresponding definition can be:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;bean id=&quot;entityManagerFactory&quot; class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;&nbsp;
 &nbsp; &nbsp; &nbsp; &lt;property name=&quot;persistenceXmlLocation&quot; value=&quot;classpath*:META-INF/jpa-persistence.xml&quot;/&gt;&nbsp;
 &nbsp; &nbsp; &nbsp; &lt;!-- other definitions --&gt;
&lt;/bean&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    <div class="section-4"  id="66322748_DeveloperGuide-Managingdependencies"  >
        <h4>Managing dependencies</h4>
    
            <p>
    Since the LocalContainerEntityManagerFactoryBean and the corresponding HibernateJpaVendorAdapter are based on Hibernate 3, it is required to use that version with the application. Therefore, the Hibernate 3 jars must be included in the deployment. At the same time, due the presence of @PersistenceUnit or @PersistenceContext annotations on the application classes, the application server will automatically add the 'org.hibernate' module as a dependency.            </p>
                <p>
    This can be avoided by instructing the server to exclude the module from the deployment's list of dependencies. In order to do so, include a META-INF/jboss-deployment-structure.xml or, for web applications, WEB-INF/jboss-deployment-structure.xml with the following content:            </p>
        <div class="confbox programlisting">
                <div class="content">
        <pre><code>&lt;jboss-deployment-structure xmlns=&quot;urn:jboss:deployment-structure:1.0&quot;&gt;
  &lt;deployment&gt;
    &lt;exclusions&gt;
       &lt;module name=&quot;org.hibernate&quot;/&gt;
    &lt;/exclusions&gt;
  &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;</code></pre>
        </div>
    </div>
    </div>
    
    </div>
    
    </div>
    
    <div class="section-2"  id="66322748_DeveloperGuide-AllWildFly8documentation"  >
        <h2>All WildFly 8 documentation</h2>
    
<div class=" error">            <p>
    Couldn't find a page to include called: <a href="https://docs.jboss.org/author/pages/createpage.action?spaceKey=WFLY8&amp;title=All+JBoss+AS+7+documentation&amp;linkCreation=true&amp;fromPageId=66322748">All JBoss AS 7 documentation</a>            </p>
    </div>    </div>
    
        </div>
    </div>
</body>
</html>
